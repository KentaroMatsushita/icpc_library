<!DOCTYPE html>
<!-- generated by build/build.js -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICPC Notebook</title>
    <!-- MathJax -->
    <script>
        var MathJax = {
            tex: {
                inlineMath: [['$', '$']]
            }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- css -->
    <link rel="stylesheet" type="text/css" href="notebook.css" />
</head>
<body>
    <h1 id="title">ICPC Notebook</h1>
    <!-- 目次 -->
    <nav id="toc" role="doc-toc">
        <ol>
            
    <li><a class="section" href="#template">template</a></li>
    <ol>
    <li><a href="#0settings.sh">0settings.sh</a></li>
    <li><a href="#1template.hpp">1template.hpp</a></li>
    <li><a href="#hash.sh">hash.sh</a></li>
    <li><a href="#random_test.sh">random_test.sh</a></li>
    <li><a href="#rnd.hpp">rnd.hpp</a></li>
    </ol>
    <li><a class="section" href="#data-structure">data-structure</a></li>
    <ol>
    <li><a href="#BIT.hpp">BIT.hpp</a></li>
    <li><a href="#FastSet.hpp">FastSet.hpp</a></li>
    <li><a href="#Skew-Heap.hpp">Skew-Heap.hpp</a></li>
    <li><a href="#cht.hpp">cht.hpp</a></li>
    <li><a href="#hash_map.hpp">hash_map.hpp</a></li>
    <li><a href="#lazy-segtree.hpp">lazy-segtree.hpp</a></li>
    <li><a href="#li-chao.hpp">li-chao.hpp</a></li>
    <li><a href="#line_container.hpp">line_container.hpp</a></li>
    <li><a href="#link-cut.hpp">link-cut.hpp</a></li>
    <li><a href="#pbds.hpp">pbds.hpp</a></li>
    <li><a href="#rbst.hpp">rbst.hpp</a></li>
    <li><a href="#segbeats.hpp">segbeats.hpp</a></li>
    <li><a href="#segtree-2d.hpp">segtree-2d.hpp</a></li>
    <li><a href="#segtree.hpp">segtree.hpp</a></li>
    <li><a href="#sparse-table-disjoint.hpp">sparse-table-disjoint.hpp</a></li>
    <li><a href="#swag.hpp">swag.hpp</a></li>
    <li><a href="#wavelet_matrix.hpp">wavelet_matrix.hpp</a></li>
    </ol>
    <li><a class="section" href="#dp">dp</a></li>
    <ol>
    <li><a href="#d-edge-monge.hpp">d-edge-monge.hpp</a></li>
    <li><a href="#mo-rollback.hpp">mo-rollback.hpp</a></li>
    <li><a href="#mo.hpp">mo.hpp</a></li>
    <li><a href="#monge-incremental-rowmin.hpp">monge-incremental-rowmin.hpp</a></li>
    <li><a href="#monotone-minima.hpp">monotone-minima.hpp</a></li>
    </ol>
    <li><a class="section" href="#math">math</a></li>
    <ol>
    <li><a href="#ExtGCD.hpp">ExtGCD.hpp</a></li>
    <li><a href="#and-or-convolution.hpp">and-or-convolution.hpp</a></li>
    <li><a href="#binom.hpp">binom.hpp</a></li>
    <li><a href="#crt.hpp">crt.hpp</a></li>
    <li><a href="#floor_sum.hpp">floor_sum.hpp</a></li>
    <li><a href="#lagrange-hokan.hpp">lagrange-hokan.hpp</a></li>
    <li><a href="#matrix.hpp">matrix.hpp</a></li>
    <li><a href="#prime.hpp">prime.hpp</a></li>
    <li><a href="#primitive-root.hpp">primitive-root.hpp</a></li>
    <li><a href="#xor-convolution.hpp">xor-convolution.hpp</a></li>
    </ol>
    <li><a class="section" href="#graph">graph</a></li>
    <ol>
    <li><a href="#bcc.hpp">bcc.hpp</a></li>
    <li><a href="#eulerian-trail.hpp">eulerian-trail.hpp</a></li>
    <li><a href="#lowlink.hpp">lowlink.hpp</a></li>
    <li><a href="#max_matching.hpp">max_matching.hpp</a></li>
    <li><a href="#maximum-independent-set.hpp">maximum-independent-set.hpp</a></li>
    <li><a href="#scc.hpp">scc.hpp</a></li>
    <li><a href="#tecc.hpp">tecc.hpp</a></li>
    </ol>
    <li><a class="section" href="#modint">modint</a></li>
    <ol>
    <li><a href="#BarrettReduction.hpp">BarrettReduction.hpp</a></li>
    <li><a href="#modint.hpp">modint.hpp</a></li>
    </ol>
    <li><a class="section" href="#FPS">FPS</a></li>
    <ol>
    <li><a href="#FFT.hpp">FFT.hpp</a></li>
    <li><a href="#linear-recurrence.hpp">linear-recurrence.hpp</a></li>
    <li><a href="#poly.hpp">poly.hpp</a></li>
    <li><a href="#relaxed-convolution.hpp">relaxed-convolution.hpp</a></li>
    </ol>
    <li><a class="section" href="#tree">tree</a></li>
    <ol>
    <li><a href="#block-cut-tree.hpp">block-cut-tree.hpp</a></li>
    <li><a href="#hld.hpp">hld.hpp</a></li>
    </ol>
    <li><a class="section" href="#flow">flow</a></li>
    <ol>
    <li><a href="#bipartite-matching.hpp">bipartite-matching.hpp</a></li>
    <li><a href="#flow.hpp">flow.hpp</a></li>
    <li><a href="#lower-upper-bound-flow.hpp">lower-upper-bound-flow.hpp</a></li>
    <li><a href="#mcf.hpp">mcf.hpp</a></li>
    <li><a href="#二部グラフ.md">二部グラフ.md</a></li>
    <li><a href="#燃やす埋める.md">燃やす埋める.md</a></li>
    </ol>
    <li><a class="section" href="#string">string</a></li>
    <ol>
    <li><a href="#KMP.hpp">KMP.hpp</a></li>
    <li><a href="#Manacher.hpp">Manacher.hpp</a></li>
    <li><a href="#RollingHash.hpp">RollingHash.hpp</a></li>
    <li><a href="#SuffixArray.hpp">SuffixArray.hpp</a></li>
    <li><a href="#Zalgorithm.hpp">Zalgorithm.hpp</a></li>
    <li><a href="#enumerate-runs.hpp">enumerate-runs.hpp</a></li>
    </ol>
    <li><a class="section" href="#geometry">geometry</a></li>
    <ol>
    <li><a href="#argument-sort.hpp">argument-sort.hpp</a></li>
    <li><a href="#circle.hpp">circle.hpp</a></li>
    <li><a href="#convex-hull.hpp">convex-hull.hpp</a></li>
    <li><a href="#funcs.hpp">funcs.hpp</a></li>
    <li><a href="#line.hpp">line.hpp</a></li>
    </ol>
    <li><a class="section" href="#misc">misc</a></li>
    <ol>
    <li><a href="#clock.hpp">clock.hpp</a></li>
    <li><a href="#simplex.hpp">simplex.hpp</a></li>
    </ol>
    <li><a class="section" href="#memo">memo</a></li>
    <ol>
    <li><a href="#Primes.md">Primes.md</a></li>
    <li><a href="#math.md">math.md</a></li>
    </ol>
        </ol>
    </nav>

    
    <h2 class="section" id="template">template</h2>

    <div class="filename">
        <h2 id="0settings.sh">0settings.sh</h2>
    </div>
    <div class="content content-sh">
    <pre><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">CXXFLAGS</span><span class="token operator">=</span><span class="token string">'-O3 -std=c++2a -D_GLIBCXX_DEBUG -D_GLIBCXX_DEBUG_PEDANTIC -Wfatal-errors'</span></code></pre>
</div>

    <div class="filename">
        <h2 id="1template.hpp">1template.hpp</h2>
        md5: f368a0

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ll</span> <span class="token expression"><span class="token keyword">long</span> <span class="token keyword">long</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">pii</span> <span class="token expression">pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">pll</span> <span class="token expression">pair<span class="token operator">&lt;</span>ll<span class="token punctuation">,</span> ll<span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">vi</span> <span class="token expression">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">vl</span> <span class="token expression">vector<span class="token operator">&lt;</span>ll<span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ov4</span><span class="token expression"><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> name</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">rep3</span><span class="token expression"><span class="token punctuation">(</span>i<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span>ll i <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">rep2</span><span class="token expression"><span class="token punctuation">(</span>i<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token function">rep3</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">rep1</span><span class="token expression"><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token function">rep2</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">rep0</span><span class="token expression"><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token function">rep1</span><span class="token punctuation">(</span>aaaaa<span class="token punctuation">,</span> n<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">rep</span><span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">ov4</span><span class="token punctuation">(</span>__VA_ARGS__<span class="token punctuation">,</span> rep3<span class="token punctuation">,</span> rep2<span class="token punctuation">,</span> rep1<span class="token punctuation">,</span> rep0<span class="token punctuation">)</span><span class="token punctuation">(</span>__VA_ARGS__<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">per</span><span class="token expression"><span class="token punctuation">(</span>i<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span>ll i <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">fore</span><span class="token expression"><span class="token punctuation">(</span>e<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;&amp;</span> e <span class="token operator">:</span> v<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">all</span><span class="token expression"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">begin</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">si</span><span class="token expression"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">lb</span><span class="token expression"><span class="token punctuation">(</span>v<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">lower_bound</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">begin</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">eb</span> <span class="token expression">emplace_back</span></span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">S</span><span class="token operator">></span> <span class="token keyword">bool</span> <span class="token function">chmin</span><span class="token punctuation">(</span>T<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> S<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">></span> b <span class="token operator">?</span> a <span class="token operator">=</span> b<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">S</span><span class="token operator">></span> <span class="token keyword">bool</span> <span class="token function">chmax</span><span class="token punctuation">(</span>T<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> S<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">&lt;</span> b <span class="token operator">?</span> a <span class="token operator">=</span> b<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> INF <span class="token operator">=</span> <span class="token number">1e9</span> <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ll INFL <span class="token operator">=</span> <span class="token number">3e18</span> <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">i128</span> <span class="token expression">__int128_t</span></span>

<span class="token keyword">struct</span> <span class="token class-name">_</span> <span class="token punctuation">{</span>
   <span class="token function">_</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span> __<span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="hash.sh">hash.sh</h2>
    </div>
    <div class="content content-sh">
    <pre><code><span class="token comment"># 使い方: sh hash.sh -> コピペ -> Ctrl + D</span>
<span class="token comment"># コメント・空白・改行を削除して md5 でハッシュする</span>
g++ <span class="token parameter variable">-dD</span> <span class="token parameter variable">-E</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">-fpreprocessed</span> - <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token string">'[:space:]'</span> <span class="token operator">|</span> md5sum <span class="token operator">|</span> <span class="token function">cut</span> -c-6
</code></pre>
</div>

    <div class="filename">
        <h2 id="random_test.sh">random_test.sh</h2>
    </div>
    <div class="content content-sh">
    <pre><code><span class="token comment"># correct wrong generate</span>
<span class="token function">make</span> <span class="token variable">$1</span>
<span class="token function">make</span> <span class="token variable">$2</span>
<span class="token function">make</span> <span class="token variable">$3</span>
<span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token keyword">do</span>
./<span class="token variable">$3</span> <span class="token operator">></span> input.txt
<span class="token assign-left variable">c</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>./$1 <span class="token operator">&lt;</span> input.txt<span class="token variable">)</span></span>
<span class="token assign-left variable">w</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>./$2 <span class="token operator">&lt;</span> input.txt<span class="token variable">)</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$w</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> <span class="token string">"pass"</span>
<span class="token keyword">else</span>
<span class="token builtin class-name">echo</span> <span class="token string">"WA"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> input.txt<span class="token variable">)</span></span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"o:"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$c</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"x:"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$w</span>"</span>
<span class="token builtin class-name">exit</span>
<span class="token keyword">fi</span>
<span class="token keyword">done</span></code></pre>
</div>

    <div class="filename">
        <h2 id="rnd.hpp">rnd.hpp</h2>
        md5: a81b0a

    </div>
    <div class="content content-hpp">
    <pre><code>ll <span class="token function">rnd</span><span class="token punctuation">(</span>ll l<span class="token punctuation">,</span> ll r<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">//[l, r)</span>
   <span class="token keyword">static</span> mt19937_64 <span class="token function">gen</span><span class="token punctuation">(</span>chrono<span class="token double-colon punctuation">::</span>steady_clock<span class="token double-colon punctuation">::</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">time_since_epoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">uniform_int_distribution</span><span class="token generic class-name"><span class="token operator">&lt;</span>ll<span class="token operator">></span></span></span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">rndshuf</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token function">rnd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span> vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">rvi</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> T l<span class="token punctuation">,</span> T r<span class="token punctuation">,</span> <span class="token keyword">bool</span> unique <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>unique<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">assert</span><span class="token punctuation">(</span>r <span class="token operator">-</span> l <span class="token operator">>=</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector<span class="token operator">&lt;</span>T<span class="token operator">></span> res<span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span><span class="token function">rnd</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r <span class="token operator">-</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> i<span class="token punctuation">;</span>
      <span class="token function">rndshuf</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">v</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> v<span class="token punctuation">)</span> e <span class="token operator">=</span> <span class="token function">rnd</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> v<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <h2 class="section" id="data-structure">data-structure</h2>

    <div class="filename">
        <h2 id="BIT.hpp">BIT.hpp</h2>
        md5: 5f098b

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">BIT</span> <span class="token punctuation">{</span>
   vl a<span class="token punctuation">;</span>
   <span class="token function">BIT</span><span class="token punctuation">(</span>ll n<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">a</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>ll i<span class="token punctuation">,</span> ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      i<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> x<span class="token punctuation">,</span> i <span class="token operator">+=</span> i <span class="token operator">&amp;</span> <span class="token operator">-</span>i<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   ll <span class="token function">sum</span><span class="token punctuation">(</span>ll r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ll s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> s <span class="token operator">+=</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> r <span class="token operator">-=</span> r <span class="token operator">&amp;</span> <span class="token operator">-</span>r<span class="token punctuation">;</span>
      <span class="token keyword">return</span> s<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   ll <span class="token function">sum</span><span class="token punctuation">(</span>ll l<span class="token punctuation">,</span> ll r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">sum</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">sum</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token comment">// minimize i s.t. sum(i) >= w</span>
   <span class="token keyword">int</span> <span class="token function">lower_bound</span><span class="token punctuation">(</span>ll w<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>w <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> N <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token function">__lg</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span> k<span class="token punctuation">;</span> k <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">+</span> k <span class="token operator">&lt;=</span> N <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>x <span class="token operator">+</span> k<span class="token punctuation">]</span> <span class="token operator">&lt;</span> w<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            w <span class="token operator">-=</span> a<span class="token punctuation">[</span>x <span class="token operator">+</span> k<span class="token punctuation">]</span><span class="token punctuation">;</span>
            x <span class="token operator">+=</span> k<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> x<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="FastSet.hpp">FastSet.hpp</h2>
        md5: 9dd1e2

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token keyword">using</span> U <span class="token operator">=</span> <span class="token keyword">uint64_t</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> U B <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">FS</span> <span class="token punctuation">{</span>
   U n<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>U<span class="token operator">>></span> a<span class="token punctuation">;</span>
   <span class="token function">FS</span><span class="token punctuation">(</span>U n<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">do</span> a<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">+</span> B <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> B<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>ll i<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i <span class="token operator">/</span> B<span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token punctuation">(</span>i <span class="token operator">%</span> B<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span>ll i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> v <span class="token operator">:</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         v<span class="token punctuation">[</span>i <span class="token operator">/</span> B<span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">1ULL</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> B<span class="token punctuation">)</span><span class="token punctuation">;</span>
         i <span class="token operator">/=</span> B<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">erase</span><span class="token punctuation">(</span>ll i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> v <span class="token operator">:</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         v<span class="token punctuation">[</span>i <span class="token operator">/</span> B<span class="token punctuation">]</span> <span class="token operator">&amp;=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">1ULL</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i <span class="token operator">/</span> B<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
         i <span class="token operator">/=</span> B<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   ll <span class="token function">next</span><span class="token punctuation">(</span>ll i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         i<span class="token operator">++</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">/</span> B <span class="token operator">>=</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
         U d <span class="token operator">=</span> a<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">[</span>i <span class="token operator">/</span> B<span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token punctuation">(</span>i <span class="token operator">%</span> B<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            i <span class="token operator">+=</span> <span class="token function">countr_zero</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>h<span class="token operator">--</span><span class="token punctuation">)</span> i <span class="token operator">=</span> i <span class="token operator">*</span> B <span class="token operator">+</span> <span class="token function">countr_zero</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> i<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         i <span class="token operator">/=</span> B<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> n<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   ll <span class="token function">prev</span><span class="token punctuation">(</span>ll i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         i<span class="token operator">--</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
         U d <span class="token operator">=</span> a<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">[</span>i <span class="token operator">/</span> B<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token operator">~</span>i <span class="token operator">%</span> B<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            i <span class="token operator">-=</span> <span class="token function">countl_zero</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>h<span class="token operator">--</span><span class="token punctuation">)</span> i <span class="token operator">=</span> i <span class="token operator">*</span> B <span class="token operator">+</span> <span class="token function">__lg</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> i<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         i <span class="token operator">/=</span> B<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="Skew-Heap.hpp">Skew-Heap.hpp</h2>
        md5: 38dad3

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">bool</span> isMin <span class="token operator">=</span> <span class="token boolean">true</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">SkewHeap</span> <span class="token punctuation">{</span>
   <span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token punctuation">{</span>
      T key<span class="token punctuation">,</span> laz<span class="token punctuation">;</span>
      Node <span class="token operator">*</span>l<span class="token punctuation">,</span> <span class="token operator">*</span>r<span class="token punctuation">;</span>
      <span class="token keyword">int</span> idx<span class="token punctuation">;</span>
      <span class="token function">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
      <span class="token function">Node</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> k<span class="token punctuation">,</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">key</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">laz</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">l</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">r</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">idx</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">using</span> P <span class="token operator">=</span> Node<span class="token operator">*</span><span class="token punctuation">;</span>
   <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">propagate</span><span class="token punctuation">(</span>P x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">-></span>laz <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">-></span>l<span class="token punctuation">)</span> x<span class="token operator">-></span>l<span class="token operator">-></span>laz <span class="token operator">+=</span> x<span class="token operator">-></span>laz<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">-></span>r<span class="token punctuation">)</span> x<span class="token operator">-></span>r<span class="token operator">-></span>laz <span class="token operator">+=</span> x<span class="token operator">-></span>laz<span class="token punctuation">;</span>
      x<span class="token operator">-></span>key <span class="token operator">+=</span> x<span class="token operator">-></span>laz<span class="token punctuation">;</span>
      x<span class="token operator">-></span>laz <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">static</span> P <span class="token function">meld</span><span class="token punctuation">(</span>P x<span class="token punctuation">,</span> P y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>x <span class="token operator">||</span> <span class="token operator">!</span>y<span class="token punctuation">)</span> <span class="token keyword">return</span> x <span class="token operator">?</span> x <span class="token operator">:</span> y<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">comp</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">propagate</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      x<span class="token operator">-></span>r <span class="token operator">=</span> <span class="token function">meld</span><span class="token punctuation">(</span>x<span class="token operator">-></span>r<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">swap</span><span class="token punctuation">(</span>x<span class="token operator">-></span>l<span class="token punctuation">,</span> x<span class="token operator">-></span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> x<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">static</span> P <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> key<span class="token punctuation">,</span> <span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">Node</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">static</span> P <span class="token function">pop</span><span class="token punctuation">(</span>P x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">propagate</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">meld</span><span class="token punctuation">(</span>x<span class="token operator">-></span>l<span class="token punctuation">,</span> x<span class="token operator">-></span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">static</span> P <span class="token function">push</span><span class="token punctuation">(</span>P x<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> key<span class="token punctuation">,</span> <span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">meld</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token function">alloc</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">apply</span><span class="token punctuation">(</span>P x<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> laz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      x<span class="token operator">-></span>laz <span class="token operator">+=</span> laz<span class="token punctuation">;</span>
      <span class="token function">propagate</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span><span class="token operator">:</span>
   <span class="token keyword">static</span> <span class="token keyword">inline</span> <span class="token keyword">bool</span> <span class="token function">comp</span><span class="token punctuation">(</span>P x<span class="token punctuation">,</span> P y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token keyword">constexpr</span><span class="token punctuation">(</span>isMin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> x<span class="token operator">-></span>key <span class="token operator">+</span> x<span class="token operator">-></span>laz <span class="token operator">&lt;</span> y<span class="token operator">-></span>key <span class="token operator">+</span> y<span class="token operator">-></span>laz<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> x<span class="token operator">-></span>key <span class="token operator">+</span> x<span class="token operator">-></span>laz <span class="token operator">></span> y<span class="token operator">-></span>key <span class="token operator">+</span> y<span class="token operator">-></span>laz<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="cht.hpp">cht.hpp</h2>
        md5: a05621

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">bool</span> isMin <span class="token operator">=</span> <span class="token boolean">true</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">CHT</span> <span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">x</span> <span class="token expression">first</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">y</span> <span class="token expression">second</span></span>
   <span class="token function">CHT</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
   deque<span class="token operator">&lt;</span>pll<span class="token operator">></span> v<span class="token punctuation">;</span>
   <span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> v<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> v<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">sgn</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">!</span>x <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">using</span> D <span class="token operator">=</span> <span class="token keyword">long</span> <span class="token keyword">double</span><span class="token punctuation">;</span>
   <span class="token keyword">inline</span> <span class="token keyword">bool</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token keyword">const</span> pll<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> pll<span class="token operator">&amp;</span> b<span class="token punctuation">,</span> <span class="token keyword">const</span> pll<span class="token operator">&amp;</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>y <span class="token operator">==</span> a<span class="token punctuation">.</span>y <span class="token operator">or</span> c<span class="token punctuation">.</span>y <span class="token operator">==</span> b<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">sgn</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>x <span class="token operator">-</span> a<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">sgn</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>y <span class="token operator">-</span> b<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token function">sgn</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>x <span class="token operator">-</span> b<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">sgn</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>y <span class="token operator">-</span> a<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">D</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>x <span class="token operator">-</span> a<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">sgn</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>y <span class="token operator">-</span> b<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">D</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>y <span class="token operator">-</span> a<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token function">D</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>x <span class="token operator">-</span> b<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">sgn</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>y <span class="token operator">-</span> a<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">D</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>y <span class="token operator">-</span> b<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span> ll b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isMin<span class="token punctuation">)</span> a <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      pll <span class="token function">line</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> v<span class="token punctuation">.</span><span class="token function">emplace_front</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>ll c <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span> c <span class="token operator">&lt;=</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>c <span class="token operator">==</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">&lt;=</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
               v<span class="token punctuation">.</span><span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">and</span> <span class="token function">check</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> v<span class="token punctuation">.</span><span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            v<span class="token punctuation">.</span><span class="token function">emplace_front</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">assert</span><span class="token punctuation">(</span>a <span class="token operator">&lt;=</span> v<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x <span class="token operator">==</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y <span class="token operator">&lt;=</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
               v<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">and</span> <span class="token function">check</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">)</span> v<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            v<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   ll <span class="token function">get_y</span><span class="token punctuation">(</span><span class="token keyword">const</span> pll<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> ll<span class="token operator">&amp;</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>x <span class="token operator">*</span> x <span class="token operator">+</span> a<span class="token punctuation">.</span>y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   ll <span class="token function">query</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">get_y</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token function">get_y</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span> l <span class="token operator">=</span> m<span class="token punctuation">;</span>
         <span class="token keyword">else</span> r <span class="token operator">=</span> m<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token function">get_y</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>isMin <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   ll <span class="token function">query_monotone_inc</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">and</span> <span class="token function">get_y</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token function">get_y</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span> v<span class="token punctuation">.</span><span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">get_y</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>isMin <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   ll <span class="token function">query_monotone_dec</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">and</span> <span class="token function">get_y</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token function">get_y</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span> v<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">get_y</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>isMin <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">x</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">y</span></span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="hash_map.hpp">hash_map.hpp</h2>
        md5: 1893ff

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/extc++.h></span></span>
<span class="token keyword">struct</span> <span class="token class-name">chash</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> <span class="token keyword">uint64_t</span> C <span class="token operator">=</span> <span class="token punctuation">(</span>ll<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4e18</span> <span class="token operator">*</span> <span class="token function">acos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">71</span><span class="token punctuation">;</span>
   ll <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">__builtin_bswap64</span><span class="token punctuation">(</span>x <span class="token operator">*</span> C<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> __gnu_pbds<span class="token punctuation">;</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">S</span><span class="token operator">></span> <span class="token keyword">using</span> hash_map <span class="token operator">=</span> gp_hash_table<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> S<span class="token punctuation">,</span> chash<span class="token operator">></span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="lazy-segtree.hpp">lazy-segtree.hpp</h2>
        md5: e79596

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">using</span> U <span class="token operator">=</span> <span class="token keyword">uint64_t</span><span class="token punctuation">;</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token function">S</span> <span class="token punctuation">(</span><span class="token operator">*</span>op<span class="token punctuation">)</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">S</span> <span class="token punctuation">(</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">F</span><span class="token punctuation">,</span> <span class="token function">S</span> <span class="token punctuation">(</span><span class="token operator">*</span>mpp<span class="token punctuation">)</span><span class="token punctuation">(</span>F<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">F</span> <span class="token punctuation">(</span><span class="token operator">*</span>cmpo<span class="token punctuation">)</span><span class="token punctuation">(</span>F<span class="token punctuation">,</span> F<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">F</span> <span class="token punctuation">(</span><span class="token operator">*</span>id<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">lazy_segtree</span> <span class="token punctuation">{</span>
   <span class="token function">lazy_segtree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">lazy_segtree</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">explicit</span> <span class="token function">lazy_segtree</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">lazy_segtree</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>S<span class="token operator">></span></span></span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">explicit</span> <span class="token function">lazy_segtree</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>S<span class="token operator">></span><span class="token operator">&amp;</span> v<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      s <span class="token operator">=</span> <span class="token function">bit_ceil</span><span class="token punctuation">(</span><span class="token function">U</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      log <span class="token operator">=</span> <span class="token function">countr_zero</span><span class="token punctuation">(</span><span class="token function">U</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      d <span class="token operator">=</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>S<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> s<span class="token punctuation">,</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      lz <span class="token operator">=</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>F<span class="token operator">></span></span></span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> d<span class="token punctuation">[</span>s <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> S x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      p <span class="token operator">+=</span> s<span class="token punctuation">;</span>
      <span class="token function">PUSH</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
      d<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> log <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span>p <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   S <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      p <span class="token operator">+=</span> s<span class="token punctuation">;</span>
      <span class="token function">PUSH</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> d<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   S <span class="token function">prod</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      l <span class="token operator">+=</span> s<span class="token punctuation">,</span> r <span class="token operator">+=</span> s<span class="token punctuation">;</span>
      <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> log <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> l<span class="token punctuation">)</span> <span class="token function">push</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> r<span class="token punctuation">)</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      S sml <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> smr <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> sml <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>sml<span class="token punctuation">,</span> d<span class="token punctuation">[</span>l<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> smr <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token operator">--</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> smr<span class="token punctuation">)</span><span class="token punctuation">;</span>
         l <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token function">op</span><span class="token punctuation">(</span>sml<span class="token punctuation">,</span> smr<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   S <span class="token function">all_prod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> F f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// assert(0 &lt;= p &amp;&amp; p &lt; n);</span>
      p <span class="token operator">+=</span> s<span class="token punctuation">;</span>
      <span class="token function">PUSH</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
      d<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">mpp</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> d<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> log <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span>p <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> F f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// assert(0 &lt;= l &amp;&amp; l &lt;= r &amp;&amp; r &lt;= _n);</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      l <span class="token operator">+=</span> s<span class="token punctuation">,</span> r <span class="token operator">+=</span> s<span class="token punctuation">;</span>

      <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> log <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> l<span class="token punctuation">)</span> <span class="token function">push</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> r<span class="token punctuation">)</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">int</span> ml <span class="token operator">=</span> l<span class="token punctuation">,</span> mr <span class="token operator">=</span> r<span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">all_apply</span><span class="token punctuation">(</span>l<span class="token operator">++</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">all_apply</span><span class="token punctuation">(</span><span class="token operator">--</span>r<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
         l <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      l <span class="token operator">=</span> ml<span class="token punctuation">,</span> r <span class="token operator">=</span> mr<span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> log <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> l<span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> r<span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">G</span><span class="token operator">></span> <span class="token keyword">int</span> <span class="token function">max_right</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> G g<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> n<span class="token punctuation">;</span>
      l <span class="token operator">+=</span> s<span class="token punctuation">;</span>
      <span class="token function">PUSH</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      S sm <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">do</span> <span class="token punctuation">{</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">~</span>l <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> l <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token function">op</span><span class="token punctuation">(</span>sm<span class="token punctuation">,</span> d<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token function">push</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
               l <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token function">op</span><span class="token punctuation">(</span>sm<span class="token punctuation">,</span> d<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  sm <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>sm<span class="token punctuation">,</span> d<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  l<span class="token operator">++</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> l <span class="token operator">-</span> s<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         sm <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>sm<span class="token punctuation">,</span> d<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         l<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">&amp;</span> <span class="token operator">-</span>l<span class="token punctuation">)</span> <span class="token operator">!=</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> n<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">G</span><span class="token operator">></span> <span class="token keyword">int</span> <span class="token function">min_left</span><span class="token punctuation">(</span><span class="token keyword">int</span> r<span class="token punctuation">,</span> G g<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
      r <span class="token operator">+=</span> s<span class="token punctuation">;</span>
      <span class="token function">PUSH</span><span class="token punctuation">(</span>r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      S sm <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">do</span> <span class="token punctuation">{</span>
         r<span class="token operator">--</span><span class="token punctuation">;</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> r <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> r <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> sm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">&lt;</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token function">push</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
               r <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> sm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  sm <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> sm<span class="token punctuation">)</span><span class="token punctuation">;</span>
                  r<span class="token operator">--</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> r <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">-</span> s<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         sm <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> sm<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token operator">-</span>r<span class="token punctuation">)</span> <span class="token operator">!=</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   S <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> n<span class="token punctuation">;</span> <span class="token punctuation">}</span>

   <span class="token keyword">private</span><span class="token operator">:</span>
   <span class="token keyword">int</span> n<span class="token punctuation">,</span> s<span class="token punctuation">,</span> log<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>S<span class="token operator">></span> d<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>F<span class="token operator">></span> lz<span class="token punctuation">;</span>
   <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span> d<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> k<span class="token punctuation">]</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">all_apply</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">,</span> F f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      d<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">mpp</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> d<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&lt;</span> s<span class="token punctuation">)</span> lz<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">cmpo</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> lz<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">all_apply</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> k<span class="token punctuation">,</span> lz<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">all_apply</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> lz<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      lz<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">PUSH</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> log <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">push</span><span class="token punctuation">(</span>k <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="li-chao.hpp">li-chao.hpp</h2>
        md5: ca57d5

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token keyword">struct</span> <span class="token class-name">lctree</span> <span class="token punctuation">{</span>
   <span class="token keyword">struct</span> <span class="token class-name">line</span> <span class="token punctuation">{</span>
      ll a<span class="token punctuation">,</span> b<span class="token punctuation">;</span>
      <span class="token function">line</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">b</span><span class="token punctuation">(</span>INFL<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token function">line</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span> ll b<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">a</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">b</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      ll <span class="token function">get</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">*</span> x <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token keyword">inline</span> <span class="token keyword">bool</span> <span class="token function">over</span><span class="token punctuation">(</span>line r<span class="token punctuation">,</span> ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&lt;</span> r<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> n<span class="token punctuation">;</span>

   vector<span class="token operator">&lt;</span>ll<span class="token operator">></span> x<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>line<span class="token operator">></span> seg<span class="token punctuation">;</span>
   <span class="token function">lctree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token function">lctree</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>ll<span class="token operator">></span><span class="token operator">&amp;</span> _x<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">x</span><span class="token punctuation">(</span>_x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> n2 <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> n2<span class="token punctuation">)</span> n <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      x<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> n<span class="token punctuation">)</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>n2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      seg <span class="token operator">=</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>line<span class="token operator">></span></span></span><span class="token punctuation">(</span>n <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">upd</span><span class="token punctuation">(</span>line L<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> mid <span class="token operator">=</span> l <span class="token operator">+</span> r <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">bool</span> lov <span class="token operator">=</span> L<span class="token punctuation">.</span><span class="token function">over</span><span class="token punctuation">(</span>seg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">bool</span> rov <span class="token operator">=</span> L<span class="token punctuation">.</span><span class="token function">over</span><span class="token punctuation">(</span>seg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span>r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>lov <span class="token operator">==</span> rov<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>lov<span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>seg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">bool</span> mov <span class="token operator">=</span> L<span class="token punctuation">.</span><span class="token function">over</span><span class="token punctuation">(</span>seg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>mov<span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>seg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>lov <span class="token operator">!=</span> mov<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r <span class="token operator">=</span> mid<span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> l <span class="token operator">=</span> mid<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">upd</span><span class="token punctuation">(</span>line L<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> ub <span class="token operator">=</span> <span class="token function">bit_width</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">>></span> ub<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> ub<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> r <span class="token operator">=</span> l <span class="token operator">+</span> <span class="token punctuation">(</span>n <span class="token operator">>></span> ub<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">upd</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> i<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span> ll b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">upd</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">update_segment</span><span class="token punctuation">(</span>ll l<span class="token punctuation">,</span> ll r<span class="token punctuation">,</span> ll a<span class="token punctuation">,</span> ll b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      l <span class="token operator">=</span> <span class="token function">lb</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> l<span class="token punctuation">)</span> <span class="token operator">+</span> n<span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token function">lb</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> r<span class="token punctuation">)</span> <span class="token operator">+</span> n<span class="token punctuation">;</span>
      line <span class="token function">L</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span> l <span class="token operator">&lt;</span> r<span class="token punctuation">;</span> l <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">upd</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> l<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">upd</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> <span class="token operator">--</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   ll <span class="token function">query</span><span class="token punctuation">(</span>ll t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ll k <span class="token operator">=</span> <span class="token function">lb</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
      k <span class="token operator">+=</span> n<span class="token punctuation">;</span>
      ll res <span class="token operator">=</span> seg<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>k <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         k <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token function">chmin</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> seg<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="line_container.hpp">line_container.hpp</h2>
        md5: b018d9

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">Line</span> <span class="token punctuation">{</span>
   <span class="token keyword">mutable</span> ll k<span class="token punctuation">,</span> m<span class="token punctuation">,</span> p<span class="token punctuation">;</span>
   <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> Line<span class="token operator">&amp;</span> o<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> k <span class="token operator">&lt;</span> o<span class="token punctuation">.</span>k<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> p <span class="token operator">&lt;</span> x<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">bool</span> ismin <span class="token operator">=</span> <span class="token boolean">true</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">LineContainer</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">multiset</span><span class="token operator">&lt;</span><span class="token class-name">Line</span><span class="token punctuation">,</span> <span class="token class-name">less</span><span class="token operator">&lt;</span><span class="token operator">>></span></span> <span class="token punctuation">{</span>
   <span class="token comment">// (for doubles, use inf = 1/.0, div(a,b) = a/b)</span>
   <span class="token keyword">const</span> ll inf <span class="token operator">=</span> LLONG_MAX <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
   ll <span class="token function">div</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span> ll b<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// floored division</span>
      <span class="token keyword">return</span> a <span class="token operator">/</span> b <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">^</span> b<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">bool</span> <span class="token function">isect</span><span class="token punctuation">(</span>iterator x<span class="token punctuation">,</span> iterator y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">==</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         x<span class="token operator">-></span>p <span class="token operator">=</span> inf<span class="token punctuation">;</span>
         <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">-></span>k <span class="token operator">==</span> y<span class="token operator">-></span>k<span class="token punctuation">)</span> x<span class="token operator">-></span>p <span class="token operator">=</span> x<span class="token operator">-></span>m <span class="token operator">></span> y<span class="token operator">-></span>m <span class="token operator">?</span> inf <span class="token operator">:</span> <span class="token operator">-</span>inf<span class="token punctuation">;</span>
      <span class="token keyword">else</span> x<span class="token operator">-></span>p <span class="token operator">=</span> <span class="token function">div</span><span class="token punctuation">(</span>y<span class="token operator">-></span>m <span class="token operator">-</span> x<span class="token operator">-></span>m<span class="token punctuation">,</span> x<span class="token operator">-></span>k <span class="token operator">-</span> y<span class="token operator">-></span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> x<span class="token operator">-></span>p <span class="token operator">>=</span> y<span class="token operator">-></span>p<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>ll k<span class="token punctuation">,</span> ll m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ismin<span class="token punctuation">)</span> k <span class="token operator">=</span> <span class="token operator">-</span>k<span class="token punctuation">,</span> m <span class="token operator">=</span> <span class="token operator">-</span>m<span class="token punctuation">;</span>
      <span class="token keyword">auto</span> z <span class="token operator">=</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>k<span class="token punctuation">,</span> m<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">=</span> z<span class="token operator">++</span><span class="token punctuation">,</span> x <span class="token operator">=</span> y<span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">isect</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span> z <span class="token operator">=</span> <span class="token function">erase</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">!=</span> <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isect</span><span class="token punctuation">(</span><span class="token operator">--</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">isect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token function">erase</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">=</span> x<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">--</span>x<span class="token punctuation">)</span><span class="token operator">-></span>p <span class="token operator">>=</span> y<span class="token operator">-></span>p<span class="token punctuation">)</span> <span class="token function">isect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token function">erase</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   ll <span class="token function">query</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">auto</span> l <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">lower_bound</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      ll s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ismin<span class="token punctuation">)</span> s <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> s <span class="token operator">*</span> <span class="token punctuation">(</span>l<span class="token punctuation">.</span>k <span class="token operator">*</span> x <span class="token operator">+</span> l<span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="link-cut.hpp">link-cut.hpp</h2>
        md5: e9b023

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token punctuation">{</span>
   <span class="token keyword">typedef</span> Node<span class="token operator">*</span> NP<span class="token punctuation">;</span>
   NP l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> p<span class="token punctuation">;</span>
   <span class="token keyword">bool</span> rev<span class="token punctuation">;</span>
   <span class="token keyword">int</span> v<span class="token punctuation">,</span> mx<span class="token punctuation">,</span> lz<span class="token punctuation">;</span>
   <span class="token function">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">l</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">r</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rev</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token operator">-</span>inf<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mx</span><span class="token punctuation">(</span><span class="token operator">-</span>inf<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">lz</span><span class="token punctuation">(</span><span class="token operator">-</span>inf<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">Propagate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>rev<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">swap</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span> l<span class="token operator">-></span>rev <span class="token operator">^=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> r<span class="token operator">-></span>rev <span class="token operator">^=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
         rev <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span> <span class="token function">chmax</span><span class="token punctuation">(</span>l<span class="token operator">-></span>lz<span class="token punctuation">,</span> lz<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token function">chmax</span><span class="token punctuation">(</span>r<span class="token operator">-></span>lz<span class="token punctuation">,</span> lz<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">chmax</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> lz<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">chmax</span><span class="token punctuation">(</span>mx<span class="token punctuation">,</span> lz<span class="token punctuation">)</span><span class="token punctuation">;</span>
      lz <span class="token operator">=</span> <span class="token operator">-</span>inf<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">GetMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">max</span><span class="token punctuation">(</span>mx<span class="token punctuation">,</span> lz<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">GetVert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">max</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> lz<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">assert</span><span class="token punctuation">(</span>lz <span class="token operator">==</span> <span class="token operator">-</span>inf<span class="token punctuation">)</span><span class="token punctuation">;</span>
      mx <span class="token operator">=</span> v<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">chmax</span><span class="token punctuation">(</span>mx<span class="token punctuation">,</span> l<span class="token operator">-></span><span class="token function">GetMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">chmax</span><span class="token punctuation">(</span>mx<span class="token punctuation">,</span> r<span class="token operator">-></span><span class="token function">GetMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">Pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>p <span class="token operator">&amp;&amp;</span> p<span class="token operator">-></span>l <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>p <span class="token operator">&amp;&amp;</span> p<span class="token operator">-></span>r <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">Prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">Pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> p<span class="token operator">-></span><span class="token function">Prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">Propagate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">Rotate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      NP q <span class="token operator">=</span> p<span class="token punctuation">,</span> c<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">Pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         c <span class="token operator">=</span> l<span class="token punctuation">;</span>
         l <span class="token operator">=</span> p<span class="token punctuation">;</span>
         p<span class="token operator">-></span>r <span class="token operator">=</span> c<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         c <span class="token operator">=</span> r<span class="token punctuation">;</span>
         r <span class="token operator">=</span> p<span class="token punctuation">;</span>
         p<span class="token operator">-></span>l <span class="token operator">=</span> c<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> c<span class="token operator">-></span>p <span class="token operator">=</span> p<span class="token punctuation">;</span>
      p <span class="token operator">=</span> p<span class="token operator">-></span>p<span class="token punctuation">;</span>
      q<span class="token operator">-></span>p <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>p <span class="token operator">&amp;&amp;</span> p<span class="token operator">-></span>l <span class="token operator">==</span> q<span class="token punctuation">)</span> p<span class="token operator">-></span>l <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>p <span class="token operator">&amp;&amp;</span> p<span class="token operator">-></span>r <span class="token operator">==</span> q<span class="token punctuation">)</span> p<span class="token operator">-></span>r <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      q<span class="token operator">-></span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">Splay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">Prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">Pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token function">Pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> b <span class="token operator">=</span> p<span class="token operator">-></span><span class="token function">Pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>b <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> b<span class="token punctuation">)</span> p<span class="token operator">-></span><span class="token function">Rotate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>b <span class="token operator">&amp;&amp;</span> a <span class="token operator">!=</span> b<span class="token punctuation">)</span> <span class="token function">Rotate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">Rotate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">Expose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>NP x <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> x<span class="token punctuation">;</span> x <span class="token operator">=</span> x<span class="token operator">-></span>p<span class="token punctuation">)</span> x<span class="token operator">-></span><span class="token function">Splay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>NP x <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> x<span class="token operator">-></span>p<span class="token punctuation">;</span> x <span class="token operator">=</span> x<span class="token operator">-></span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         x<span class="token operator">-></span>p<span class="token operator">-></span>r <span class="token operator">=</span> x<span class="token punctuation">;</span>
         x<span class="token operator">-></span>p<span class="token operator">-></span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">Splay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">Evert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">Expose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         l<span class="token operator">-></span>rev <span class="token operator">^=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
         l <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
         <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">Link</span><span class="token punctuation">(</span>NP x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">Evert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      p <span class="token operator">=</span> x<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">Set</span><span class="token punctuation">(</span><span class="token keyword">int</span> q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">Expose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      r <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
      <span class="token function">chmax</span><span class="token punctuation">(</span>lz<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">Cut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">Expose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">assert</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      l<span class="token operator">-></span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
      l <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
      <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">Expose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      r <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
      <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">GetMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Node<span class="token operator">*</span> <span class="token function">LCA</span><span class="token punctuation">(</span>Node<span class="token operator">*</span> a<span class="token punctuation">,</span> Node<span class="token operator">*</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   a<span class="token operator">-></span><span class="token function">Expose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   b<span class="token operator">-></span><span class="token function">Expose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>a<span class="token operator">-></span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   Node<span class="token operator">*</span> d <span class="token operator">=</span> a<span class="token punctuation">;</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span>a<span class="token operator">-></span>p <span class="token operator">!=</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">-></span><span class="token function">Pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> d <span class="token operator">=</span> a<span class="token operator">-></span>p<span class="token punctuation">;</span> <span class="token punctuation">}</span>
      a <span class="token operator">=</span> a<span class="token operator">-></span>p<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token operator">-></span>l<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> d<span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> b<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="pbds.hpp">pbds.hpp</h2>
        md5: a38245

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ext/pb_ds/assoc_container.hpp></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ext/pb_ds/priority_queue.hpp></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ext/pb_ds/tag_and_trait.hpp></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ext/pb_ds/tree_policy.hpp></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> __gnu_pbds<span class="token punctuation">;</span>
<span class="token comment">// using namespace __gnu_pbds;</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">using</span> PQ <span class="token operator">=</span> __gnu_pbds<span class="token double-colon punctuation">::</span>priority_queue<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> greater<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">,</span> __gnu_pbds<span class="token double-colon punctuation">::</span>rc_binomial_heap_tag<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">using</span> Trie <span class="token operator">=</span> __gnu_pbds<span class="token double-colon punctuation">::</span>trie<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>
                              __gnu_pbds<span class="token double-colon punctuation">::</span>null_type<span class="token punctuation">,</span>
                              __gnu_pbds<span class="token double-colon punctuation">::</span>trie_string_access_traits<span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">,</span>
                              __gnu_pbds<span class="token double-colon punctuation">::</span>pat_trie_tag<span class="token punctuation">,</span>
                              __gnu_pbds<span class="token double-colon punctuation">::</span>trie_prefix_search_node_update<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token comment">// not a multiset</span>
<span class="token comment">// find_by_order(k) -> itr of k-th(0-based) element</span>
<span class="token comment">// order_of_key(k) -> index of lower_bound(k)</span>
<span class="token keyword">using</span> ordered_set <span class="token operator">=</span> tree<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> null_type<span class="token punctuation">,</span> less<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">,</span> rb_tree_tag<span class="token punctuation">,</span> tree_order_statistics_node_update<span class="token operator">></span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ext/rope></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> __gnu_cxx<span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="rbst.hpp">rbst.hpp</h2>
        md5: b392ca

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token function">T</span> <span class="token punctuation">(</span><span class="token operator">*</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">T</span> <span class="token punctuation">(</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">RBST</span> <span class="token punctuation">{</span>
   <span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">rnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">static</span> <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">123456789</span><span class="token punctuation">;</span>
      <span class="token keyword">static</span> <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">362436069</span><span class="token punctuation">;</span>
      <span class="token keyword">static</span> <span class="token keyword">int</span> z <span class="token operator">=</span> <span class="token number">521288629</span><span class="token punctuation">;</span>
      <span class="token keyword">static</span> <span class="token keyword">int</span> w <span class="token operator">=</span> <span class="token number">88675123</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> t<span class="token punctuation">;</span>

      t <span class="token operator">=</span> x <span class="token operator">^</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;&lt;</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      x <span class="token operator">=</span> y<span class="token punctuation">;</span>
      y <span class="token operator">=</span> z<span class="token punctuation">;</span>
      z <span class="token operator">=</span> w<span class="token punctuation">;</span>
      <span class="token keyword">return</span> w <span class="token operator">=</span> <span class="token punctuation">(</span>w <span class="token operator">^</span> <span class="token punctuation">(</span>w <span class="token operator">>></span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>t <span class="token operator">^</span> <span class="token punctuation">(</span>t <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">struct</span> <span class="token class-name">node</span> <span class="token punctuation">{</span>
      node <span class="token operator">*</span>l<span class="token punctuation">,</span> <span class="token operator">*</span>r<span class="token punctuation">;</span>
      <span class="token keyword">int</span> cnt<span class="token punctuation">;</span>
      T x<span class="token punctuation">,</span> sum<span class="token punctuation">;</span>
      <span class="token function">node</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
      <span class="token function">node</span><span class="token punctuation">(</span>T x<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">l</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">r</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">RBST</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">pool</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">cnt</span><span class="token punctuation">(</span><span class="token keyword">const</span> node<span class="token operator">*</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> t <span class="token operator">?</span> t<span class="token operator">-></span>cnt <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   T <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">const</span> node<span class="token operator">*</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> t <span class="token operator">?</span> t<span class="token operator">-></span>sum <span class="token operator">:</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   node<span class="token operator">*</span> <span class="token function">update</span><span class="token punctuation">(</span>node<span class="token operator">*</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      t<span class="token operator">-></span>cnt <span class="token operator">=</span> <span class="token function">cnt</span><span class="token punctuation">(</span>t<span class="token operator">-></span>l<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">cnt</span><span class="token punctuation">(</span>t<span class="token operator">-></span>r<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      t<span class="token operator">-></span>sum <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>t<span class="token operator">-></span>l<span class="token punctuation">)</span><span class="token punctuation">,</span> t<span class="token operator">-></span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>t<span class="token operator">-></span>r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> t<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   vector<span class="token operator">&lt;</span>node<span class="token operator">></span> pool<span class="token punctuation">;</span>
   <span class="token keyword">int</span> ptr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">inline</span> node<span class="token operator">*</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span> <span class="token operator">==</span> ptr<span class="token punctuation">)</span> pool<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>pool<span class="token punctuation">[</span>ptr<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">node</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   node<span class="token operator">*</span> <span class="token function">merge</span><span class="token punctuation">(</span>node<span class="token operator">*</span> l<span class="token punctuation">,</span> node<span class="token operator">*</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>l <span class="token operator">or</span> <span class="token operator">!</span>r<span class="token punctuation">)</span> <span class="token keyword">return</span> l <span class="token operator">?</span> l <span class="token operator">:</span> r<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">rnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token function">cnt</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">cnt</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">cnt</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         l<span class="token operator">-></span>r <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>l<span class="token operator">-></span>r<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span> <span class="token function">update</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      r<span class="token operator">-></span>l <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token operator">-></span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">update</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   pair<span class="token operator">&lt;</span>node<span class="token operator">*</span><span class="token punctuation">,</span> node<span class="token operator">*</span><span class="token operator">></span> <span class="token function">split</span><span class="token punctuation">(</span>node<span class="token operator">*</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>t<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span>t<span class="token punctuation">,</span> t<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&lt;=</span> <span class="token function">cnt</span><span class="token punctuation">(</span>t<span class="token operator">-></span>l<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">auto</span> <span class="token punctuation">[</span>l<span class="token punctuation">,</span> r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">split</span><span class="token punctuation">(</span>t<span class="token operator">-></span>l<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
         t<span class="token operator">-></span>l <span class="token operator">=</span> r<span class="token punctuation">;</span>
         <span class="token keyword">return</span> <span class="token punctuation">{</span>l<span class="token punctuation">,</span> <span class="token function">update</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">auto</span> <span class="token punctuation">[</span>l<span class="token punctuation">,</span> r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">split</span><span class="token punctuation">(</span>t<span class="token operator">-></span>r<span class="token punctuation">,</span> k <span class="token operator">-</span> <span class="token function">cnt</span><span class="token punctuation">(</span>t<span class="token operator">-></span>l<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      t<span class="token operator">-></span>r <span class="token operator">=</span> l<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token function">update</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>node<span class="token operator">*</span><span class="token operator">&amp;</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">auto</span> <span class="token punctuation">[</span>l<span class="token punctuation">,</span> r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">split</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
      t <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token function">merge</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> <span class="token function">alloc</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="segbeats.hpp">segbeats.hpp</h2>
        md5: 2fbe43

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token keyword">struct</span> <span class="token class-name">Segtree_beats</span> <span class="token punctuation">{</span>
   ll <span class="token function">op</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">,</span> ll x<span class="token punctuation">,</span> ll y<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> type <span class="token operator">?</span> <span class="token function">min</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">max</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">bool</span> <span class="token function">cmp</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">,</span> ll x<span class="token punctuation">,</span> ll y<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> type <span class="token operator">?</span> x <span class="token operator">&lt;</span> y <span class="token operator">:</span> x <span class="token operator">></span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">struct</span> <span class="token keyword">alignas</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> Node <span class="token punctuation">{</span>
      ll sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      ll a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> a2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">-</span>INFL<span class="token punctuation">,</span> INFL<span class="token punctuation">}</span><span class="token punctuation">,</span> ac<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> add <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>

   vector<span class="token operator">&lt;</span>Node<span class="token operator">></span> v<span class="token punctuation">;</span>
   ll n<span class="token punctuation">,</span> log<span class="token punctuation">,</span> e<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">-</span>INFL<span class="token punctuation">,</span> INFL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

   <span class="token function">Segtree_beats</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token function">Segtree_beats</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Segtree_beats</span><span class="token punctuation">(</span><span class="token function">vl</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token function">Segtree_beats</span><span class="token punctuation">(</span><span class="token keyword">const</span> vl<span class="token operator">&amp;</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> log <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> n <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">,</span> log<span class="token operator">++</span><span class="token punctuation">;</span>
      v<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> v<span class="token punctuation">[</span>i <span class="token operator">+</span> n<span class="token punctuation">]</span><span class="token punctuation">.</span>sum <span class="token operator">=</span> v<span class="token punctuation">[</span>i <span class="token operator">+</span> n<span class="token punctuation">]</span><span class="token punctuation">.</span>a1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>i <span class="token operator">+</span> n<span class="token punctuation">]</span><span class="token punctuation">.</span>a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token comment">// 0 : add, 1 : chmin, 2 : chmax, 3 : update</span>
   <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">int</span> cmd<span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      l <span class="token operator">+=</span> n<span class="token punctuation">,</span> r <span class="token operator">+=</span> n<span class="token punctuation">;</span>
      <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> log <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> l<span class="token punctuation">)</span> <span class="token function">push</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> r<span class="token punctuation">)</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token punctuation">{</span>
         <span class="token keyword">int</span> l2 <span class="token operator">=</span> l<span class="token punctuation">,</span> r2 <span class="token operator">=</span> r<span class="token punctuation">;</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token generic-function"><span class="token function">_apply</span><span class="token generic class-name"><span class="token operator">&lt;</span>cmd<span class="token operator">></span></span></span><span class="token punctuation">(</span>l<span class="token operator">++</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token generic-function"><span class="token function">_apply</span><span class="token generic class-name"><span class="token operator">&lt;</span>cmd<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token operator">--</span>r<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            l <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            r <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         l <span class="token operator">=</span> l2<span class="token punctuation">;</span>
         r <span class="token operator">=</span> r2<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> log <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> l<span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> r<span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token comment">// 0 : max, 1 : min, 2 : sum</span>
   <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">int</span> cmd<span class="token operator">></span> ll <span class="token function">fold</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span> e<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">;</span>
      l <span class="token operator">+=</span> n<span class="token punctuation">,</span> r <span class="token operator">+=</span> n<span class="token punctuation">;</span>
      <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> log <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> l<span class="token punctuation">)</span> <span class="token function">push</span><span class="token punctuation">(</span>l <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> r<span class="token punctuation">)</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ll lx <span class="token operator">=</span> e<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">,</span> rx <span class="token operator">=</span> e<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token generic-function"><span class="token function">op</span><span class="token generic class-name"><span class="token operator">&lt;</span>cmd<span class="token operator">></span></span></span><span class="token punctuation">(</span>lx<span class="token punctuation">,</span> v<span class="token punctuation">[</span>l<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token generic-function"><span class="token function">op</span><span class="token generic class-name"><span class="token operator">&lt;</span>cmd<span class="token operator">></span></span></span><span class="token punctuation">(</span>rx<span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token operator">--</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         l <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
         r <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token keyword">constexpr</span><span class="token punctuation">(</span>cmd <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> lx <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> lx<span class="token punctuation">,</span> rx<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token keyword">constexpr</span><span class="token punctuation">(</span>cmd <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> lx <span class="token operator">+=</span> rx<span class="token punctuation">;</span>
      <span class="token keyword">return</span> lx<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span><span class="token operator">:</span>
   <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Node<span class="token operator">&amp;</span> p <span class="token operator">=</span> v<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
      Node<span class="token operator">&amp;</span> l <span class="token operator">=</span> v<span class="token punctuation">[</span>k <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      Node<span class="token operator">&amp;</span> r <span class="token operator">=</span> v<span class="token punctuation">[</span>k <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      p<span class="token punctuation">.</span>sum <span class="token operator">=</span> l<span class="token punctuation">.</span>sum <span class="token operator">+</span> r<span class="token punctuation">.</span>sum<span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">==</span> r<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            p<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
            p<span class="token punctuation">.</span>a2<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> l<span class="token punctuation">.</span>a2<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>a2<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            p<span class="token punctuation">.</span>ac<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">.</span>ac<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">+</span> r<span class="token punctuation">.</span>ac<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">bool</span> f <span class="token operator">=</span> <span class="token function">cmp</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> l<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            p<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> f <span class="token operator">?</span> l<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">:</span> r<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
            p<span class="token punctuation">.</span>ac<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> f <span class="token operator">?</span> l<span class="token punctuation">.</span>ac<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">:</span> r<span class="token punctuation">.</span>ac<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
            p<span class="token punctuation">.</span>a2<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> f <span class="token operator">?</span> r<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">:</span> l<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">,</span> f <span class="token operator">?</span> l<span class="token punctuation">.</span>a2<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">:</span> r<span class="token punctuation">.</span>a2<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">push_add</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">,</span> ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Node<span class="token operator">&amp;</span> p <span class="token operator">=</span> v<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
      p<span class="token punctuation">.</span>sum <span class="token operator">+=</span> x <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>log <span class="token operator">+</span> <span class="token function">__builtin_clz</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         p<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">+=</span> x<span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>a2<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">!=</span> e<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span> p<span class="token punctuation">.</span>a2<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">+=</span> x<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      p<span class="token punctuation">.</span>add <span class="token operator">+=</span> x<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">int</span> cmd<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Node<span class="token operator">&amp;</span> p <span class="token operator">=</span> v<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
      p<span class="token punctuation">.</span>sum <span class="token operator">+=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> p<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> p<span class="token punctuation">.</span>ac<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>cmd <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> p<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span> p<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>cmd <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>a2<span class="token punctuation">[</span>cmd <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> p<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span> p<span class="token punctuation">.</span>a2<span class="token punctuation">[</span>cmd <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
      p<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Node<span class="token operator">&amp;</span> p <span class="token operator">=</span> v<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>add<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token function">push_add</span><span class="token punctuation">(</span>k <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> t<span class="token punctuation">,</span> p<span class="token punctuation">.</span>add<span class="token punctuation">)</span><span class="token punctuation">;</span>
         p<span class="token punctuation">.</span>add <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token function">rep</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">cmp</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> v<span class="token punctuation">[</span>k <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> s<span class="token punctuation">]</span><span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">push</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> k <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> s<span class="token punctuation">,</span> p<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">subtree_ch</span><span class="token punctuation">(</span><span class="token keyword">int</span> cmd<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">cmp</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> v<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>a1<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">cmp</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> x<span class="token punctuation">,</span> v<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>a2<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">push</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> k<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token function">push</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token function">subtree_ch</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> k <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> t<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">update</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">int</span> cmd<span class="token operator">></span> <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">_apply</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">,</span> ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>cmd <span class="token operator">>></span> i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">subtree_ch</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token keyword">constexpr</span><span class="token punctuation">(</span>cmd <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">push_add</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">int</span> cmd<span class="token operator">></span> <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">op</span><span class="token punctuation">(</span>ll<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> Node<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token keyword">constexpr</span><span class="token punctuation">(</span>cmd <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> a <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">.</span>a1<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token keyword">constexpr</span><span class="token punctuation">(</span>cmd <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> a <span class="token operator">+=</span> b<span class="token punctuation">.</span>sum<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="segtree-2d.hpp">segtree-2d.hpp</h2>
        md5: 1301f7

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token function">T</span> <span class="token punctuation">(</span><span class="token operator">*</span>op<span class="token punctuation">)</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">T</span> <span class="token punctuation">(</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">RangeTree</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span><span class="token operator">:</span>
   <span class="token keyword">int</span> n<span class="token punctuation">,</span> sz<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>segtree<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> op<span class="token punctuation">,</span> e<span class="token operator">>></span> seg<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>pll<span class="token operator">>></span> yx<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>pll<span class="token operator">></span> sorted<span class="token punctuation">;</span>

   <span class="token keyword">void</span> <span class="token function">update_</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> ll x<span class="token punctuation">,</span> ll y<span class="token punctuation">,</span> T val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      id <span class="token operator">+=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> yid <span class="token operator">=</span> <span class="token function">lb</span><span class="token punctuation">(</span>yx<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">pll</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      seg<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>yid<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>id <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         id <span class="token operator">=</span> <span class="token punctuation">(</span>id <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
         <span class="token keyword">int</span> yid <span class="token operator">=</span> <span class="token function">lb</span><span class="token punctuation">(</span>yx<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">pll</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         seg<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>yid<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   T <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> lxid<span class="token punctuation">,</span> <span class="token keyword">int</span> rxid<span class="token punctuation">,</span> ll ly<span class="token punctuation">,</span> ll ry<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&lt;=</span> lxid <span class="token operator">||</span> rxid <span class="token operator">&lt;=</span> l<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>lxid <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> rxid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> lyid <span class="token operator">=</span> <span class="token function">lb</span><span class="token punctuation">(</span>yx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">pll</span><span class="token punctuation">(</span>ly<span class="token punctuation">,</span> <span class="token operator">-</span>INFL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">int</span> ryid <span class="token operator">=</span> <span class="token function">lb</span><span class="token punctuation">(</span>yx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">pll</span><span class="token punctuation">(</span>ry<span class="token punctuation">,</span> <span class="token operator">-</span>INFL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span> <span class="token punctuation">(</span>lyid <span class="token operator">>=</span> ryid<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> seg<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">prod</span><span class="token punctuation">(</span>lyid<span class="token punctuation">,</span> ryid<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> <span class="token function">op</span><span class="token punctuation">(</span><span class="token function">query</span><span class="token punctuation">(</span>lxid<span class="token punctuation">,</span> rxid<span class="token punctuation">,</span> ly<span class="token punctuation">,</span> ry<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> l<span class="token punctuation">,</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   <span class="token function">query</span><span class="token punctuation">(</span>lxid<span class="token punctuation">,</span> rxid<span class="token punctuation">,</span> ly<span class="token punctuation">,</span> ry<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> k <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span><span class="token operator">:</span>
   <span class="token comment">// 座標, 点の値</span>
   <span class="token function">RangeTree</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>pll<span class="token operator">></span><span class="token operator">&amp;</span> cand<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> val<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sz</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>cand<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sorted</span><span class="token punctuation">(</span>sz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> sz<span class="token punctuation">)</span> n <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> sz<span class="token punctuation">)</span> sorted<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>cand<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">,</span> i<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>sorted<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>pll<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> pll<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>first <span class="token operator">==</span> b<span class="token punctuation">.</span>first<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span>cand<span class="token punctuation">[</span>a<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">&lt;</span> cand<span class="token punctuation">[</span>b<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>first <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      yx<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> seg<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> sz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         yx<span class="token punctuation">[</span>i <span class="token operator">+</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>sorted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">,</span> sorted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
         vector<span class="token operator">&lt;</span>T<span class="token operator">></span> arg <span class="token operator">=</span> <span class="token punctuation">{</span>val<span class="token punctuation">[</span>sorted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
         seg<span class="token punctuation">[</span>i <span class="token operator">+</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">segtree</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token punctuation">,</span> op<span class="token punctuation">,</span> e<span class="token operator">></span></span></span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
         sorted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">=</span> cand<span class="token punctuation">[</span>sorted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         yx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>yx<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">si</span><span class="token punctuation">(</span>yx<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>yx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
         <span class="token function">merge</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>yx<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">all</span><span class="token punctuation">(</span>yx<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>pll<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> pll<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>cand<span class="token punctuation">[</span>a<span class="token punctuation">.</span>first<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">==</span> cand<span class="token punctuation">[</span>b<span class="token punctuation">.</span>first<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>second <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>second<span class="token punctuation">)</span>
                                                                  <span class="token operator">:</span> <span class="token punctuation">(</span>cand<span class="token punctuation">[</span>a<span class="token punctuation">.</span>first<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">&lt;</span> cand<span class="token punctuation">[</span>b<span class="token punctuation">.</span>first<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">arg</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>yx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>yx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> arg<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">[</span>yx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">]</span><span class="token punctuation">;</span>
         seg<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">segtree</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token punctuation">,</span> op<span class="token punctuation">,</span> e<span class="token operator">></span></span></span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">:</span> yx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> a <span class="token operator">=</span> cand<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span>ll x<span class="token punctuation">,</span> ll y<span class="token punctuation">,</span> T val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> id <span class="token operator">=</span> <span class="token function">lb</span><span class="token punctuation">(</span>sorted<span class="token punctuation">,</span> <span class="token function">pll</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">update_</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   T <span class="token function">query</span><span class="token punctuation">(</span>ll lx<span class="token punctuation">,</span> ll ly<span class="token punctuation">,</span> ll rx<span class="token punctuation">,</span> ll ry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> lxid <span class="token operator">=</span> <span class="token function">lb</span><span class="token punctuation">(</span>sorted<span class="token punctuation">,</span> <span class="token function">pll</span><span class="token punctuation">(</span>lx<span class="token punctuation">,</span> <span class="token operator">-</span>INFL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> rxid <span class="token operator">=</span> <span class="token function">lb</span><span class="token punctuation">(</span>sorted<span class="token punctuation">,</span> <span class="token function">pll</span><span class="token punctuation">(</span>rx<span class="token punctuation">,</span> <span class="token operator">-</span>INFL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>lxid <span class="token operator">>=</span> rxid<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">query</span><span class="token punctuation">(</span>lxid<span class="token punctuation">,</span> rxid<span class="token punctuation">,</span> ly<span class="token punctuation">,</span> ry<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="segtree.hpp">segtree.hpp</h2>
        md5: f8e201

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token function">S</span> <span class="token punctuation">(</span><span class="token operator">*</span>op<span class="token punctuation">)</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">S</span> <span class="token punctuation">(</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">segtree</span> <span class="token punctuation">{</span>
   <span class="token function">segtree</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">segtree</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>S<span class="token operator">></span></span></span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token function">segtree</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>S<span class="token operator">></span><span class="token operator">&amp;</span> v<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      s <span class="token operator">=</span> <span class="token function">bit_ceil</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      log <span class="token operator">=</span> <span class="token function">countr_zero</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      d <span class="token operator">=</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>S<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> s<span class="token punctuation">,</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> d<span class="token punctuation">[</span>s <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> S x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      d<span class="token punctuation">[</span>p <span class="token operator">+=</span> s<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> log <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span>p <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   S <span class="token function">prod</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      S sml <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> smr <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      l <span class="token operator">+=</span> s<span class="token punctuation">,</span> r <span class="token operator">+=</span> s<span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> sml <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>sml<span class="token punctuation">,</span> d<span class="token punctuation">[</span>l<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> smr <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token operator">--</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> smr<span class="token punctuation">)</span><span class="token punctuation">;</span>
         l <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token function">op</span><span class="token punctuation">(</span>sml<span class="token punctuation">,</span> smr<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   S <span class="token function">all_prod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">F</span><span class="token operator">></span> <span class="token keyword">int</span> <span class="token function">max_right</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> F f<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> n<span class="token punctuation">;</span>
      l <span class="token operator">+=</span> s<span class="token punctuation">;</span>
      S sm <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">do</span> <span class="token punctuation">{</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">~</span>l <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> l <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token function">op</span><span class="token punctuation">(</span>sm<span class="token punctuation">,</span> d<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               l <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token function">op</span><span class="token punctuation">(</span>sm<span class="token punctuation">,</span> d<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> sm <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>sm<span class="token punctuation">,</span> d<span class="token punctuation">[</span>l<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> l <span class="token operator">-</span> s<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         sm <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>sm<span class="token punctuation">,</span> d<span class="token punctuation">[</span>l<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">&amp;</span> <span class="token operator">-</span>l<span class="token punctuation">)</span> <span class="token operator">!=</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> n<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">F</span><span class="token operator">></span> <span class="token keyword">int</span> <span class="token function">min_left</span><span class="token punctuation">(</span><span class="token keyword">int</span> r<span class="token punctuation">,</span> F f<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>r<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
      r <span class="token operator">+=</span> s<span class="token punctuation">;</span>
      S sm <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">do</span> <span class="token punctuation">{</span>
         r<span class="token operator">--</span><span class="token punctuation">;</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">and</span> r <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> r <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> sm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">&lt;</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               r <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> sm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> sm <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>r<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sm<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> r <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">-</span> s<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         sm <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> sm<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token operator">-</span>r<span class="token punctuation">)</span> <span class="token operator">!=</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span><span class="token operator">:</span>
   <span class="token keyword">int</span> n<span class="token punctuation">,</span> s<span class="token punctuation">,</span> log<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>S<span class="token operator">></span> d<span class="token punctuation">;</span>
   <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span> d<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>k <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span>k <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="sparse-table-disjoint.hpp">sparse-table-disjoint.hpp</h2>
        md5: 198e80

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">F</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">sptable</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> F f<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>T<span class="token operator">>></span> a<span class="token punctuation">;</span>
   vi l<span class="token punctuation">;</span>

   <span class="token function">sptable</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> v<span class="token punctuation">,</span> F f<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">f</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> m<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">++</span>m<span class="token punctuation">;</span>
      a<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> s <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">;</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span> j <span class="token operator">+=</span> s <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>j <span class="token operator">+</span> s<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">per</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> t<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
            a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>t <span class="token operator">+</span> s<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">rep</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> t <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      l<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span> l<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">[</span>i <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   T <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">>=</span> <span class="token operator">--</span>y<span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> p <span class="token operator">=</span> l<span class="token punctuation">[</span>x <span class="token operator">^</span> y<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="swag.hpp">swag.hpp</h2>
        md5: 85c3df

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">F</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">SWAG</span> <span class="token punctuation">{</span>
   <span class="token keyword">using</span> vp <span class="token operator">=</span> vector<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> T<span class="token operator">>></span><span class="token punctuation">;</span>
   vp a<span class="token punctuation">,</span> b<span class="token punctuation">;</span>
   F f<span class="token punctuation">;</span>
   T I<span class="token punctuation">;</span>
   <span class="token function">SWAG</span><span class="token punctuation">(</span>F f<span class="token punctuation">,</span> T i<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">f</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">I</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

   <span class="token keyword">private</span><span class="token operator">:</span>
   T <span class="token function">get</span><span class="token punctuation">(</span>vp<span class="token operator">&amp;</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">empty</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">?</span> I <span class="token operator">:</span> v<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>second<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">pusha</span><span class="token punctuation">(</span>T x<span class="token punctuation">)</span> <span class="token punctuation">{</span> a<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token function">get</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">pushb</span><span class="token punctuation">(</span>T x<span class="token punctuation">)</span> <span class="token punctuation">{</span> b<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token comment">// reversed!!</span>
   <span class="token keyword">void</span> <span class="token function">rebalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">si</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> s0 <span class="token operator">=</span> n <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token function">empty</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">?</span> n <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      vp v<span class="token punctuation">{</span>a<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">copy</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      a<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> s0<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">pusha</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> s0<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token function">pushb</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span><span class="token operator">:</span>
   T <span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> b<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> a<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   T <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> a<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> b<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">empty</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">rebalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      a<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">empty</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">rebalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      b<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   T <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">get</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="wavelet_matrix.hpp">wavelet_matrix.hpp</h2>
        md5: dec827

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">U</span> <span class="token expression"><span class="token keyword">uint32_t</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">L</span> <span class="token expression"><span class="token keyword">uint64_t</span></span></span>
<span class="token keyword">struct</span> <span class="token class-name">bit_vector</span> <span class="token punctuation">{</span>
   <span class="token keyword">static</span> <span class="token keyword">constexpr</span> U w <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>L<span class="token operator">></span> block<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>U<span class="token operator">></span> count<span class="token punctuation">;</span>
   <span class="token keyword">int</span> n<span class="token punctuation">,</span> zeros<span class="token punctuation">;</span>

   <span class="token keyword">inline</span> U <span class="token function">get</span><span class="token punctuation">(</span>U i<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">U</span><span class="token punctuation">(</span>block<span class="token punctuation">[</span>i <span class="token operator">/</span> w<span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token punctuation">(</span>i <span class="token operator">%</span> w<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span>U i<span class="token punctuation">)</span> <span class="token punctuation">{</span> block<span class="token punctuation">[</span>i <span class="token operator">/</span> w<span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">1LL</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

   <span class="token function">bit_vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token function">bit_vector</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">init</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">int</span> _n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      n <span class="token operator">=</span> zeros <span class="token operator">=</span> _n<span class="token punctuation">;</span>
      block<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>n <span class="token operator">/</span> w <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      count<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span><span class="token punctuation">)</span> count<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> count<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">popcount</span><span class="token punctuation">(</span>block<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      zeros <span class="token operator">=</span> <span class="token function">rank0</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">inline</span> U <span class="token function">rank0</span><span class="token punctuation">(</span>U i<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> i <span class="token operator">-</span> <span class="token function">rank1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">inline</span> U <span class="token function">rank1</span><span class="token punctuation">(</span>U i<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> count<span class="token punctuation">[</span>i <span class="token operator">/</span> w<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">popcount</span><span class="token punctuation">(</span>block<span class="token punctuation">[</span>i <span class="token operator">/</span> w<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1ULL</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">%</span> w<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> lg <span class="token operator">=</span> <span class="token number">31</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">WaveletMatrix</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>T<span class="token operator">></span> a<span class="token punctuation">;</span>
   array<span class="token operator">&lt;</span>bit_vector<span class="token punctuation">,</span> lg<span class="token operator">></span> bv<span class="token punctuation">;</span>
   <span class="token function">WaveletMatrix</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> _a<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span>_a<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">a</span><span class="token punctuation">(</span>_a<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">build2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> lg<span class="token punctuation">)</span> bv<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">bit_vector</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector<span class="token operator">&lt;</span>T<span class="token operator">></span> cur <span class="token operator">=</span> a<span class="token punctuation">,</span> <span class="token function">nxt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">per</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> lg<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>cur<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>></span> h <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         array<span class="token operator">&lt;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>nxt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">></span> it<span class="token punctuation">{</span><span class="token function">begin</span><span class="token punctuation">(</span>nxt<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">begin</span><span class="token punctuation">(</span>nxt<span class="token punctuation">)</span> <span class="token operator">+</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>zeros<span class="token punctuation">}</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> it<span class="token punctuation">[</span>bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">++</span> <span class="token operator">=</span> cur<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token function">swap</span><span class="token punctuation">(</span>cur<span class="token punctuation">,</span> nxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">inline</span> pair<span class="token operator">&lt;</span>U<span class="token punctuation">,</span> U<span class="token operator">></span> <span class="token function">succ0</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> h<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">make_pair</span><span class="token punctuation">(</span>bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank0</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank0</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

   <span class="token keyword">inline</span> pair<span class="token operator">&lt;</span>U<span class="token punctuation">,</span> U<span class="token operator">></span> <span class="token function">succ1</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> h<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      U l0 <span class="token operator">=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank0</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      U r0 <span class="token operator">=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank0</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      U zeros <span class="token operator">=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>zeros<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">make_pair</span><span class="token punctuation">(</span>l <span class="token operator">+</span> zeros <span class="token operator">-</span> l0<span class="token punctuation">,</span> r <span class="token operator">+</span> zeros <span class="token operator">-</span> r0<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   T <span class="token function">access</span><span class="token punctuation">(</span>U k<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      T ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token function">per</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> lg<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         U f <span class="token operator">=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
         ret <span class="token operator">|=</span> f <span class="token operator">?</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> h <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
         k <span class="token operator">=</span> f <span class="token operator">?</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank1</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">+</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>zeros <span class="token operator">:</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank0</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   T <span class="token function">kth_smallest</span><span class="token punctuation">(</span>U l<span class="token punctuation">,</span> U r<span class="token punctuation">,</span> U k<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      T res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> h <span class="token operator">=</span> lg <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> h <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         U l0 <span class="token operator">=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank0</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span> r0 <span class="token operator">=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank0</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&lt;</span> r0 <span class="token operator">-</span> l0<span class="token punctuation">)</span> l <span class="token operator">=</span> l0<span class="token punctuation">,</span> r <span class="token operator">=</span> r0<span class="token punctuation">;</span>
         <span class="token keyword">else</span> <span class="token punctuation">{</span>
            k <span class="token operator">-=</span> r0 <span class="token operator">-</span> l0<span class="token punctuation">;</span>
            res <span class="token operator">|=</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> h<span class="token punctuation">;</span>
            l <span class="token operator">+=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>zeros <span class="token operator">-</span> l0<span class="token punctuation">,</span> r <span class="token operator">+=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>zeros <span class="token operator">-</span> r0<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   T <span class="token function">kth_largest</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">kth_smallest</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> r <span class="token operator">-</span> l <span class="token operator">-</span> k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

   <span class="token keyword">int</span> <span class="token function">range_freq</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> T upper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>upper <span class="token operator">>=</span> <span class="token punctuation">(</span><span class="token function">T</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> lg<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> r <span class="token operator">-</span> l<span class="token punctuation">;</span>
      <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token function">per</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> lg<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">bool</span> f <span class="token operator">=</span> <span class="token punctuation">(</span>upper <span class="token operator">>></span> h<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>
         U l0 <span class="token operator">=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank0</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span> r0 <span class="token operator">=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank0</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ret <span class="token operator">+=</span> r0 <span class="token operator">-</span> l0<span class="token punctuation">;</span>
            l <span class="token operator">+=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>zeros <span class="token operator">-</span> l0<span class="token punctuation">;</span>
            r <span class="token operator">+=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>zeros <span class="token operator">-</span> r0<span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            l <span class="token operator">=</span> l0<span class="token punctuation">;</span>
            r <span class="token operator">=</span> r0<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">range_freq</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> T lower<span class="token punctuation">,</span> T upper<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">range_freq</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> upper<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">range_freq</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> lower<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

   array<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>ll<span class="token operator">></span><span class="token punctuation">,</span> lg<span class="token operator">></span> sums<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>ll<span class="token operator">></span> acc<span class="token punctuation">;</span>
   <span class="token keyword">void</span> <span class="token function">build2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> lg<span class="token punctuation">)</span> bv<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">bit_vector</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> sums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      acc<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector<span class="token operator">&lt;</span>T<span class="token operator">></span> cur <span class="token operator">=</span> a<span class="token punctuation">,</span> <span class="token function">nxt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">per</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> lg<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>cur<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>></span> h<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         array<span class="token operator">&lt;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>nxt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">></span> it<span class="token punctuation">{</span><span class="token function">begin</span><span class="token punctuation">(</span>nxt<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">begin</span><span class="token punctuation">(</span>nxt<span class="token punctuation">)</span> <span class="token operator">+</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>zeros<span class="token punctuation">}</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> it<span class="token punctuation">[</span>bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">++</span> <span class="token operator">=</span> cur<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token function">swap</span><span class="token punctuation">(</span>cur<span class="token punctuation">,</span> nxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> sums<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> sums<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> cur<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> acc<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> acc<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   ll <span class="token function">bottom_k_sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ll res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token function">per</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> lg<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         U l0 <span class="token operator">=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank0</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span> r0 <span class="token operator">=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">rank0</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&lt;</span> r0 <span class="token operator">-</span> l0<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            l <span class="token operator">=</span> l0<span class="token punctuation">,</span> r <span class="token operator">=</span> r0<span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            res <span class="token operator">+=</span> sums<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">[</span>r0<span class="token punctuation">]</span> <span class="token operator">-</span> sums<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">[</span>l0<span class="token punctuation">]</span><span class="token punctuation">;</span>
            k <span class="token operator">-=</span> r0 <span class="token operator">-</span> l0<span class="token punctuation">;</span>
            l <span class="token operator">+=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>zeros <span class="token operator">-</span> l0<span class="token punctuation">;</span>
            r <span class="token operator">+=</span> bv<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>zeros <span class="token operator">-</span> r0<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      res <span class="token operator">+=</span> sums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l <span class="token operator">+</span> k<span class="token punctuation">]</span> <span class="token operator">-</span> sums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   ll <span class="token function">top_k_sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> acc<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">-</span> acc<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token function">bottom_k_sum</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> r <span class="token operator">-</span> l <span class="token operator">-</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">U</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">L</span></span></code></pre>
</div>

    <h2 class="section" id="dp">dp</h2>

    <div class="filename">
        <h2 id="d-edge-monge.hpp">d-edge-monge.hpp</h2>
        md5: 4ab7ee

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">T</span> <span class="token operator">=</span> <span class="token keyword">decltype</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">declval</span><span class="token generic class-name"><span class="token operator">&lt;</span>C<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span> T <span class="token function">incremental_monge_shortest_path</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> C init<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">class</span> <span class="token class-name">env</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
      C mid<span class="token punctuation">;</span>
      C last<span class="token punctuation">;</span>
      <span class="token keyword">int</span> prev<span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>env<span class="token operator">></span> nodes<span class="token punctuation">;</span>
   <span class="token punctuation">{</span>
      <span class="token keyword">int</span> n_ <span class="token operator">=</span> n<span class="token punctuation">;</span>
      <span class="token keyword">int</span> d <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>n_ <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         n_ <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">;</span>
         d <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      nodes<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token punctuation">{</span>init<span class="token punctuation">,</span> init<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">dp</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">const</span> <span class="token keyword">auto</span> f <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> f<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> d<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">int</span> <span class="token punctuation">{</span>
      <span class="token keyword">auto</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>mid<span class="token punctuation">,</span> last<span class="token punctuation">,</span> prev<span class="token punctuation">]</span> <span class="token operator">=</span> nodes<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token keyword">int</span> w <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">>></span> d<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> r<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> mid<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
         <span class="token keyword">const</span> <span class="token keyword">int</span> next <span class="token operator">=</span> r <span class="token operator">+</span> w <span class="token operator">&lt;=</span> n <span class="token operator">?</span> <span class="token function">f</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> d <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">+</span> w<span class="token punctuation">)</span> <span class="token operator">:</span> r <span class="token operator">-</span> w<span class="token punctuation">;</span>
         <span class="token keyword">int</span> argmin <span class="token operator">=</span> prev<span class="token punctuation">;</span>
         dp<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> dp<span class="token punctuation">[</span>argmin<span class="token punctuation">]</span> <span class="token operator">+</span> mid<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> prev<span class="token punctuation">;</span> i <span class="token operator">!=</span> next<span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mid<span class="token punctuation">.</span><span class="token function">pop_front</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> T t <span class="token operator">=</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> mid<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">></span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               dp<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
               argmin <span class="token operator">=</span> i<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
         prev <span class="token operator">=</span> next<span class="token punctuation">;</span>
         <span class="token keyword">return</span> argmin<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> r<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> last<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">-</span> <span class="token number">3</span> <span class="token operator">*</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> r <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> w<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> last<span class="token punctuation">.</span><span class="token function">pop_front</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
         <span class="token keyword">int</span> argmin <span class="token operator">=</span> prev<span class="token punctuation">;</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> r <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> w<span class="token punctuation">;</span> i <span class="token operator">!=</span> r <span class="token operator">-</span> w<span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            last<span class="token punctuation">.</span><span class="token function">pop_front</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> T t <span class="token operator">=</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> last<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">></span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               dp<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
               argmin <span class="token operator">=</span> i<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">return</span> argmin<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>

   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">f</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

   <span class="token keyword">return</span> dp<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">namespace</span> golden_section_search_impl <span class="token punctuation">{</span>

<span class="token keyword">using</span> i64 <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token keyword">int64_t</span><span class="token punctuation">;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">F</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">T</span> <span class="token operator">=</span> <span class="token keyword">decltype</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">declval</span><span class="token generic class-name"><span class="token operator">&lt;</span>F<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">declval</span><span class="token generic class-name"><span class="token operator">&lt;</span>i64<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Compare</span> <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>less<span class="token operator">&lt;</span>T<span class="token operator">>></span>
std<span class="token double-colon punctuation">::</span>pair<span class="token operator">&lt;</span>i64<span class="token punctuation">,</span> T<span class="token operator">></span> <span class="token function">golden_section_search</span><span class="token punctuation">(</span>F f<span class="token punctuation">,</span> i64 min<span class="token punctuation">,</span> i64 max<span class="token punctuation">,</span> Compare comp <span class="token operator">=</span> <span class="token function">Compare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">assert</span><span class="token punctuation">(</span>min <span class="token operator">&lt;=</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>

   i64 a <span class="token operator">=</span> min <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> b<span class="token punctuation">;</span>
   <span class="token punctuation">{</span>
      i64 s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> t <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>t <span class="token operator">&lt;</span> max <span class="token operator">-</span> min <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>s <span class="token operator">+=</span> t<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      x <span class="token operator">=</span> a <span class="token operator">+</span> t <span class="token operator">-</span> s<span class="token punctuation">;</span>
      b <span class="token operator">=</span> a <span class="token operator">+</span> t<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   T fx <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> fy<span class="token punctuation">;</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b <span class="token operator">!=</span> <span class="token number">2</span> <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> i64 y <span class="token operator">=</span> a <span class="token operator">+</span> b <span class="token operator">-</span> x<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>max <span class="token operator">&lt;</span> y <span class="token operator">||</span> <span class="token function">comp</span><span class="token punctuation">(</span>fx<span class="token punctuation">,</span> <span class="token punctuation">(</span>fy <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         b <span class="token operator">=</span> a<span class="token punctuation">;</span>
         a <span class="token operator">=</span> y<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         a <span class="token operator">=</span> x<span class="token punctuation">;</span>
         x <span class="token operator">=</span> y<span class="token punctuation">;</span>
         fx <span class="token operator">=</span> fy<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> <span class="token punctuation">{</span>x<span class="token punctuation">,</span> fx<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">}</span>  <span class="token comment">// namespace golden_section_search_impl</span>

<span class="token keyword">using</span> golden_section_search_impl<span class="token double-colon punctuation">::</span>golden_section_search<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">cost</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>ll<span class="token operator">></span><span class="token operator">*</span> a<span class="token punctuation">;</span>
   ll lambda<span class="token punctuation">;</span>
   ll cost<span class="token punctuation">;</span>
   <span class="token keyword">void</span> <span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   ll <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> lambda <span class="token operator">+</span> c <span class="token punctuation">}</span>  <span class="token comment">// 最小化なら -</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// k : 使う辺の本数</span>
<span class="token keyword">const</span> <span class="token keyword">auto</span> f <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>ll l<span class="token punctuation">)</span> <span class="token operator">-></span> ll <span class="token punctuation">{</span>
   <span class="token keyword">auto</span> res <span class="token operator">=</span> <span class="token function">incremental_monge_shortest_path</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> cost<span class="token punctuation">{</span>l<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">-</span> l <span class="token operator">*</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// L = - max(|e|) * 3, R = max(|e|) * 3</span>
<span class="token function">OUT</span><span class="token punctuation">(</span><span class="token function">golden_section_search</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> L<span class="token punctuation">,</span> R<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">greater</span><span class="token generic class-name"><span class="token operator">&lt;</span>ll<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>se<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="mo-rollback.hpp">mo-rollback.hpp</h2>
        md5: 5737bf

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token keyword">struct</span> <span class="token class-name">MoRollBack</span> <span class="token punctuation">{</span>
   <span class="token keyword">using</span> ADD <span class="token operator">=</span> function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">;</span>
   <span class="token keyword">using</span> REM <span class="token operator">=</span> function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">;</span>
   <span class="token keyword">using</span> RESET <span class="token operator">=</span> function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">;</span>
   <span class="token keyword">using</span> SNAP <span class="token operator">=</span> function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">;</span>
   <span class="token keyword">using</span> ROLLBACK <span class="token operator">=</span> function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> w<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> ord<span class="token punctuation">;</span>
   <span class="token function">MoRollBack</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ord</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">iota</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>ord<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* [l, r) */</span>
      l<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
      r<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token keyword">const</span> ADD<span class="token operator">&amp;</span> add<span class="token punctuation">,</span> <span class="token keyword">const</span> REM<span class="token operator">&amp;</span> rem<span class="token punctuation">,</span> <span class="token keyword">const</span> RESET<span class="token operator">&amp;</span> reset<span class="token punctuation">,</span> <span class="token keyword">const</span> SNAP<span class="token operator">&amp;</span> snap<span class="token punctuation">,</span> <span class="token keyword">const</span> ROLLBACK<span class="token operator">&amp;</span> rollback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>ord<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>ord<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> ab <span class="token operator">=</span> l<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">/</span> w<span class="token punctuation">,</span> bb <span class="token operator">=</span> l<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">/</span> w<span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>ab <span class="token operator">!=</span> bb<span class="token punctuation">)</span> <span class="token keyword">return</span> ab <span class="token operator">&lt;</span> bb<span class="token punctuation">;</span>
         <span class="token keyword">return</span> r<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">&lt;</span> r<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> idx <span class="token operator">:</span> ord<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">-</span> l<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">&lt;</span> w<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> l<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">rem</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">int</span> nr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> lb <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> idx <span class="token operator">:</span> ord<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">-</span> l<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">&lt;</span> w<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
         <span class="token keyword">int</span> b <span class="token operator">=</span> l<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">/</span> w<span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>lb <span class="token operator">!=</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            lb <span class="token operator">=</span> b<span class="token punctuation">;</span>
            nr <span class="token operator">=</span> <span class="token punctuation">(</span>b <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> w<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span>nr <span class="token operator">&lt;</span> r<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">add</span><span class="token punctuation">(</span>nr<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">snap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">per</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token punctuation">(</span>b <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> w<span class="token punctuation">,</span> l<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">add</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">rem</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="mo.hpp">mo.hpp</h2>
        md5: 6ff6db

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">Mo</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>pii<span class="token operator">></span> lr<span class="token punctuation">;</span>
   <span class="token function">Mo</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> lr<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">AL</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">AR</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">EL</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">ER</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">O</span><span class="token operator">></span>
   <span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">const</span> AL<span class="token operator">&amp;</span> add_left<span class="token punctuation">,</span> <span class="token keyword">const</span> AR<span class="token operator">&amp;</span> add_right<span class="token punctuation">,</span> <span class="token keyword">const</span> EL<span class="token operator">&amp;</span> erase_left<span class="token punctuation">,</span> <span class="token keyword">const</span> ER<span class="token operator">&amp;</span> erase_right<span class="token punctuation">,</span> <span class="token keyword">const</span> O<span class="token operator">&amp;</span> out<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> q <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>lr<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> bs <span class="token operator">=</span> n <span class="token operator">/</span> <span class="token generic-function"><span class="token function">min</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">ord</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">iota</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>ord<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>ord<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> ab <span class="token operator">=</span> lr<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">/</span> bs<span class="token punctuation">,</span> bb <span class="token operator">=</span> lr<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">/</span> bs<span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>ab <span class="token operator">!=</span> bb<span class="token punctuation">)</span> <span class="token keyword">return</span> ab <span class="token operator">&lt;</span> bb<span class="token punctuation">;</span>
         <span class="token keyword">return</span> <span class="token punctuation">(</span>ab <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> lr<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">></span> lr<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">:</span> lr<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">&lt;</span> lr<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> idx <span class="token operator">:</span> ord<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">></span> lr<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">)</span> <span class="token function">add_left</span><span class="token punctuation">(</span><span class="token operator">--</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">&lt;</span> lr<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span> <span class="token function">add_right</span><span class="token punctuation">(</span>r<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> lr<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">)</span> <span class="token function">erase_left</span><span class="token punctuation">(</span>l<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">></span> lr<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span> <span class="token function">erase_right</span><span class="token punctuation">(</span><span class="token operator">--</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">out</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">A</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">E</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">O</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">const</span> A<span class="token operator">&amp;</span> add<span class="token punctuation">,</span> <span class="token keyword">const</span> E<span class="token operator">&amp;</span> erase<span class="token punctuation">,</span> <span class="token keyword">const</span> O<span class="token operator">&amp;</span> out<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">build</span><span class="token punctuation">(</span>add<span class="token punctuation">,</span> add<span class="token punctuation">,</span> erase<span class="token punctuation">,</span> erase<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="monge-incremental-rowmin.hpp">monge-incremental-rowmin.hpp</h2>
        md5: 2cff0f

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token comment">// A[N + 1][N + 1]: Monge が i > j のみ存在しているとき、i (= 0, ..., N)行目の最小値を返す</span>
<span class="token comment">// f(i, j, v) で、j 行目の最小値が求まっている v を用いて、A[i][j] にアクセス</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">F</span><span class="token operator">></span> vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">monge_rowmin</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">const</span> F<span class="token operator">&amp;</span> f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">mi</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   mi<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">amin</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">auto</span> check <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">chmin</span><span class="token punctuation">(</span>mi<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">f</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> mi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> amin<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">check</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">auto</span> solve <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;&amp;</span> self<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">-</span> l <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> mid <span class="token operator">=</span> l <span class="token operator">+</span> r <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> amin<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">,</span> amin<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">check</span><span class="token punctuation">(</span>mid<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">self</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> l<span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">check</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">self</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">solve</span><span class="token punctuation">(</span>solve<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> mi<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="monotone-minima.hpp">monotone-minima.hpp</h2>
        md5: 187a2d

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token comment">// monotone 行列の各行について、最小値を取る場所とその値を返す</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">F</span><span class="token operator">></span> vector<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> T<span class="token operator">>></span> <span class="token function">monotone_minima</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> <span class="token keyword">int</span> w<span class="token punctuation">,</span> <span class="token keyword">const</span> F<span class="token operator">&amp;</span> f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   vector<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> T<span class="token operator">>></span> <span class="token function">dp</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token function">pair</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">auto</span> rec <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;&amp;</span> rec<span class="token punctuation">,</span> <span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> d<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>u <span class="token operator">></span> d<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> mid <span class="token operator">=</span> u <span class="token operator">+</span> d <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">auto</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>idx<span class="token punctuation">,</span> mi<span class="token punctuation">]</span> <span class="token operator">=</span> dp<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">;</span>
      idx <span class="token operator">=</span> l<span class="token punctuation">,</span> mi <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>mid<span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">chmin</span><span class="token punctuation">(</span>mi<span class="token punctuation">,</span> <span class="token function">f</span><span class="token punctuation">(</span>mid<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> idx <span class="token operator">=</span> i<span class="token punctuation">;</span>
      <span class="token function">rec</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> u<span class="token punctuation">,</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> l<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rec</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> d<span class="token punctuation">,</span> idx<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">rec</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> h <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> w <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> dp<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <h2 class="section" id="math">math</h2>

    <div class="filename">
        <h2 id="ExtGCD.hpp">ExtGCD.hpp</h2>
        md5: 88cb1c

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token comment">// returns gcd(a, b) and assign x, y to integers</span>
<span class="token comment">// s.t. ax + by = gcd(a, b) and |x| + |y| is minimized</span>
ll <span class="token function">extgcd</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span> ll b<span class="token punctuation">,</span> ll<span class="token operator">&amp;</span> x<span class="token punctuation">,</span> ll<span class="token operator">&amp;</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// assert(a >= 0 &amp;&amp; b >= 0);</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> a<span class="token punctuation">;</span>
   ll d <span class="token operator">=</span> <span class="token function">extgcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
   y <span class="token operator">-=</span> a <span class="token operator">/</span> b <span class="token operator">*</span> x<span class="token punctuation">;</span>
   <span class="token keyword">return</span> d<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
ll <span class="token function">inv_mod</span><span class="token punctuation">(</span>ll x<span class="token punctuation">,</span> ll md<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   ll y<span class="token punctuation">,</span> z<span class="token punctuation">;</span>
   <span class="token function">extgcd</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> md<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span>y <span class="token operator">%</span> md <span class="token operator">+</span> md<span class="token punctuation">)</span> <span class="token operator">%</span> md<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="and-or-convolution.hpp">and-or-convolution.hpp</h2>
        md5: da6157

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token comment">// and / or convolution</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">bool</span> isOR<span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">fzt</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">bool</span> inv <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token function">__lg</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">>></span> i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> isOR<span class="token punctuation">)</span> a<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">+=</span> a<span class="token punctuation">[</span>b <span class="token operator">^</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>inv <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="binom.hpp">binom.hpp</h2>
        md5: db2821

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">constexpr</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">1e6</span> <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span>
mint fact<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> ifact<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">pre</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   fact<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span> fact<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">*</span> fact<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   ifact<span class="token punctuation">[</span>N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> fact<span class="token punctuation">[</span>N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> ifact<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ifact<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
mint <span class="token function">C</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> m <span class="token operator">or</span> m <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> fact<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">*</span> ifact<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">*</span> ifact<span class="token punctuation">[</span>n <span class="token operator">-</span> m<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="crt.hpp">crt.hpp</h2>
        md5: 0e9c10

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token comment">// (rem, mod)</span>
pll <span class="token function">crt</span><span class="token punctuation">(</span><span class="token keyword">const</span> vl<span class="token operator">&amp;</span> b<span class="token punctuation">,</span> <span class="token keyword">const</span> vl<span class="token operator">&amp;</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   ll r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> m <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ll g<span class="token punctuation">,</span> im<span class="token punctuation">,</span> x<span class="token punctuation">;</span>
      g <span class="token operator">=</span> <span class="token function">extgcd</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> im<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> r<span class="token punctuation">)</span> <span class="token operator">%</span> g<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      ll tmp <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> r<span class="token punctuation">)</span> <span class="token operator">/</span> g <span class="token operator">*</span> im <span class="token operator">%</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> g<span class="token punctuation">)</span><span class="token punctuation">;</span>
      r <span class="token operator">+=</span> m <span class="token operator">*</span> tmp<span class="token punctuation">;</span>
      m <span class="token operator">*=</span> c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> g<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>r <span class="token operator">%</span> m <span class="token operator">+</span> m<span class="token punctuation">)</span> <span class="token operator">%</span> m<span class="token punctuation">,</span> m<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="floor_sum.hpp">floor_sum.hpp</h2>
        md5: 930ca0

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token comment">// x_i=floor((a*i+b)/c), i=0,1,..n-1</span>
<span class="token comment">// a,c>0, b>=0</span>
ll <span class="token function">floor_sum</span><span class="token punctuation">(</span>ll n<span class="token punctuation">,</span> ll a<span class="token punctuation">,</span> ll b<span class="token punctuation">,</span> ll c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
   ll res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   res <span class="token operator">+=</span> n <span class="token operator">*</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>a <span class="token operator">/</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
   a <span class="token operator">%=</span> c<span class="token punctuation">;</span>
   res <span class="token operator">+=</span> n <span class="token operator">*</span> <span class="token punctuation">(</span>b <span class="token operator">/</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
   b <span class="token operator">%=</span> c<span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   ll top <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">*</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">/</span> c<span class="token punctuation">;</span>
   res <span class="token operator">+=</span> top <span class="token operator">*</span> n<span class="token punctuation">;</span>
   ll h <span class="token operator">=</span> <span class="token punctuation">(</span>b <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> c <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> c<span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>h <span class="token operator">&lt;=</span> top<span class="token punctuation">)</span> res <span class="token operator">-=</span> <span class="token function">floor_sum</span><span class="token punctuation">(</span>top <span class="token operator">-</span> h <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> c <span class="token operator">*</span> h <span class="token operator">-</span> <span class="token punctuation">(</span>b <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token operator">+</span> top <span class="token operator">-</span> h <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="lagrange-hokan.hpp">lagrange-hokan.hpp</h2>
        md5: 22b9e3

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> T <span class="token function">lagrange_polynomial</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> y<span class="token punctuation">,</span> ll t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>t <span class="token operator">&lt;=</span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> y<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
   T <span class="token function">ret</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">dp</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">pd</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> dp<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>t <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">per</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> pd<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>t <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      T tmp <span class="token operator">=</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> pd<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> ifact<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> ifact<span class="token punctuation">[</span>n <span class="token operator">-</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      ret <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">-</span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token operator">?</span> tmp <span class="token operator">:</span> <span class="token operator">-</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="matrix.hpp">matrix.hpp</h2>
        md5: 270f1c

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">M</span> <span class="token punctuation">{</span>
   vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>T<span class="token operator">>></span> a<span class="token punctuation">;</span>
   <span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">;</span>
   <span class="token function">M</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">a</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token function">M</span><span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token generic-function"><span class="token function">M</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">static</span> M <span class="token function">I</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      M <span class="token function">mat</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> mat<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   M<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> M<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   M<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">-=</span><span class="token punctuation">(</span><span class="token keyword">const</span> M<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   M<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">*=</span><span class="token punctuation">(</span><span class="token keyword">const</span> M<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> l <span class="token operator">=</span> b<span class="token punctuation">.</span>m<span class="token punctuation">;</span>
      vector <span class="token function">c</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token function">rep</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> l<span class="token punctuation">)</span> c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> b<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
      a<span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   M<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">^=</span><span class="token punctuation">(</span>ll k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      M b <span class="token operator">=</span> <span class="token class-name">M</span><span class="token double-colon punctuation">::</span><span class="token function">I</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> b <span class="token operator">*=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
         <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">*=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
         k <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      a<span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   M <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> M<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">M</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">+=</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   M <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">const</span> M<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">M</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">-=</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   M <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">const</span> M<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">M</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">*=</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   M <span class="token keyword">operator</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token keyword">const</span> M<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">M</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">^=</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> T<span class="token operator">></span> <span class="token function">GaussElimination</span><span class="token punctuation">(</span>M<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">bool</span> LE <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> a<span class="token punctuation">.</span>n<span class="token punctuation">,</span> m <span class="token operator">=</span> a<span class="token punctuation">.</span>m<span class="token punctuation">;</span>
   <span class="token keyword">int</span> rank <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> je <span class="token operator">=</span> LE <span class="token operator">?</span> m <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">:</span> m<span class="token punctuation">;</span>
   mint det <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> je<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> rank<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            idx <span class="token operator">=</span> i<span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>idx <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         det <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
         <span class="token keyword">continue</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>rank <span class="token operator">!=</span> idx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         det <span class="token operator">=</span> <span class="token operator">-</span>det<span class="token punctuation">;</span>
         <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>rank<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      det <span class="token operator">*=</span> a<span class="token punctuation">[</span>rank<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>LE <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>rank<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         mint coeff <span class="token operator">=</span> a<span class="token punctuation">[</span>rank<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> j<span class="token punctuation">,</span> m<span class="token punctuation">)</span> a<span class="token punctuation">[</span>rank<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">*=</span> coeff<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">int</span> is <span class="token operator">=</span> LE <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> rank <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> is<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> rank<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mint coeff <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>rank<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">rep</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> j<span class="token punctuation">,</span> m<span class="token punctuation">)</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>rank<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">*</span> coeff<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      rank<span class="token operator">++</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> <span class="token function">make_pair</span><span class="token punctuation">(</span>rank<span class="token punctuation">,</span> det<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>T<span class="token operator">>></span> <span class="token function">LinearEquation</span><span class="token punctuation">(</span>M<span class="token operator">&lt;</span>T<span class="token operator">></span> a<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>T<span class="token operator">></span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> a<span class="token punctuation">.</span>n<span class="token punctuation">,</span> m <span class="token operator">=</span> a<span class="token punctuation">.</span>m<span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   a<span class="token punctuation">.</span>m<span class="token operator">++</span><span class="token punctuation">;</span>
   <span class="token keyword">auto</span> p <span class="token operator">=</span> <span class="token function">GaussElimination</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> rank <span class="token operator">=</span> p<span class="token punctuation">.</span>first<span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> rank<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>T<span class="token operator">>></span> <span class="token function">res</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vi <span class="token function">piv</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> rank<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">++</span>j<span class="token punctuation">;</span>
      res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">,</span> piv<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>piv<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">x</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
         x<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>piv<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> x<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>a<span class="token punctuation">[</span>piv<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         res<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="prime.hpp">prime.hpp</h2>
        md5: 94a4a8

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">U</span><span class="token operator">></span> T <span class="token function">pow_mod</span><span class="token punctuation">(</span>T x<span class="token punctuation">,</span> U n<span class="token punctuation">,</span> T md<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   T r <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">%</span> md<span class="token punctuation">;</span>
   x <span class="token operator">%=</span> md<span class="token punctuation">;</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> r <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token operator">%</span> md<span class="token punctuation">;</span>
      x <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token operator">%</span> md<span class="token punctuation">;</span>
      n <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> r<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token function">is_prime</span><span class="token punctuation">(</span>ll n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   ll d <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span>d <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> d <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ll a <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> a<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
      ll t <span class="token operator">=</span> d<span class="token punctuation">;</span>
      ll y <span class="token operator">=</span> <span class="token generic-function"><span class="token function">pow_mod</span><span class="token generic class-name"><span class="token operator">&lt;</span>i128<span class="token operator">></span></span></span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> t<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// over</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>t <span class="token operator">!=</span> n <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">!=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">!=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         y <span class="token operator">=</span> <span class="token function">i128</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">*</span> y <span class="token operator">%</span> n<span class="token punctuation">;</span>  <span class="token comment">// flow</span>
         t <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">!=</span> n <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> t <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
ll <span class="token function">pollard_single</span><span class="token punctuation">(</span>ll n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   ll R<span class="token punctuation">;</span>
   <span class="token keyword">auto</span> f <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">i128</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> x <span class="token operator">+</span> R<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_prime</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> n<span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
   ll st <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      R <span class="token operator">=</span> <span class="token function">rnd</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      st<span class="token operator">++</span><span class="token punctuation">;</span>
      ll x <span class="token operator">=</span> st<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         ll p <span class="token operator">=</span> <span class="token function">gcd</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">-</span> x <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> p <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> p<span class="token punctuation">;</span>
         x <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
         y <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
vl <span class="token function">factor</span><span class="token punctuation">(</span>ll n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   ll x <span class="token operator">=</span> <span class="token function">pollard_single</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span>x<span class="token punctuation">}</span><span class="token punctuation">;</span>
   vl l <span class="token operator">=</span> <span class="token function">factor</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token function">factor</span><span class="token punctuation">(</span>n <span class="token operator">/</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> l<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token function">end</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">all</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> l<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="primitive-root.hpp">primitive-root.hpp</h2>
        md5: 4088f5

    </div>
    <div class="content content-hpp">
    <pre><code>ll <span class="token function">primitive_root</span><span class="token punctuation">(</span>ll p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">auto</span> v <span class="token operator">=</span> <span class="token function">factor</span><span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ll g <span class="token operator">=</span> <span class="token function">rnd</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">bool</span> ok <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> d <span class="token operator">:</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         ll f <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> d<span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">pow_mod</span><span class="token generic class-name"><span class="token operator">&lt;</span>i128<span class="token operator">></span></span></span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> f<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ok <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ok<span class="token punctuation">)</span> <span class="token keyword">return</span> g<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="xor-convolution.hpp">xor-convolution.hpp</h2>
        md5: f5168d

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">fwt</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> f<span class="token punctuation">,</span> <span class="token keyword">bool</span> inv <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span> m <span class="token operator">=</span> <span class="token function">__lg</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">~</span>b <span class="token operator">>></span> i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            T x <span class="token operator">=</span> f<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">,</span> y <span class="token operator">=</span> f<span class="token punctuation">[</span>b <span class="token operator">^</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            f<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> x <span class="token operator">+</span> y<span class="token punctuation">,</span> f<span class="token punctuation">[</span>b <span class="token operator">^</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> x <span class="token operator">-</span> y<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>inv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      T iz <span class="token operator">=</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> f<span class="token punctuation">)</span> e <span class="token operator">*=</span> iz<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <h2 class="section" id="graph">graph</h2>

    <div class="filename">
        <h2 id="bcc.hpp">bcc.hpp</h2>
        md5: 3df588

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">G</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">BCC</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">LL</span><span class="token operator">&lt;</span><span class="token class-name">G</span><span class="token operator">></span></span> <span class="token punctuation">{</span>
   vi used<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>pii<span class="token operator">>></span> bc<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>pii<span class="token operator">></span> tmp<span class="token punctuation">;</span>
   <span class="token keyword">using</span> L <span class="token operator">=</span> LL<span class="token operator">&lt;</span>G<span class="token operator">></span><span class="token punctuation">;</span>
   <span class="token keyword">using</span> L<span class="token double-colon punctuation">::</span>g<span class="token punctuation">;</span>
   <span class="token keyword">using</span> L<span class="token double-colon punctuation">::</span>low<span class="token punctuation">;</span>
   <span class="token keyword">using</span> L<span class="token double-colon punctuation">::</span>ord<span class="token punctuation">;</span>

   <span class="token function">BCC</span><span class="token punctuation">(</span>G g<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">L</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      used<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>used<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>used<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      used<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>e <span class="token operator">==</span> p<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>used<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">||</span> ord<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">&lt;</span> ord<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> tmp<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span><span class="token function">minmax</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>used<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">dfs</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">>=</span> ord<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               bc<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  <span class="token keyword">auto</span> p <span class="token operator">=</span> tmp<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  bc<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
                  tmp<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>first <span class="token operator">==</span> <span class="token function">min</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">and</span> p<span class="token punctuation">.</span>second <span class="token operator">==</span> <span class="token function">max</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="eulerian-trail.hpp">eulerian-trail.hpp</h2>
        md5: 5d421d

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">edge</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> idx<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span>edge<span class="token operator">></span> <span class="token function">eulerian_path</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>edge<span class="token operator">></span> es<span class="token punctuation">,</span> <span class="token keyword">int</span> s<span class="token punctuation">,</span> <span class="token keyword">bool</span> directed <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>es<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> es<span class="token punctuation">)</span> <span class="token function">chmax</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>x<span class="token punctuation">,</span> e<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span>edge<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">></span> <span class="token function">g</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> e <span class="token operator">:</span> es<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> p <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>e<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      g<span class="token punctuation">[</span>e<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>directed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> q <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>e<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token function">swap</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>x<span class="token punctuation">,</span> e<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
         g<span class="token punctuation">[</span>e<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   vector<span class="token operator">&lt;</span>edge<span class="token operator">></span> ord<span class="token punctuation">;</span>
   stack<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> edge<span class="token operator">>></span> st<span class="token punctuation">;</span>
   st<span class="token punctuation">.</span><span class="token function">emplace</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> edge<span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span>st<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> x <span class="token operator">=</span> st<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">empty</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         ord<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>st<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
         st<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token keyword">auto</span> e <span class="token operator">=</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>second <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>directed<span class="token punctuation">)</span> g<span class="token punctuation">[</span>e<span class="token punctuation">.</span>first<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>e<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
         st<span class="token punctuation">.</span><span class="token function">emplace</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>first<span class="token punctuation">.</span>y<span class="token punctuation">,</span> e<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   ord<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>ord<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>ord<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>ord<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token function">si</span><span class="token punctuation">(</span>es<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> ord<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="lowlink.hpp">lowlink.hpp</h2>
        md5: e3987c

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">G</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">LL</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n<span class="token punctuation">;</span>
   <span class="token keyword">const</span> G g<span class="token punctuation">;</span>
   vi ord<span class="token punctuation">,</span> low<span class="token punctuation">,</span> arti<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>pii<span class="token operator">></span> bridge<span class="token punctuation">;</span>

   <span class="token function">LL</span><span class="token punctuation">(</span>G g<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">g</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">low</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>ord<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> k <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      low<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>ord<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">bool</span> is_arti <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> second <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>ord<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cnt<span class="token operator">++</span><span class="token punctuation">;</span>
            k <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> k<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">chmin</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span> low<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            is_arti <span class="token operator">|=</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>low<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">>=</span> ord<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>ord<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">&lt;</span> low<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span> bridge<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span><span class="token function">minmax</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>e <span class="token operator">!=</span> p <span class="token operator">or</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">chmin</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span> ord<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            second <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      is_arti <span class="token operator">|=</span> p <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> cnt <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>is_arti<span class="token punctuation">)</span> arti<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> k<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="max_matching.hpp">max_matching.hpp</h2>
        md5: 2ece25

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">Matching</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>vi<span class="token operator">></span> g<span class="token punctuation">;</span>
   vi mt<span class="token punctuation">;</span>
   vi is_ev<span class="token punctuation">,</span> gr_buf<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>pii<span class="token operator">></span> nx<span class="token punctuation">;</span>
   <span class="token keyword">int</span> st<span class="token punctuation">;</span>
   <span class="token keyword">int</span> <span class="token function">group</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>gr_buf<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> is_ev<span class="token punctuation">[</span>gr_buf<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">!=</span> st<span class="token punctuation">)</span> <span class="token keyword">return</span> gr_buf<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> gr_buf<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">group</span><span class="token punctuation">(</span>gr_buf<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">match</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> d <span class="token operator">=</span> mt<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
      mt<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> mt<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">!=</span> p<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>nx<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         mt<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> nx<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">;</span>
         <span class="token function">match</span><span class="token punctuation">(</span>nx<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token function">match</span><span class="token punctuation">(</span>nx<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">,</span> nx<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">match</span><span class="token punctuation">(</span>nx<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">,</span> nx<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">bool</span> <span class="token function">arg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      is_ev<span class="token punctuation">[</span>st<span class="token punctuation">]</span> <span class="token operator">=</span> st<span class="token punctuation">;</span>
      gr_buf<span class="token punctuation">[</span>st<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      nx<span class="token punctuation">[</span>st<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">pii</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      queue<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> q<span class="token punctuation">;</span>
      q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> a <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> b <span class="token operator">:</span> g<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>b <span class="token operator">==</span> st<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>mt<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               mt<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">;</span>
               <span class="token function">match</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>is_ev<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">==</span> st<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token function">group</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token function">group</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">==</span> y<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
               <span class="token keyword">int</span> z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
               <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> y <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  <span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">if</span><span class="token punctuation">(</span>nx<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token function">pii</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                     z <span class="token operator">=</span> x<span class="token punctuation">;</span>
                     <span class="token keyword">break</span><span class="token punctuation">;</span>
                  <span class="token punctuation">}</span>
                  nx<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">pii</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
                  x <span class="token operator">=</span> <span class="token function">group</span><span class="token punctuation">(</span>nx<span class="token punctuation">[</span>mt<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
               <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> v <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token function">group</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">group</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  <span class="token keyword">while</span><span class="token punctuation">(</span>v <span class="token operator">!=</span> z<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                     q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
                     is_ev<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> st<span class="token punctuation">;</span>
                     gr_buf<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> z<span class="token punctuation">;</span>
                     v <span class="token operator">=</span> <span class="token function">group</span><span class="token punctuation">(</span>nx<span class="token punctuation">[</span>mt<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token punctuation">}</span>
               <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>is_ev<span class="token punctuation">[</span>mt<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">!=</span> st<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               is_ev<span class="token punctuation">[</span>mt<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> st<span class="token punctuation">;</span>
               nx<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">pii</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               nx<span class="token punctuation">[</span>mt<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">pii</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               gr_buf<span class="token punctuation">[</span>mt<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
               q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>mt<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token function">Matching</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>vi<span class="token operator">></span><span class="token operator">&amp;</span> _g<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">(</span>_g<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">g</span><span class="token punctuation">(</span>_g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">is_ev</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">gr_buf</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">nx</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>st <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> st <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> st<span class="token operator">++</span><span class="token punctuation">)</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>mt<span class="token punctuation">[</span>st<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">arg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   vector<span class="token operator">&lt;</span>pii<span class="token operator">></span> <span class="token function">max_match</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      vector<span class="token operator">&lt;</span>pii<span class="token operator">></span> res<span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> mt<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> mt<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="maximum-independent-set.hpp">maximum-independent-set.hpp</h2>
        md5: ac1384

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">unsigned</span> ll <span class="token function">maximum_independent_set</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vi<span class="token operator">></span> g<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">using</span> U <span class="token operator">=</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>U<span class="token operator">></span> <span class="token function">nbd</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> nbd<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">1ULL</span> <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">;</span>
   <span class="token keyword">int</span> best <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   U res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">auto</span> dfs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;&amp;</span> dfs<span class="token punctuation">,</span> U now<span class="token punctuation">,</span> U rest<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
      pii <span class="token function">p</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">bool</span> upd <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>rest <span class="token operator">>></span> v <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">int</span> d <span class="token operator">=</span> <span class="token function">popcount</span><span class="token punctuation">(</span>nbd<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">&amp;</span> rest<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">chmax</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>second<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span> p<span class="token punctuation">.</span>first <span class="token operator">=</span> v<span class="token punctuation">;</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> rest <span class="token operator">^=</span> <span class="token number">1ULL</span> <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">,</span> rest <span class="token operator">&amp;=</span> <span class="token operator">~</span>nbd<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">,</span> now <span class="token operator">|=</span> <span class="token number">1ULL</span> <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">,</span> upd <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>upd<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
         p <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token function">popcount</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token function">popcount</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">chmax</span><span class="token punctuation">(</span>best<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span> res <span class="token operator">=</span> now<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>b <span class="token operator">or</span> a <span class="token operator">+</span> b <span class="token operator">&lt;=</span> best<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> v <span class="token operator">=</span> p<span class="token punctuation">.</span>first<span class="token punctuation">;</span>
      rest <span class="token operator">&amp;=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">1ULL</span> <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>second <span class="token operator">>=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token function">dfs</span><span class="token punctuation">(</span>dfs<span class="token punctuation">,</span> now<span class="token punctuation">,</span> rest<span class="token punctuation">)</span><span class="token punctuation">;</span>
      now <span class="token operator">|=</span> <span class="token number">1ULL</span> <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">;</span>
      <span class="token function">dfs</span><span class="token punctuation">(</span>dfs<span class="token punctuation">,</span> now<span class="token punctuation">,</span> rest <span class="token operator">&amp;</span> <span class="token operator">~</span><span class="token punctuation">(</span>nbd<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   U now <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> rest <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1ULL</span> <span class="token operator">&lt;&lt;</span> n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token function">dfs</span><span class="token punctuation">(</span>dfs<span class="token punctuation">,</span> now<span class="token punctuation">,</span> rest<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="scc.hpp">scc.hpp</h2>
        md5: 73554b

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">G</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">SCC</span> <span class="token punctuation">{</span>
   G g<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>vi<span class="token operator">></span> rg<span class="token punctuation">;</span>
   vi comp<span class="token punctuation">,</span> ord<span class="token punctuation">,</span> used<span class="token punctuation">;</span>
   <span class="token keyword">int</span> num<span class="token punctuation">;</span>  <span class="token comment">// 連結成分の数</span>

   <span class="token function">SCC</span><span class="token punctuation">(</span>G g<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">g</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rg</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">comp</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">used</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> rg<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> comp<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>used<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      used<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>used<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">dfs</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      ord<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">rdfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> cnt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>comp<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      comp<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> cnt<span class="token punctuation">;</span>
      <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> rg<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>comp<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">rdfs</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> cnt<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> g<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>ord<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token function">fore</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> ord<span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>comp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">rdfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">,</span> num<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="tecc.hpp">tecc.hpp</h2>
        md5: 17c69f

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">G</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">TCC</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">LL</span><span class="token operator">&lt;</span><span class="token class-name">G</span><span class="token operator">></span></span> <span class="token punctuation">{</span>
   <span class="token keyword">using</span> L <span class="token operator">=</span> LL<span class="token operator">&lt;</span>G<span class="token operator">></span><span class="token punctuation">;</span>
   <span class="token keyword">using</span> L<span class="token double-colon punctuation">::</span>bridge<span class="token punctuation">;</span>
   <span class="token keyword">using</span> L<span class="token double-colon punctuation">::</span>g<span class="token punctuation">;</span>
   <span class="token keyword">using</span> L<span class="token double-colon punctuation">::</span>low<span class="token punctuation">;</span>
   <span class="token keyword">using</span> L<span class="token double-colon punctuation">::</span>ord<span class="token punctuation">;</span>
   vi cmp<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>vi<span class="token operator">></span> tree<span class="token punctuation">,</span> group<span class="token punctuation">;</span>
   <span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      cmp<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>cmp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>cmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
      group<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span> group<span class="token punctuation">[</span>cmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      tree<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">:</span> bridge<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         tree<span class="token punctuation">[</span>cmp<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>cmp<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         tree<span class="token punctuation">[</span>cmp<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>cmp<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token function">TCC</span><span class="token punctuation">(</span><span class="token keyword">const</span> G<span class="token operator">&amp;</span> g<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">L</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>p <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">and</span> ord<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">>=</span> low<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> cmp<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> cmp<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">else</span> cmp<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>cmp<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">dfs</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> x<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <h2 class="section" id="modint">modint</h2>

    <div class="filename">
        <h2 id="BarrettReduction.hpp">BarrettReduction.hpp</h2>
        md5: 651912

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token keyword">using</span> U <span class="token operator">=</span> <span class="token keyword">uint64_t</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Barret</span> <span class="token punctuation">{</span>
   U m<span class="token punctuation">,</span> im<span class="token punctuation">;</span>
   <span class="token function">Barret</span><span class="token punctuation">(</span>U mod<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m</span><span class="token punctuation">(</span>mod<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">im</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1ULL</span> <span class="token operator">/</span> m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   U <span class="token function">mul</span><span class="token punctuation">(</span>U a<span class="token punctuation">,</span> U b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      a <span class="token operator">*=</span> b<span class="token punctuation">;</span>
      U x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__uint128_t<span class="token punctuation">)</span>a <span class="token operator">*</span> im<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span><span class="token punctuation">;</span>
      a <span class="token operator">-=</span> x <span class="token operator">*</span> m<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ll<span class="token punctuation">)</span>a <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> a <span class="token operator">+=</span> m<span class="token punctuation">;</span>
      <span class="token keyword">return</span> a<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">constexpr</span> ll mod <span class="token operator">=</span> <span class="token number">998244353</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> Barret <span class="token function">b</span><span class="token punctuation">(</span>mod<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">mint</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> x<span class="token punctuation">;</span>
   <span class="token function">mint</span><span class="token punctuation">(</span>ll x_ <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x_ <span class="token operator">%</span> mod<span class="token punctuation">)</span> <span class="token operator">+</span> mod<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">>=</span> mod<span class="token punctuation">)</span> x <span class="token operator">-=</span> mod<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   mint<span class="token operator">&amp;</span> <span class="token function">s</span><span class="token punctuation">(</span>uint xx<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">=</span> xx <span class="token operator">&lt;</span> mod <span class="token operator">?</span> xx <span class="token operator">:</span> xx <span class="token operator">-</span> mod<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   mint <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">mint</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   mint<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> mint<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">s</span><span class="token punctuation">(</span>x <span class="token operator">+</span> r<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   mint<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">-=</span><span class="token punctuation">(</span><span class="token keyword">const</span> mint<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">s</span><span class="token punctuation">(</span>x <span class="token operator">+</span> mod <span class="token operator">-</span> r<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   mint<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">*=</span><span class="token punctuation">(</span><span class="token keyword">const</span> mint<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> r<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   mint<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">/=</span><span class="token punctuation">(</span><span class="token keyword">const</span> mint<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">*=</span> r<span class="token punctuation">.</span><span class="token function">inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">friend</span> mint <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>mint l<span class="token punctuation">,</span> mint r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> l <span class="token operator">+=</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">friend</span> mint <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span>mint l<span class="token punctuation">,</span> mint r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> l <span class="token operator">-=</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">friend</span> mint <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span>mint l<span class="token punctuation">,</span> mint r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> l <span class="token operator">*=</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">friend</span> mint <span class="token keyword">operator</span><span class="token operator">/</span><span class="token punctuation">(</span>mint l<span class="token punctuation">,</span> mint r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> l <span class="token operator">/=</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   mint <span class="token function">inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">pow</span><span class="token punctuation">(</span>mod <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   mint <span class="token function">pow</span><span class="token punctuation">(</span>ll b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      mint a <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> c <span class="token operator">*=</span> a<span class="token punctuation">;</span>
         a <span class="token operator">*=</span> a<span class="token punctuation">;</span>
         b <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> c<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> vm <span class="token operator">=</span> vector<span class="token operator">&lt;</span>mint<span class="token operator">></span><span class="token punctuation">;</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="modint.hpp">modint.hpp</h2>
        md5: 3db9f2

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">constexpr</span> <span class="token keyword">int</span> mod <span class="token operator">=</span> <span class="token number">998244353</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">mint</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> x<span class="token punctuation">;</span>
   <span class="token function">mint</span><span class="token punctuation">(</span>ll x_ <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">x</span><span class="token punctuation">(</span>x_ <span class="token operator">%</span> mod<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> x <span class="token operator">+=</span> mod<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   mint <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">auto</span> res <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">?</span> mod <span class="token operator">-</span> x <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   mint<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span>mint r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">+=</span> r<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">>=</span> mod<span class="token punctuation">)</span> x <span class="token operator">-=</span> mod<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   mint<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">-=</span><span class="token punctuation">(</span>mint r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">-=</span> r<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> x <span class="token operator">+=</span> mod<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   mint<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">*=</span><span class="token punctuation">(</span>mint r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      x <span class="token operator">=</span> <span class="token number">1LL</span> <span class="token operator">*</span> x <span class="token operator">*</span> r<span class="token punctuation">.</span>x <span class="token operator">%</span> mod<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   mint<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">/=</span><span class="token punctuation">(</span>mint r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">*=</span> r<span class="token punctuation">.</span><span class="token function">inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">friend</span> mint <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>mint a<span class="token punctuation">,</span> mint b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">+=</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">friend</span> mint <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span>mint a<span class="token punctuation">,</span> mint b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">-=</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">friend</span> mint <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span>mint a<span class="token punctuation">,</span> mint b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">*=</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">friend</span> mint <span class="token keyword">operator</span><span class="token operator">/</span><span class="token punctuation">(</span>mint a<span class="token punctuation">,</span> mint b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">/=</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   mint <span class="token function">inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">pow</span><span class="token punctuation">(</span>mod <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   mint <span class="token function">pow</span><span class="token punctuation">(</span>ll b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      mint a <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> c <span class="token operator">*=</span> a<span class="token punctuation">;</span>
         a <span class="token operator">*=</span> a<span class="token punctuation">;</span>
         b <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> c<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> vm <span class="token operator">=</span> vector<span class="token operator">&lt;</span>mint<span class="token operator">></span><span class="token punctuation">;</span></code></pre>
</div>

    <h2 class="section" id="FPS">FPS</h2>

    <div class="filename">
        <h2 id="FFT.hpp">FFT.hpp</h2>
        md5: f769b5

    </div>
    <div class="content content-hpp">
    <pre><code>mint g <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>  <span class="token comment">// 原始根</span>
<span class="token keyword">void</span> <span class="token function">fft</span><span class="token punctuation">(</span>vm<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">bool</span> inv <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> s <span class="token operator">=</span> <span class="token function">__lg</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">static</span> vm z<span class="token punctuation">,</span> iz<span class="token punctuation">;</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      z<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token function">mint</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token function">si</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      iz<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   vm <span class="token function">b</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> w <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> s <span class="token operator">-</span> i<span class="token punctuation">;</span>
      mint base <span class="token operator">=</span> inv <span class="token operator">?</span> iz<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">:</span> z<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> now <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> n <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> y <span class="token operator">+=</span> w<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">auto</span> l <span class="token operator">=</span> a<span class="token punctuation">[</span>y <span class="token operator">&lt;&lt;</span> <span class="token number">1</span> <span class="token operator">|</span> x<span class="token punctuation">]</span><span class="token punctuation">,</span> r <span class="token operator">=</span> now <span class="token operator">*</span> a<span class="token punctuation">[</span>y <span class="token operator">&lt;&lt;</span> <span class="token number">1</span> <span class="token operator">|</span> x <span class="token operator">|</span> w<span class="token punctuation">]</span><span class="token punctuation">;</span>
            b<span class="token punctuation">[</span>y <span class="token operator">|</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> l <span class="token operator">+</span> r<span class="token punctuation">,</span> b<span class="token punctuation">[</span>y <span class="token operator">|</span> x <span class="token operator">|</span> n <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> l <span class="token operator">-</span> r<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         now <span class="token operator">*=</span> base<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

vm <span class="token function">mul</span><span class="token punctuation">(</span>vm a<span class="token punctuation">,</span> vm b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> m <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>n <span class="token operator">or</span> <span class="token operator">!</span>m<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      vm <span class="token function">ans</span><span class="token punctuation">(</span>n <span class="token operator">+</span> m <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> m<span class="token punctuation">)</span> ans<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">+=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> b<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">int</span> N <span class="token operator">=</span> n <span class="token operator">+</span> m <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> z <span class="token operator">=</span> <span class="token function">bit_ceil</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   a<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">fft</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fft</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> z<span class="token punctuation">)</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*=</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token function">fft</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   a<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>n <span class="token operator">+</span> m <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   mint iz <span class="token operator">=</span> <span class="token function">mint</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> a<span class="token punctuation">)</span> e <span class="token operator">*=</span> iz<span class="token punctuation">;</span>
   <span class="token keyword">return</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="linear-recurrence.hpp">linear-recurrence.hpp</h2>
        md5: 7ef16a

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token comment">// [x ^ k] p / q</span>
mint <span class="token function">LinearRecurrence</span><span class="token punctuation">(</span>ll k<span class="token punctuation">,</span> fps q<span class="token punctuation">,</span> fps p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   q<span class="token punctuation">.</span><span class="token function">shrink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   mint ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token function">si</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">auto</span> r <span class="token operator">=</span> p <span class="token operator">/</span> q<span class="token punctuation">;</span>
      p <span class="token operator">-=</span> r <span class="token operator">*</span> q<span class="token punctuation">;</span>
      p<span class="token punctuation">.</span><span class="token function">shrink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&lt;</span> r<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> ret <span class="token operator">+=</span> r<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
   p<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">auto</span> q2 <span class="token operator">=</span> q<span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> q2<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> q2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>q2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">auto</span> s <span class="token operator">=</span> p <span class="token operator">*</span> q2<span class="token punctuation">,</span> t <span class="token operator">=</span> q <span class="token operator">*</span> q2<span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>k <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> p<span class="token punctuation">[</span>i <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> t<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span>i <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      k <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> ret <span class="token operator">+</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// a * q = 0</span>
mint <span class="token function">kitamasa</span><span class="token punctuation">(</span>ll n<span class="token punctuation">,</span> fps q<span class="token punctuation">,</span> fps a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token function">si</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword">auto</span> p <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> q<span class="token punctuation">;</span>
   p<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token function">LinearRecurrence</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> q<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="poly.hpp">poly.hpp</h2>
        md5: 8da6ee

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">fps</span> <span class="token punctuation">{</span>
   vm v<span class="token punctuation">;</span>
   <span class="token function">fps</span><span class="token punctuation">(</span><span class="token keyword">const</span> vm<span class="token operator">&amp;</span> v <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">v</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token function">fps</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">v</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">shrink</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>v<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> v<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span> v<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">int</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   mint <span class="token function">freq</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>p <span class="token operator">&lt;</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   mint<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> v<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">emplace_back</span><span class="token punctuation">(</span>mint x<span class="token punctuation">)</span> <span class="token punctuation">{</span> v<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps <span class="token function">pre</span><span class="token punctuation">(</span><span class="token keyword">int</span> le<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> le<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      vm res<span class="token punctuation">{</span>v<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> res<span class="token punctuation">)</span> e <span class="token operator">=</span> <span class="token operator">-</span>e<span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> fps<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      <span class="token keyword">auto</span> n <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      vm <span class="token function">res</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">freq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> r<span class="token punctuation">.</span><span class="token function">freq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">const</span> fps<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">const</span> fps<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token function">mul</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> r<span class="token punctuation">.</span>v<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">const</span> mint<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      vm <span class="token function">res</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> r<span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token keyword">operator</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">const</span> mint<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">*</span> r<span class="token punctuation">.</span><span class="token function">inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps <span class="token keyword">operator</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">const</span> fps<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> r<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> r<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">*</span> r<span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inv</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token keyword">operator</span><span class="token operator">%</span><span class="token punctuation">(</span><span class="token keyword">const</span> fps<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">-</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">/</span> r <span class="token operator">*</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      vm <span class="token function">res</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> res<span class="token punctuation">[</span>i <span class="token operator">+</span> s<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> s<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">fps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      vm <span class="token function">res</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> s<span class="token punctuation">)</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>i <span class="token operator">+</span> s<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> fps<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">+</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">-=</span><span class="token punctuation">(</span><span class="token keyword">const</span> fps<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">-</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">*=</span><span class="token punctuation">(</span><span class="token keyword">const</span> fps<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">*</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">*=</span><span class="token punctuation">(</span><span class="token keyword">const</span> mint<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">*</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">/=</span><span class="token punctuation">(</span><span class="token keyword">const</span> fps<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">/</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">/=</span><span class="token punctuation">(</span><span class="token keyword">const</span> mint<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">/</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">%=</span><span class="token punctuation">(</span><span class="token keyword">const</span> fps<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">%</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;=</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;&lt;</span> n<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>>=</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">>></span> n<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   fps <span class="token function">rev</span><span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      vm res <span class="token operator">=</span> v<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">reverse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token function">diff</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      vm <span class="token function">res</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> res<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">freq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">*</span> i<span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token function">integ</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      vm <span class="token function">res</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> res<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">freq</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token comment">// f * f.inv() = 1 + g(x)x^m</span>
   fps <span class="token function">inv</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      fps res <span class="token operator">=</span> <span class="token function">fps</span><span class="token punctuation">(</span>vm<span class="token punctuation">{</span><span class="token function">mint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">freq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> res <span class="token operator">=</span> <span class="token punctuation">(</span>res <span class="token operator">*</span> <span class="token function">mint</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> res <span class="token operator">*</span> res <span class="token operator">*</span> <span class="token function">pre</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token function">exp</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">freq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      fps g <span class="token operator">=</span> <span class="token function">fps</span><span class="token punctuation">(</span>vm<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> g <span class="token operator">=</span> <span class="token punctuation">(</span>g <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token function">pre</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fps</span><span class="token punctuation">(</span>vm<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">-</span> g<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token keyword">return</span> g<span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">freq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">auto</span> f <span class="token operator">=</span> <span class="token function">pre</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">diff</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> f<span class="token punctuation">.</span><span class="token function">inv</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">integ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
      <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">freq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      fps f <span class="token operator">=</span> <span class="token function">pre</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      fps <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> g <span class="token operator">=</span> <span class="token punctuation">(</span>g <span class="token operator">+</span> f<span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> i<span class="token punctuation">)</span> <span class="token operator">*</span> g<span class="token punctuation">.</span><span class="token function">inv</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">mint</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token keyword">return</span> g<span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token function">pow</span><span class="token punctuation">(</span>ll k<span class="token punctuation">,</span> ll n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         fps <span class="token function">res</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
         res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span> res<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mint rev <span class="token operator">=</span> <span class="token function">mint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            fps ret <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">*</span> rev<span class="token punctuation">)</span> <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">mint</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exp</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
            ret <span class="token operator">*=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
            ret <span class="token operator">=</span> <span class="token punctuation">(</span>ret <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> ret<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">i128</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> k <span class="token operator">>=</span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">fps</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token function">fps</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   fps <span class="token function">pow_mod</span><span class="token punctuation">(</span>ll n<span class="token punctuation">,</span> <span class="token keyword">const</span> fps<span class="token operator">&amp;</span> mod<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      fps x <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> r <span class="token operator">=</span> r <span class="token operator">*</span> x <span class="token operator">%</span> mod<span class="token punctuation">;</span>
         x <span class="token operator">=</span> x <span class="token operator">*</span> x <span class="token operator">%</span> mod<span class="token punctuation">;</span>
         n <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> r<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="relaxed-convolution.hpp">relaxed-convolution.hpp</h2>
        md5: f1c765

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">relaxed_multiplication</span> <span class="token punctuation">{</span>
   vector<span class="token operator">&lt;</span>mint<span class="token operator">></span> f<span class="token punctuation">,</span> g<span class="token punctuation">,</span> h<span class="token punctuation">;</span>

   <span class="token comment">// fg_prefix_ntts[d] = (NTTs of first 2^d terms of f and g)</span>
   vector<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>mint<span class="token operator">></span><span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>mint<span class="token operator">>></span><span class="token operator">></span> fg_prefix_ntts<span class="token punctuation">;</span>

   <span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> <span class="token function">get_fg_prefix_ntt</span><span class="token punctuation">(</span><span class="token keyword">int</span> d<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">(</span>fg_prefix_ntts<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> d<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> fftlen <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> fg_prefix_ntts<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         vector<span class="token operator">&lt;</span>mint<span class="token operator">></span> <span class="token function">vf</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> fftlen<span class="token punctuation">)</span><span class="token punctuation">;</span>
         vector<span class="token operator">&lt;</span>mint<span class="token operator">></span> <span class="token function">vg</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> g<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> fftlen<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">ntt</span><span class="token punctuation">(</span>vf<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ntt</span><span class="token punctuation">(</span>vg<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         fg_prefix_ntts<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>vf<span class="token punctuation">,</span> vg<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> fg_prefix_ntts<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token function">relaxed_multiplication</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

   mint <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">const</span> mint<span class="token operator">&amp;</span> f_i<span class="token punctuation">,</span> <span class="token keyword">const</span> mint<span class="token operator">&amp;</span> g_i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      f<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>f_i<span class="token punctuation">)</span><span class="token punctuation">,</span> g<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>g_i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token keyword">int</span> n <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> d <span class="token operator">=</span> <span class="token function">__builtin_ctz</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> D <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">;</span>

      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">int</span> gsz <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">+</span> D<span class="token punctuation">;</span> h<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> gsz<span class="token punctuation">)</span> h<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>gsz<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> D<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">// Convolve f[0, D) * g[0, D) -> h[D - 1, D * 2 - 1)</span>

         <span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>nttf<span class="token punctuation">,</span> nttg<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">get_fg_prefix_ntt</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
         vector<span class="token operator">&lt;</span>mint<span class="token operator">></span> <span class="token function">tmp</span><span class="token punctuation">(</span>nttf<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nttf<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nttf<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> nttg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token function">ntt</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> h<span class="token punctuation">[</span>n <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">+=</span> tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> h<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 回り込みを削除</span>
         h<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> tmp<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token comment">// Convolve f[0, 2 * D) * g[n - D, n) -> h[n - 1, n - 1 + D)</span>

         <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// Bruteforce threshold</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n <span class="token operator">-</span> D<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">+</span> D<span class="token punctuation">;</span> <span class="token operator">++</span>k<span class="token punctuation">)</span> <span class="token punctuation">{</span> h<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+=</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> g<span class="token punctuation">[</span>k <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">+</span> f<span class="token punctuation">[</span>k <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">*</span> g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            vector<span class="token operator">&lt;</span>mint<span class="token operator">></span> tmpf<span class="token punctuation">{</span>f<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> D<span class="token punctuation">,</span> f<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> tmpg<span class="token punctuation">{</span>g<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> D<span class="token punctuation">,</span> g<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            tmpf<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>D <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tmpg<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>D <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">ntt</span><span class="token punctuation">(</span>tmpf<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ntt</span><span class="token punctuation">(</span>tmpg<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>nttf<span class="token punctuation">,</span> nttg<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">get_fg_prefix_ntt</span><span class="token punctuation">(</span>d <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tmpf<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span> tmpf<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmpf<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> nttg<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> tmpg<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> nttf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token function">ntt</span><span class="token punctuation">(</span>tmpf<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> D<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> h<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">+=</span> tmpf<span class="token punctuation">[</span>D <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> h<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <h2 class="section" id="tree">tree</h2>

    <div class="filename">
        <h2 id="block-cut-tree.hpp">block-cut-tree.hpp</h2>
        md5: bf0113

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">extended_block_cut_tree</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> N<span class="token punctuation">,</span> cnt<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span> G<span class="token punctuation">;</span>
   <span class="token function">extended_block_cut_tree</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> E<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      N <span class="token operator">=</span> E<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">next</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">d</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">imos</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token function">dfs1</span><span class="token punctuation">(</span>E<span class="token punctuation">,</span> next<span class="token punctuation">,</span> d<span class="token punctuation">,</span> imos<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      G<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>N <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">></span> <span class="token function">used</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">dfs2</span><span class="token punctuation">(</span>E<span class="token punctuation">,</span> d<span class="token punctuation">,</span> imos<span class="token punctuation">,</span> used<span class="token punctuation">,</span> cnt<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>E<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>N <span class="token operator">+</span> cnt<span class="token punctuation">)</span><span class="token punctuation">;</span>
            G<span class="token punctuation">[</span>N <span class="token operator">+</span> cnt<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            cnt<span class="token operator">++</span><span class="token punctuation">;</span>
            G<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      G<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">dfs1</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> E<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> next<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> d<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> imos<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> w <span class="token operator">:</span> E<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>w<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            d<span class="token punctuation">[</span>w<span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            next<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">;</span>
            <span class="token function">dfs1</span><span class="token punctuation">(</span>E<span class="token punctuation">,</span> next<span class="token punctuation">,</span> d<span class="token punctuation">,</span> imos<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
            imos<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">+=</span> imos<span class="token punctuation">[</span>w<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>w<span class="token punctuation">]</span> <span class="token operator">&lt;</span> d<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            imos<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
            imos<span class="token punctuation">[</span>next<span class="token punctuation">[</span>w<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">--</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">dfs2</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> E<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> d<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> imos<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">></span><span class="token operator">&amp;</span> used<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      used<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">bool</span> ok <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> w <span class="token operator">:</span> E<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>w<span class="token punctuation">]</span> <span class="token operator">==</span> d<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>used<span class="token punctuation">[</span>w<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>imos<span class="token punctuation">[</span>w<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  ok <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                  G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>N <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
                  G<span class="token punctuation">[</span>N <span class="token operator">+</span> b<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
               <span class="token function">dfs2</span><span class="token punctuation">(</span>E<span class="token punctuation">,</span> d<span class="token punctuation">,</span> imos<span class="token punctuation">,</span> used<span class="token punctuation">,</span> b<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
               G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>N <span class="token operator">+</span> cnt<span class="token punctuation">)</span><span class="token punctuation">;</span>
               G<span class="token punctuation">[</span>N <span class="token operator">+</span> cnt<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
               cnt<span class="token operator">++</span><span class="token punctuation">;</span>
               G<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token function">dfs2</span><span class="token punctuation">(</span>E<span class="token punctuation">,</span> d<span class="token punctuation">,</span> imos<span class="token punctuation">,</span> used<span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ok <span class="token operator">&amp;&amp;</span> d<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>N <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
         G<span class="token punctuation">[</span>N <span class="token operator">+</span> b<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> G<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="hld.hpp">hld.hpp</h2>
        md5: fa40a1

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">G</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">HLD</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n<span class="token punctuation">;</span>
   G<span class="token operator">&amp;</span> g<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> sub<span class="token punctuation">,</span> in<span class="token punctuation">,</span> out<span class="token punctuation">,</span> head<span class="token punctuation">,</span> rev<span class="token punctuation">,</span> par<span class="token punctuation">,</span> d<span class="token punctuation">;</span>
   <span class="token function">HLD</span><span class="token punctuation">(</span>G<span class="token operator">&amp;</span> g<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">g</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sub</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">in</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">out</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">head</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rev</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">par</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">d</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">dfs1</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      par<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">;</span>
      sub<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">and</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> p<span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>e <span class="token operator">==</span> p<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
         d<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token function">dfs1</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
         sub<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+=</span> sub<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>sub<span class="token punctuation">[</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> sub<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">dfs2</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      in<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token operator">++</span><span class="token punctuation">;</span>
      rev<span class="token punctuation">[</span>in<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
      <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>e <span class="token operator">==</span> p<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
         head<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> e <span class="token operator">?</span> head<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">:</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">dfs2</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> x<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      out<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      head<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token function">dfs1</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">dfs2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">la</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> u <span class="token operator">=</span> head<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">-</span> k <span class="token operator">>=</span> in<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> rev<span class="token punctuation">[</span>in<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">-</span> k<span class="token punctuation">]</span><span class="token punctuation">;</span>
         k <span class="token operator">-=</span> in<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">-</span> in<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
         v <span class="token operator">=</span> par<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">lca</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span> v <span class="token operator">=</span> par<span class="token punctuation">[</span>head<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">></span> in<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>head<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">==</span> head<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> u<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">Q</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">F</span><span class="token operator">></span>
   T <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> e<span class="token punctuation">,</span> <span class="token keyword">const</span> Q<span class="token operator">&amp;</span> q<span class="token punctuation">,</span> <span class="token keyword">const</span> F<span class="token operator">&amp;</span> f<span class="token punctuation">,</span> <span class="token keyword">bool</span> edge <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      T l <span class="token operator">=</span> e<span class="token punctuation">,</span> r <span class="token operator">=</span> e<span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span> v <span class="token operator">=</span> par<span class="token punctuation">[</span>head<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">></span> in<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">swap</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>head<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">==</span> head<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
         l <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">q</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>head<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token function">q</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> edge<span class="token punctuation">,</span> in<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">dist</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> d<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> d<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> d<span class="token punctuation">[</span><span class="token function">lca</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">jump</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>i<span class="token punctuation">)</span> <span class="token keyword">return</span> s<span class="token punctuation">;</span>
      <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token function">lca</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> dst <span class="token operator">=</span> d<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">+</span> d<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">-</span> d<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>dst <span class="token operator">&lt;</span> i<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">-</span> d<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">>=</span> i<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">la</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      i <span class="token operator">-=</span> d<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">-</span> d<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">la</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> d<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">-</span> d<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <h2 class="section" id="flow">flow</h2>

    <div class="filename">
        <h2 id="bipartite-matching.hpp">bipartite-matching.hpp</h2>
        md5: 2ffb05

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">Bimatch</span> <span class="token punctuation">{</span>
   vector<span class="token operator">&lt;</span>vi<span class="token operator">></span> g<span class="token punctuation">;</span>
   vi d<span class="token punctuation">,</span> mc<span class="token punctuation">,</span> used<span class="token punctuation">,</span> vv<span class="token punctuation">;</span>
   <span class="token function">Bimatch</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">g</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mc</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">used</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> g<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">bfs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      d<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      queue<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> q<span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>used<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            q<span class="token punctuation">.</span><span class="token function">emplace</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> x <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> c <span class="token operator">=</span> mc<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>c <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">and</span> d<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               d<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
               q<span class="token punctuation">.</span><span class="token function">emplace</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">bool</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      vv<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> c <span class="token operator">=</span> mc<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>c <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token function">or</span> <span class="token punctuation">(</span><span class="token operator">!</span>vv<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">and</span> d<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">==</span> d<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">and</span> <span class="token function">dfs</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mc<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
            used<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">match</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">bfs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         vv<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">int</span> f <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>used<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">and</span> <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> f<span class="token operator">++</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>f<span class="token punctuation">)</span> <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
         ret <span class="token operator">+=</span> f<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="flow.hpp">flow.hpp</h2>
        md5: e99393

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">Dinic</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> T INF<span class="token punctuation">;</span>

   <span class="token keyword">struct</span> <span class="token class-name">edge</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> to<span class="token punctuation">;</span>
      T cap<span class="token punctuation">;</span>
      <span class="token keyword">int</span> rev<span class="token punctuation">;</span>
      <span class="token keyword">bool</span> isrev<span class="token punctuation">;</span>
      <span class="token keyword">int</span> idx<span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>

   vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>edge<span class="token operator">>></span> g<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> c<span class="token punctuation">,</span> iter<span class="token punctuation">;</span>
   <span class="token function">Dinic</span><span class="token punctuation">(</span><span class="token keyword">int</span> V<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">INF</span><span class="token punctuation">(</span><span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">g</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">add_edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span> <span class="token keyword">int</span> to<span class="token punctuation">,</span> T cap<span class="token punctuation">,</span> <span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      g<span class="token punctuation">[</span>from<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span><span class="token punctuation">(</span>edge<span class="token punctuation">)</span><span class="token punctuation">{</span>to<span class="token punctuation">,</span> cap<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> idx<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      g<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span><span class="token punctuation">(</span>edge<span class="token punctuation">)</span><span class="token punctuation">{</span>from<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>from<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> idx<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">bool</span> <span class="token function">bfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      c<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      queue<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> q<span class="token punctuation">;</span>
      c<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> c<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> x <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">fore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cap <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> c<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               c<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
               q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>to<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> c<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   T <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> t<span class="token punctuation">,</span> T flow<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">==</span> t<span class="token punctuation">)</span> <span class="token keyword">return</span> flow<span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> i <span class="token operator">=</span> iter<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cap <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> c<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">&lt;</span> c<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            T d <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>to<span class="token punctuation">,</span> t<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>flow<span class="token punctuation">,</span> e<span class="token punctuation">.</span>cap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               e<span class="token punctuation">.</span>cap <span class="token operator">-=</span> d<span class="token punctuation">;</span>
               g<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">[</span>e<span class="token punctuation">.</span>rev<span class="token punctuation">]</span><span class="token punctuation">.</span>cap <span class="token operator">+=</span> d<span class="token punctuation">;</span>
               <span class="token keyword">return</span> d<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   T <span class="token function">max_flow</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      T flow <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">bfs</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         iter<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         T f <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>f <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">,</span> INF<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> flow <span class="token operator">+=</span> f<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> flow<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token comment">// void output() {</span>
   <span class="token comment">//     for(int i = 0; i &lt; g.size(); i++) {</span>
   <span class="token comment">//         for(auto &amp;e : g[i]) {</span>
   <span class="token comment">//             if(e.isrev) continue;</span>
   <span class="token comment">//             auto &amp;rev_e = g[e.to][e.rev];</span>
   <span class="token comment">//             cout &lt;&lt; i &lt;&lt; "->" &lt;&lt; e.to &lt;&lt; " (flow: " &lt;&lt; rev_e.cap &lt;&lt; "/" &lt;&lt; e.cap + rev_e.cap &lt;&lt; ")" &lt;&lt; endl;</span>
   <span class="token comment">//         }</span>
   <span class="token comment">//     }</span>
   <span class="token comment">// }</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="lower-upper-bound-flow.hpp">lower-upper-bound-flow.hpp</h2>
        md5: 278a5a

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">lrFlow</span> <span class="token punctuation">{</span>
   Dinic<span class="token operator">&lt;</span>T<span class="token operator">></span> flow<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>T<span class="token operator">></span> in<span class="token punctuation">,</span> up<span class="token punctuation">;</span>
   <span class="token keyword">int</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> n<span class="token punctuation">;</span>
   T sum<span class="token punctuation">;</span>
   <span class="token keyword">typename</span> <span class="token class-name">Dinic</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span>edge <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token operator">*</span>q<span class="token punctuation">;</span>

   <span class="token function">lrFlow</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Y</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">in</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">flow</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">add_edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span> <span class="token keyword">int</span> to<span class="token punctuation">,</span> T low<span class="token punctuation">,</span> T high<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      flow<span class="token punctuation">.</span><span class="token function">add_edge</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> to<span class="token punctuation">,</span> high <span class="token operator">-</span> low<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>up<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      in<span class="token punctuation">[</span>from<span class="token punctuation">]</span> <span class="token operator">-=</span> low<span class="token punctuation">,</span> in<span class="token punctuation">[</span>to<span class="token punctuation">]</span> <span class="token operator">+=</span> low<span class="token punctuation">;</span>
      up<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>high<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            flow<span class="token punctuation">.</span><span class="token function">add_edge</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> i<span class="token punctuation">,</span> in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sum <span class="token operator">+=</span> in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            flow<span class="token punctuation">.</span><span class="token function">add_edge</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> <span class="token operator">-</span>in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">bool</span> <span class="token function">can_flow</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      flow<span class="token punctuation">.</span><span class="token function">add_edge</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> s<span class="token punctuation">,</span> flow<span class="token punctuation">.</span>INF<span class="token punctuation">)</span><span class="token punctuation">;</span>
      p <span class="token operator">=</span> <span class="token operator">&amp;</span>flow<span class="token punctuation">.</span>g<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      q <span class="token operator">=</span> <span class="token operator">&amp;</span>flow<span class="token punctuation">.</span>g<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">can_flow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">bool</span> <span class="token function">can_flow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">auto</span> ret <span class="token operator">=</span> flow<span class="token punctuation">.</span><span class="token function">max_flow</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> ret <span class="token operator">>=</span> sum<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   T <span class="token function">max_flow</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">can_flow</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> flow<span class="token punctuation">.</span><span class="token function">max_flow</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   T <span class="token function">min_flow</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">can_flow</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">auto</span> ret <span class="token operator">=</span> flow<span class="token punctuation">.</span>INF <span class="token operator">-</span> p<span class="token operator">-></span>cap<span class="token punctuation">;</span>
         p<span class="token operator">-></span>cap <span class="token operator">=</span> q<span class="token operator">-></span>cap <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span> ret <span class="token operator">-</span> flow<span class="token punctuation">.</span><span class="token function">max_flow</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token comment">// void output(int M) {</span>
   <span class="token comment">//     vector&lt;flow_t> ans(M);</span>
   <span class="token comment">//     for(int i = 0; i &lt; flow.graph.size(); i++) {</span>
   <span class="token comment">//         for(auto &amp;e : flow.graph[i]) {</span>
   <span class="token comment">//             if(!e.isrev &amp;&amp; ~e.idx) ans[e.idx] = up[e.idx] - e.cap;</span>
   <span class="token comment">//         }</span>
   <span class="token comment">//     }</span>
   <span class="token comment">//     for(auto &amp;p : ans) cout &lt;&lt; p &lt;&lt; endl;</span>
   <span class="token comment">// }</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="mcf.hpp">mcf.hpp</h2>
        md5: 96eeaa

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token keyword">struct</span> <span class="token class-name">MCF</span> <span class="token punctuation">{</span>
   <span class="token keyword">struct</span> <span class="token class-name">edge</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> to<span class="token punctuation">;</span>
      ll cap<span class="token punctuation">,</span> cost<span class="token punctuation">;</span>
      <span class="token keyword">int</span> rev<span class="token punctuation">;</span>
      <span class="token keyword">bool</span> isrev<span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>edge<span class="token operator">>></span> g<span class="token punctuation">;</span>
   vl pot<span class="token punctuation">,</span> cost<span class="token punctuation">;</span>
   vi pv<span class="token punctuation">,</span> pe<span class="token punctuation">;</span>
   <span class="token function">MCF</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">g</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">,</span> ll cap<span class="token punctuation">,</span> ll cost<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      g<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> cap<span class="token punctuation">,</span> cost<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      g<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>cost<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   ll <span class="token function">mcf</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> t<span class="token punctuation">,</span> ll f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">;</span>
      ll ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">using</span> P <span class="token operator">=</span> pair<span class="token operator">&lt;</span>ll<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">;</span>
      priority_queue<span class="token operator">&lt;</span>P<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>P<span class="token operator">></span><span class="token punctuation">,</span> greater<span class="token operator">&lt;</span>P<span class="token operator">>></span> pq<span class="token punctuation">;</span>
      pot<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pe<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pv<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         cost<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> INFL<span class="token punctuation">)</span><span class="token punctuation">;</span>
         pq<span class="token punctuation">.</span><span class="token function">emplace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
         cost<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
         <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>pq<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">auto</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> pq<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pq<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>cost<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">&lt;</span> c<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
               ll ncost <span class="token operator">=</span> cost<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>cost <span class="token operator">+</span> pot<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">-</span> pot<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cap <span class="token operator">and</span> <span class="token function">chmin</span><span class="token punctuation">(</span>cost<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">,</span> ncost<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  pv<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">,</span> pe<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
                  pq<span class="token punctuation">.</span><span class="token function">emplace</span><span class="token punctuation">(</span>cost<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>to<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>cost<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">==</span> INFL<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> pot<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> cost<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         ll addflow <span class="token operator">=</span> f<span class="token punctuation">;</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> v <span class="token operator">=</span> t<span class="token punctuation">;</span> v <span class="token operator">!=</span> s<span class="token punctuation">;</span> v <span class="token operator">=</span> pv<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">chmin</span><span class="token punctuation">(</span>addflow<span class="token punctuation">,</span> g<span class="token punctuation">[</span>pv<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pe<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cap<span class="token punctuation">)</span><span class="token punctuation">;</span>
         f <span class="token operator">-=</span> addflow<span class="token punctuation">;</span>
         ret <span class="token operator">+=</span> addflow <span class="token operator">*</span> pot<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> v <span class="token operator">=</span> t<span class="token punctuation">;</span> v <span class="token operator">!=</span> s<span class="token punctuation">;</span> v <span class="token operator">=</span> pv<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">auto</span><span class="token operator">&amp;</span> e <span class="token operator">=</span> g<span class="token punctuation">[</span>pv<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pe<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span>cap <span class="token operator">-=</span> addflow<span class="token punctuation">;</span>
            g<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>e<span class="token punctuation">.</span>rev<span class="token punctuation">]</span><span class="token punctuation">.</span>cap <span class="token operator">+=</span> addflow<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="二部グラフ.md">二部グラフ.md</h2>
    </div>
    <div class="content content-md"><p>| | サイズ | 構成|
|最大マッチング| $|M|$ | |
|最小点被覆| $|M|$ | L到達不可能 + R到達可能|
|最大安定集合| $|V| - |M|$ | 上の補グラフ|
|最小辺被覆| 孤立点がないなら $|V| - |M|$ | 最大マッチング + 含まれない点 greedy|</p>
</div>

    <div class="filename">
        <h2 id="燃やす埋める.md">燃やす埋める.md</h2>
    </div>
    <div class="content content-md"><table>
<thead>
<tr>
<th>変形前の制約</th>
<th>変形後の制約</th>
</tr>
</thead>
<tbody><tr>
<td>$x$ が $0$ のとき $z$ 失う</td>
<td>$(x, T, z)$</td>
</tr>
<tr>
<td>$x$ が $0$ のとき $z$ 得る</td>
<td>無条件で $z$ 得る; $(S, x, z)$</td>
</tr>
<tr>
<td>$x$ が $1$ のとき $z$ 失う</td>
<td>$(S, x, z)$</td>
</tr>
<tr>
<td>$x$ が $1$ のとき $z$ 得る</td>
<td>無条件で $z$ 得る; $(x, T, z)$</td>
</tr>
<tr>
<td>$x, y, \dots$ がすべて $0$ のとき $z$ 得る</td>
<td>無条件で $z$ 得る; $(S, w, z), (w, x, \infty), (w, y, \infty)$</td>
</tr>
<tr>
<td>$x, y, \dots$ がすべて $1$ のとき $z$ 得る</td>
<td>無条件で $z$ 得る; $(w, T, z), (x, w, \infty), (y, w, \infty)$</td>
</tr>
</tbody></table>
</div>

    <h2 class="section" id="string">string</h2>

    <div class="filename">
        <h2 id="KMP.hpp">KMP.hpp</h2>
        md5: 886c63

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token comment">// kmp[i] := max{ l ≤ i | s[:l] == s[(i+1)-l:i+1] }</span>
<span class="token comment">// abacaba -> 0010123</span>
<span class="token keyword">auto</span> <span class="token function">KMP</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   vector<span class="token operator">&lt;</span>ll<span class="token operator">></span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token function">sz</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">sz</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ll g <span class="token operator">=</span> p<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>g <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> s<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">)</span> g <span class="token operator">=</span> p<span class="token punctuation">[</span>g <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> g <span class="token operator">+</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="Manacher.hpp">Manacher.hpp</h2>
        md5: 5882fb

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token comment">// 各位置での回文半径を求める</span>
<span class="token comment">// aaabaaa -> 1214121</span>
<span class="token comment">// 偶数長の回文を含めて直径を知るには，N+1 個の $ を挿入して 1 を引く</span>
<span class="token comment">// $a$a$a$b$a$a$a$ -> 123432181234321</span>
<span class="token keyword">auto</span> <span class="token function">manacher</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   ll n <span class="token operator">=</span> <span class="token function">sz</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>ll<span class="token operator">></span> <span class="token function">r</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">>=</span> j <span class="token operator">&amp;&amp;</span> i <span class="token operator">+</span> j <span class="token operator">&lt;</span> n <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">[</span>i <span class="token operator">-</span> j<span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span> j<span class="token operator">++</span><span class="token punctuation">;</span>
      r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>
      ll k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">>=</span> k <span class="token operator">&amp;&amp;</span> i <span class="token operator">+</span> k <span class="token operator">&lt;</span> n <span class="token operator">&amp;&amp;</span> k <span class="token operator">+</span> r<span class="token punctuation">[</span>i <span class="token operator">-</span> k<span class="token punctuation">]</span> <span class="token operator">&lt;</span> j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         r<span class="token punctuation">[</span>i <span class="token operator">+</span> k<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span>i <span class="token operator">-</span> k<span class="token punctuation">]</span><span class="token punctuation">;</span>
         k<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      i <span class="token operator">+=</span> k<span class="token punctuation">,</span> j <span class="token operator">-=</span> k<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> r<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="RollingHash.hpp">RollingHash.hpp</h2>
        md5: b0e4a8

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">const</span> ll mod <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1LL</span> <span class="token operator">&lt;&lt;</span> <span class="token number">61</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
ll <span class="token function">add</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span> ll b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">+=</span> b<span class="token punctuation">)</span> <span class="token operator">>=</span> mod <span class="token operator">?</span> a <span class="token operator">-</span> mod <span class="token operator">:</span> a<span class="token punctuation">;</span> <span class="token punctuation">}</span>
ll <span class="token function">mul</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span> ll b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   i128 c <span class="token operator">=</span> <span class="token punctuation">(</span>i128<span class="token punctuation">)</span>a <span class="token operator">*</span> b<span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token function">add</span><span class="token punctuation">(</span>c <span class="token operator">>></span> <span class="token number">61</span><span class="token punctuation">,</span> c <span class="token operator">&amp;</span> mod<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
ll r <span class="token operator">=</span> <span class="token number">7954398468495</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">RH</span> <span class="token punctuation">{</span>
   ll n<span class="token punctuation">;</span>
   vl hs<span class="token punctuation">,</span> pw<span class="token punctuation">;</span>
   <span class="token function">RH</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">n</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">hs</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">pw</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         pw<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">mul</span><span class="token punctuation">(</span>pw<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
         hs<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token function">mul</span><span class="token punctuation">(</span>hs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   ll <span class="token function">get</span><span class="token punctuation">(</span>ll l<span class="token punctuation">,</span> ll r<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">add</span><span class="token punctuation">(</span>hs<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> mod <span class="token operator">-</span> <span class="token function">mul</span><span class="token punctuation">(</span>hs<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">,</span> pw<span class="token punctuation">[</span>r <span class="token operator">-</span> l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">int</span> <span class="token function">lcp</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> ok <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ng <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>n <span class="token operator">-</span> i<span class="token punctuation">,</span> n <span class="token operator">-</span> j<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>ok <span class="token operator">&lt;</span> ng <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> mid <span class="token operator">=</span> ok <span class="token operator">+</span> ng <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> i <span class="token operator">+</span> mid<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> j <span class="token operator">+</span> mid<span class="token punctuation">)</span> <span class="token operator">?</span> ok <span class="token operator">:</span> ng<span class="token punctuation">)</span> <span class="token operator">=</span> mid<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> ok<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="SuffixArray.hpp">SuffixArray.hpp</h2>
        md5: deae26

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token comment">// returns pair{sa, lcp}</span>
<span class="token comment">// sa 長さ n : s[sa[0]:] &lt; s[sa[1]:] &lt; … &lt; s[sa[n-1]:]</span>
<span class="token comment">// lcp 長さ n-1 : lcp[i] = LCP(s[sa[i]:], s[sa[i+1]:])</span>
<span class="token keyword">auto</span> <span class="token function">SA</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   ll n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> lim <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span>
   <span class="token comment">// assert(lim > ranges::max(s));</span>
   vector<span class="token operator">&lt;</span>ll<span class="token operator">></span> <span class="token function">sa</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">lcp</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ws</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> lim<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rk</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">iota</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ll j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> p <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token number">1LL</span><span class="token punctuation">,</span> j <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lim <span class="token operator">=</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      p <span class="token operator">=</span> j<span class="token punctuation">;</span>
      <span class="token function">iota</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> n <span class="token operator">-</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> j<span class="token punctuation">)</span> y<span class="token punctuation">[</span>p<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> j<span class="token punctuation">;</span>
      <span class="token function">fill</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>ws<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> ws<span class="token punctuation">[</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> lim<span class="token punctuation">)</span> ws<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> ws<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ll i <span class="token operator">=</span> n<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">)</span> sa<span class="token punctuation">[</span><span class="token operator">--</span>ws<span class="token punctuation">[</span>x<span class="token punctuation">[</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">swap</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
      p <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      x<span class="token punctuation">[</span>sa<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         ll a <span class="token operator">=</span> sa<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b <span class="token operator">=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         x<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>y<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">==</span> y<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> y<span class="token punctuation">[</span>a <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">==</span> y<span class="token punctuation">[</span>b <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> p <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">:</span> p<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> rk<span class="token punctuation">[</span>sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ll i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> lcp<span class="token punctuation">[</span>rk<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> k<span class="token operator">--</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i <span class="token operator">+</span> k<span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>sa<span class="token punctuation">[</span>rk<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> k<span class="token punctuation">]</span><span class="token punctuation">)</span> k<span class="token operator">++</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   sa<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   lcp<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>lcp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> pair<span class="token punctuation">{</span>sa<span class="token punctuation">,</span> lcp<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div>

    <div class="filename">
        <h2 id="Zalgorithm.hpp">Zalgorithm.hpp</h2>
        md5: d3bdab

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> vi <span class="token function">z_algorithm</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> l <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
   vi <span class="token function">z</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span><span class="token operator">&amp;</span> x <span class="token operator">=</span> z<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">&lt;</span> r <span class="token operator">?</span> <span class="token generic-function"><span class="token function">min</span><span class="token generic class-name"><span class="token operator">&lt;</span>ll<span class="token operator">></span></span></span><span class="token punctuation">(</span>r <span class="token operator">-</span> i<span class="token punctuation">,</span> z<span class="token punctuation">[</span>i <span class="token operator">-</span> l<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">+</span> x <span class="token operator">&lt;</span> n <span class="token operator">and</span> s<span class="token punctuation">[</span>i <span class="token operator">+</span> x<span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> x<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">+</span> x <span class="token operator">></span> r<span class="token punctuation">)</span> l <span class="token operator">=</span> i<span class="token punctuation">,</span> r <span class="token operator">=</span> i <span class="token operator">+</span> x<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> z<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="enumerate-runs.hpp">enumerate-runs.hpp</h2>
        md5: aec96b

    </div>
    <div class="content content-hpp">
    <pre><code>
<span class="token comment">// (length, l, r)</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> vector<span class="token operator">&lt;</span>array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">>></span> <span class="token function">enum_runs</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">si</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">>></span> res<span class="token punctuation">;</span>
   <span class="token keyword">auto</span> dfs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;&amp;</span> f<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">-</span> l <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> m <span class="token operator">=</span> l <span class="token operator">+</span> r <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token function">f</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> l<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">f</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> m<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">sl</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">rbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> n <span class="token operator">-</span> m<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">rbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> n <span class="token operator">-</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      sl<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>sl<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">rbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> n <span class="token operator">-</span> r<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">rbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> n <span class="token operator">-</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">sr</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> m<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      sr<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>sr<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> l<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">auto</span> zsl <span class="token operator">=</span> <span class="token function">z_algorithm</span><span class="token punctuation">(</span>sl<span class="token punctuation">)</span><span class="token punctuation">,</span> zsr <span class="token operator">=</span> <span class="token function">z_algorithm</span><span class="token punctuation">(</span>sr<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> m <span class="token operator">-</span> l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> ml <span class="token operator">=</span> <span class="token generic-function"><span class="token function">max</span><span class="token generic class-name"><span class="token operator">&lt;</span>ll<span class="token operator">></span></span></span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> m <span class="token operator">-</span> t <span class="token operator">-</span> zsl<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mr <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> m <span class="token operator">+</span> zsr<span class="token punctuation">[</span>r <span class="token operator">-</span> l <span class="token operator">-</span> t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>mr <span class="token operator">-</span> ml <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">*</span> t <span class="token function">and</span> <span class="token punctuation">(</span>ml <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">or</span> s<span class="token punctuation">[</span>ml <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> s<span class="token punctuation">[</span>ml <span class="token operator">+</span> t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">and</span> <span class="token punctuation">(</span>mr <span class="token operator">==</span> n <span class="token operator">or</span> s<span class="token punctuation">[</span>mr<span class="token punctuation">]</span> <span class="token operator">!=</span> s<span class="token punctuation">[</span>mr <span class="token operator">-</span> t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span>ml<span class="token punctuation">,</span> mr<span class="token punctuation">,</span> t<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> t <span class="token operator">&lt;=</span> r <span class="token operator">-</span> m<span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> ml <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> m <span class="token operator">-</span> zsl<span class="token punctuation">[</span>r <span class="token operator">-</span> l <span class="token operator">-</span> t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mr <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> m <span class="token operator">+</span> t <span class="token operator">+</span> zsr<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>mr <span class="token operator">-</span> ml <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">*</span> t <span class="token function">and</span> <span class="token punctuation">(</span>ml <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">or</span> s<span class="token punctuation">[</span>ml <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> s<span class="token punctuation">[</span>ml <span class="token operator">+</span> t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">and</span> <span class="token punctuation">(</span>mr <span class="token operator">==</span> n <span class="token operator">or</span> s<span class="token punctuation">[</span>mr<span class="token punctuation">]</span> <span class="token operator">!=</span> s<span class="token punctuation">[</span>mr <span class="token operator">-</span> t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span>ml<span class="token punctuation">,</span> mr<span class="token punctuation">,</span> t<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">dfs</span><span class="token punctuation">(</span>dfs<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">>></span> nres<span class="token punctuation">;</span>
   <span class="token keyword">int</span> pl <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> pr <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token punctuation">[</span>l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> t<span class="token punctuation">]</span> <span class="token operator">:</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> pl <span class="token operator">and</span> r <span class="token operator">==</span> pr<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
      pl <span class="token operator">=</span> l<span class="token punctuation">,</span> pr <span class="token operator">=</span> r<span class="token punctuation">;</span>
      nres<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span>t<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> nres<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div>

    <h2 class="section" id="geometry">geometry</h2>

    <div class="filename">
        <h2 id="argument-sort.hpp">argument-sort.hpp</h2>
        md5: 26b1fa

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span>point P<span class="token punctuation">,</span> point Q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">long</span> <span class="token keyword">long</span> C <span class="token operator">=</span> <span class="token function">cross</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> Q<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>C <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">dot</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> Q<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>P<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> P<span class="token punctuation">.</span>y <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Q<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> Q<span class="token punctuation">.</span>y <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>P<span class="token punctuation">.</span>y <span class="token operator">*</span> Q<span class="token punctuation">.</span>y <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> P<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> Q<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> C <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="circle.hpp">circle.hpp</h2>
        md5: 514ea6

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">circle</span> <span class="token punctuation">{</span>
   point C<span class="token punctuation">;</span>
   <span class="token keyword">double</span> r<span class="token punctuation">;</span>
   <span class="token function">circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token function">circle</span><span class="token punctuation">(</span>point C<span class="token punctuation">,</span> <span class="token keyword">double</span> r<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">C</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">r</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
pair<span class="token operator">&lt;</span>point<span class="token punctuation">,</span> point<span class="token operator">></span> <span class="token function">line_circle_intersection</span><span class="token punctuation">(</span>line L<span class="token punctuation">,</span> circle C<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   point P <span class="token operator">=</span> <span class="token function">projection</span><span class="token punctuation">(</span>C<span class="token punctuation">.</span>C<span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token function">point_line_distance</span><span class="token punctuation">(</span>C<span class="token punctuation">.</span>C<span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> h <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>C<span class="token punctuation">.</span>r <span class="token operator">*</span> C<span class="token punctuation">.</span>r <span class="token operator">-</span> d <span class="token operator">*</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
   point A <span class="token operator">=</span> P <span class="token operator">+</span> <span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> h<span class="token punctuation">;</span>
   point B <span class="token operator">=</span> P <span class="token operator">-</span> <span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> h<span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token function">make_pair</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
pair<span class="token operator">&lt;</span>point<span class="token punctuation">,</span> point<span class="token operator">></span> <span class="token function">circle_intersection</span><span class="token punctuation">(</span>circle C1<span class="token punctuation">,</span> circle C2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token function">dist</span><span class="token punctuation">(</span>C1<span class="token punctuation">.</span>C<span class="token punctuation">,</span> C2<span class="token punctuation">.</span>C<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> m <span class="token operator">=</span> <span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">*</span> C1<span class="token punctuation">.</span>r <span class="token operator">-</span> C2<span class="token punctuation">.</span>r <span class="token operator">*</span> C2<span class="token punctuation">.</span>r <span class="token operator">+</span> d <span class="token operator">*</span> d<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>d <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   point M <span class="token operator">=</span> C1<span class="token punctuation">.</span>C <span class="token operator">+</span> <span class="token punctuation">(</span>C2<span class="token punctuation">.</span>C <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> d <span class="token operator">*</span> m<span class="token punctuation">;</span>
   <span class="token keyword">double</span> h <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">*</span> C1<span class="token punctuation">.</span>r <span class="token operator">-</span> m <span class="token operator">*</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
   point H <span class="token operator">=</span> <span class="token function">rotate90</span><span class="token punctuation">(</span>C2<span class="token punctuation">.</span>C <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> d <span class="token operator">*</span> h<span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token function">make_pair</span><span class="token punctuation">(</span>M <span class="token operator">-</span> H<span class="token punctuation">,</span> M <span class="token operator">+</span> H<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
pair<span class="token operator">&lt;</span>point<span class="token punctuation">,</span> point<span class="token operator">></span> <span class="token function">circle_tangent</span><span class="token punctuation">(</span>point P<span class="token punctuation">,</span> circle C<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token function">dist</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> C<span class="token punctuation">.</span>C<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> r <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>d <span class="token operator">*</span> d <span class="token operator">-</span> C<span class="token punctuation">.</span>r <span class="token operator">*</span> C<span class="token punctuation">.</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token function">circle_intersection</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> <span class="token function">circle</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
vector<span class="token operator">&lt;</span>line<span class="token operator">></span> <span class="token function">common_tangent</span><span class="token punctuation">(</span>circle C1<span class="token punctuation">,</span> circle C2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">swap</span><span class="token punctuation">(</span>C1<span class="token punctuation">,</span> C2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token function">dist</span><span class="token punctuation">(</span>C1<span class="token punctuation">.</span>C<span class="token punctuation">,</span> C2<span class="token punctuation">.</span>C<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>line<span class="token operator">></span> L<span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">-</span> C2<span class="token punctuation">.</span>r <span class="token operator">&lt;=</span> d <span class="token operator">+</span> eps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">-</span> C2<span class="token punctuation">.</span>r <span class="token operator">&lt;=</span> eps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         point D <span class="token operator">=</span> <span class="token function">rotate90</span><span class="token punctuation">(</span>C2<span class="token punctuation">.</span>C <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> d <span class="token operator">*</span> C1<span class="token punctuation">.</span>r<span class="token punctuation">;</span>
         L<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span>C1<span class="token punctuation">.</span>C <span class="token operator">+</span> D<span class="token punctuation">,</span> C2<span class="token punctuation">.</span>C <span class="token operator">+</span> D<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         L<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span>C1<span class="token punctuation">.</span>C <span class="token operator">-</span> D<span class="token punctuation">,</span> C2<span class="token punctuation">.</span>C <span class="token operator">-</span> D<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token keyword">double</span> m <span class="token operator">=</span> <span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">-</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">-</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">)</span> <span class="token operator">/</span> d<span class="token punctuation">;</span>
         point M <span class="token operator">=</span> C1<span class="token punctuation">.</span>C <span class="token operator">+</span> <span class="token punctuation">(</span>C2<span class="token punctuation">.</span>C <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> d <span class="token operator">*</span> m<span class="token punctuation">;</span>
         <span class="token keyword">double</span> h <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">-</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">-</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">)</span> <span class="token operator">-</span> m <span class="token operator">*</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
         point H1 <span class="token operator">=</span> M <span class="token operator">+</span> <span class="token function">rotate90</span><span class="token punctuation">(</span>C2<span class="token punctuation">.</span>C <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> d <span class="token operator">*</span> h<span class="token punctuation">;</span>
         point D1 <span class="token operator">=</span> <span class="token punctuation">(</span>H1 <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">dist</span><span class="token punctuation">(</span>H1<span class="token punctuation">,</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">*</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">;</span>
         L<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span>H1 <span class="token operator">+</span> D1<span class="token punctuation">,</span> C2<span class="token punctuation">.</span>C <span class="token operator">+</span> D1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         point H2 <span class="token operator">=</span> M <span class="token operator">-</span> <span class="token function">rotate90</span><span class="token punctuation">(</span>C2<span class="token punctuation">.</span>C <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> d <span class="token operator">*</span> h<span class="token punctuation">;</span>
         point D2 <span class="token operator">=</span> <span class="token punctuation">(</span>H2 <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">dist</span><span class="token punctuation">(</span>H2<span class="token punctuation">,</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">*</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">;</span>
         L<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span>H2 <span class="token operator">+</span> D2<span class="token punctuation">,</span> C2<span class="token punctuation">.</span>C <span class="token operator">+</span> D2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">+</span> C2<span class="token punctuation">.</span>r <span class="token operator">&lt;=</span> d <span class="token operator">+</span> eps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">double</span> m <span class="token operator">=</span> <span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">+</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">+</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">)</span> <span class="token operator">/</span> d<span class="token punctuation">;</span>
      point M <span class="token operator">=</span> C1<span class="token punctuation">.</span>C <span class="token operator">+</span> <span class="token punctuation">(</span>C2<span class="token punctuation">.</span>C <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> d <span class="token operator">*</span> m<span class="token punctuation">;</span>
      <span class="token keyword">double</span> h <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">+</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>C1<span class="token punctuation">.</span>r <span class="token operator">+</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">)</span> <span class="token operator">-</span> m <span class="token operator">*</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
      point H1 <span class="token operator">=</span> M <span class="token operator">+</span> <span class="token function">rotate90</span><span class="token punctuation">(</span>C2<span class="token punctuation">.</span>C <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> d <span class="token operator">*</span> h<span class="token punctuation">;</span>
      point D1 <span class="token operator">=</span> <span class="token punctuation">(</span>H1 <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">dist</span><span class="token punctuation">(</span>H1<span class="token punctuation">,</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">*</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">;</span>
      L<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span>H1 <span class="token operator">-</span> D1<span class="token punctuation">,</span> C2<span class="token punctuation">.</span>C <span class="token operator">-</span> D1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      point H2 <span class="token operator">=</span> M <span class="token operator">-</span> <span class="token function">rotate90</span><span class="token punctuation">(</span>C2<span class="token punctuation">.</span>C <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> d <span class="token operator">*</span> h<span class="token punctuation">;</span>
      point D2 <span class="token operator">=</span> <span class="token punctuation">(</span>H2 <span class="token operator">-</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">dist</span><span class="token punctuation">(</span>H2<span class="token punctuation">,</span> C1<span class="token punctuation">.</span>C<span class="token punctuation">)</span> <span class="token operator">*</span> C2<span class="token punctuation">.</span>r<span class="token punctuation">;</span>
      L<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span>H2 <span class="token operator">-</span> D2<span class="token punctuation">,</span> C2<span class="token punctuation">.</span>C <span class="token operator">-</span> D2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> L<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="convex-hull.hpp">convex-hull.hpp</h2>
        md5: 7b7e26

    </div>
    <div class="content content-hpp">
    <pre><code>Points <span class="token function">convex_hull</span><span class="token punctuation">(</span>Points<span class="token operator">&amp;</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> p<span class="token punctuation">;</span>
   <span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>pt x<span class="token punctuation">,</span> pt y<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>x <span class="token operator">!=</span> y<span class="token punctuation">.</span>x <span class="token operator">?</span> x<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> y<span class="token punctuation">.</span>x <span class="token operator">:</span> x<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> y<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   Points <span class="token function">ch</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> ch<span class="token punctuation">[</span>k<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>k <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token function">cross</span><span class="token punctuation">(</span>ch<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> ch<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> ch<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">--</span>k<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> t <span class="token operator">=</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> ch<span class="token punctuation">[</span>k<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">[</span>i<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>k <span class="token operator">>=</span> t <span class="token operator">&amp;&amp;</span> <span class="token function">cross</span><span class="token punctuation">(</span>ch<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> ch<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> ch<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">--</span>k<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   ch<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> ch<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <div class="filename">
        <h2 id="funcs.hpp">funcs.hpp</h2>
        md5: 19bea4

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">int</span> <span class="token function">contains</span><span class="token punctuation">(</span><span class="token keyword">const</span> Polygon<span class="token operator">&amp;</span> Q<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">bool</span> in <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Point a <span class="token operator">=</span> Q<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> p<span class="token punctuation">,</span> b <span class="token operator">=</span> Q<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> p<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>y <span class="token operator">></span> b<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>y <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token number">0</span> <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>y <span class="token operator">&amp;&amp;</span> <span class="token function">cross</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> in <span class="token operator">=</span> <span class="token operator">!</span>in<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">cross</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">dot</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> _ON<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> in <span class="token operator">?</span> _IN <span class="token operator">:</span> _OUT<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Polygon <span class="token function">Minkowski_sum</span><span class="token punctuation">(</span><span class="token keyword">const</span> Polygon<span class="token operator">&amp;</span> P<span class="token punctuation">,</span> <span class="token keyword">const</span> Polygon<span class="token operator">&amp;</span> Q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   vector<span class="token operator">&lt;</span>Segment<span class="token operator">></span> <span class="token function">e1</span><span class="token punctuation">(</span>P<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">e2</span><span class="token punctuation">(</span>Q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ed</span><span class="token punctuation">(</span>P<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> Q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">const</span> <span class="token keyword">auto</span> cmp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> Segment<span class="token operator">&amp;</span> u<span class="token punctuation">,</span> <span class="token keyword">const</span> Segment<span class="token operator">&amp;</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>u<span class="token punctuation">.</span>b <span class="token operator">-</span> u<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg_cmp</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>b <span class="token operator">-</span> v<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> P<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> e1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> P<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> P<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> Q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> e2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>Q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> Q<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">rotate</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>e1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min_element</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>e1<span class="token punctuation">)</span><span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>e1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">rotate</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>e2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min_element</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>e2<span class="token punctuation">)</span><span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>e2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">merge</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>e1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">all</span><span class="token punctuation">(</span>e2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">begin</span><span class="token punctuation">(</span>ed<span class="token punctuation">)</span><span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">const</span> <span class="token keyword">auto</span> check <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> Points<span class="token operator">&amp;</span> res<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> u<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token keyword">auto</span> back1 <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> back2 <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">prev</span><span class="token punctuation">(</span><span class="token function">end</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token function">cross</span><span class="token punctuation">(</span>back1 <span class="token operator">-</span> back2<span class="token punctuation">,</span> u <span class="token operator">-</span> back2<span class="token punctuation">)</span><span class="token punctuation">,</span> eps<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token function">dot</span><span class="token punctuation">(</span>back1 <span class="token operator">-</span> back2<span class="token punctuation">,</span> u <span class="token operator">-</span> back1<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token operator">-</span>eps<span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">auto</span> u <span class="token operator">=</span> e1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>a <span class="token operator">+</span> e2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>a<span class="token punctuation">;</span>
   Points res<span class="token punctuation">{</span>u<span class="token punctuation">}</span><span class="token punctuation">;</span>
   res<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span>P<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> Q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> v <span class="token operator">:</span> ed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      u <span class="token operator">=</span> u <span class="token operator">+</span> v<span class="token punctuation">.</span>b <span class="token operator">-</span> v<span class="token punctuation">.</span>a<span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">si</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">and</span> <span class="token function">check</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">eb</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token function">check</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// -1 : on, 0 : out, 1 : in</span>
<span class="token comment">// O(log(n))</span>
<span class="token keyword">bool</span> <span class="token function">is_in</span><span class="token punctuation">(</span><span class="token keyword">const</span> Polygon<span class="token operator">&amp;</span> p<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> a <span class="token operator">==</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">intersect</span><span class="token punctuation">(</span><span class="token function">Segment</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toleft</span><span class="token punctuation">(</span>a <span class="token operator">-</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toleft</span><span class="token punctuation">(</span>a <span class="token operator">-</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">const</span> <span class="token keyword">auto</span> cmp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> u<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>u <span class="token operator">-</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toleft</span><span class="token punctuation">(</span>v <span class="token operator">-</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">const</span> size_t i <span class="token operator">=</span> <span class="token function">lower_bound</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> cmp<span class="token punctuation">)</span> <span class="token operator">-</span> p<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">intersect</span><span class="token punctuation">(</span><span class="token function">Segment</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> p<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token function">intersect</span><span class="token punctuation">(</span><span class="token function">Segment</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intersect</span><span class="token punctuation">(</span><span class="token function">Segment</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> p<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toleft</span><span class="token punctuation">(</span>a <span class="token operator">-</span> p<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">using</span> speP <span class="token operator">=</span> pair<span class="token operator">&lt;</span>ld<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">ccut</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span><span class="token operator">:</span>
   set<span class="token operator">&lt;</span>speP<span class="token operator">></span> ags<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> nexs<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> pres<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>Point<span class="token operator">></span> ps<span class="token punctuation">;</span>

   <span class="token keyword">public</span><span class="token operator">:</span>
   <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> ld sup <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">100000</span><span class="token punctuation">;</span>
      ps<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">-</span>sup<span class="token punctuation">,</span> <span class="token operator">-</span>sup<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ps<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span>sup<span class="token punctuation">,</span> <span class="token operator">-</span>sup<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ps<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span>sup<span class="token punctuation">,</span> sup<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ps<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">-</span>sup<span class="token punctuation">,</span> sup<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      nexs<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      pres<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">int</span> ni <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
         Point dif <span class="token operator">=</span> ps<span class="token punctuation">[</span>ni<span class="token punctuation">]</span> <span class="token operator">-</span> ps<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         ld t <span class="token operator">=</span> <span class="token function">arg</span><span class="token punctuation">(</span>dif<span class="token punctuation">)</span><span class="token punctuation">;</span>
         ags<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>t<span class="token punctuation">,</span> i<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         nexs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ni<span class="token punctuation">;</span>
         pres<span class="token punctuation">[</span>ni<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">convex_cut</span><span class="token punctuation">(</span>Point a<span class="token punctuation">,</span> Point b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ags<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      Point dif <span class="token operator">=</span> b <span class="token operator">-</span> a<span class="token punctuation">;</span>
      ld t <span class="token operator">=</span> <span class="token function">arg</span><span class="token punctuation">(</span>dif<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">auto</span> itr <span class="token operator">=</span> ags<span class="token punctuation">.</span><span class="token function">lower_bound</span><span class="token punctuation">(</span><span class="token punctuation">{</span>t<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>itr <span class="token operator">==</span> ags<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> itr <span class="token operator">=</span> ags<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> cur <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>itr<span class="token punctuation">)</span><span class="token punctuation">.</span>second<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">ccw</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> ps<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> ricur <span class="token operator">=</span> nexs<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>ricur <span class="token operator">!=</span> cur <span class="token operator">&amp;&amp;</span> <span class="token function">ccw</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> ps<span class="token punctuation">[</span>ricur<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> ricur <span class="token operator">=</span> nexs<span class="token punctuation">[</span>ricur<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ricur <span class="token operator">==</span> cur<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         ags<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">int</span> lecur <span class="token operator">=</span> pres<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">ccw</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> ps<span class="token punctuation">[</span>lecur<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> lecur <span class="token operator">=</span> pres<span class="token punctuation">[</span>lecur<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token comment">// new point</span>
      Line l <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token punctuation">,</span> b<span class="token punctuation">}</span><span class="token punctuation">;</span>
      Line l1 <span class="token operator">=</span> <span class="token punctuation">{</span>ps<span class="token punctuation">[</span>lecur<span class="token punctuation">]</span><span class="token punctuation">,</span> ps<span class="token punctuation">[</span>nexs<span class="token punctuation">[</span>lecur<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      Line l2 <span class="token operator">=</span> <span class="token punctuation">{</span>ps<span class="token punctuation">[</span>pres<span class="token punctuation">[</span>ricur<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ps<span class="token punctuation">[</span>ricur<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      Point p1 <span class="token operator">=</span> <span class="token function">is_ll</span><span class="token punctuation">(</span>l1<span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      Point p2 <span class="token operator">=</span> <span class="token function">is_ll</span><span class="token punctuation">(</span>l2<span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> id1 <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> id2 <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      ps<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">,</span> ps<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> nexs<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pres<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// erase(lecur,ricur)</span>
      cur <span class="token operator">=</span> lecur<span class="token punctuation">;</span>
      <span class="token keyword">int</span> tmp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>cur <span class="token operator">!=</span> ricur <span class="token operator">||</span> <span class="token operator">!</span>tmp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         Point dif <span class="token operator">=</span> ps<span class="token punctuation">[</span>nexs<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">-</span> ps<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">;</span>
         ld t <span class="token operator">=</span> <span class="token function">arg</span><span class="token punctuation">(</span>dif<span class="token punctuation">)</span><span class="token punctuation">;</span>
         ags<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token punctuation">{</span>t<span class="token punctuation">,</span> cur<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         cur <span class="token operator">=</span> nexs<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">;</span>
         tmp<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      nexs<span class="token punctuation">[</span>lecur<span class="token punctuation">]</span> <span class="token operator">=</span> id1<span class="token punctuation">,</span> pres<span class="token punctuation">[</span>id1<span class="token punctuation">]</span> <span class="token operator">=</span> lecur<span class="token punctuation">,</span> nexs<span class="token punctuation">[</span>id1<span class="token punctuation">]</span> <span class="token operator">=</span> id2<span class="token punctuation">;</span>
      pres<span class="token punctuation">[</span>id2<span class="token punctuation">]</span> <span class="token operator">=</span> id1<span class="token punctuation">,</span> nexs<span class="token punctuation">[</span>id2<span class="token punctuation">]</span> <span class="token operator">=</span> ricur<span class="token punctuation">,</span> pres<span class="token punctuation">[</span>ricur<span class="token punctuation">]</span> <span class="token operator">=</span> id2<span class="token punctuation">;</span>
      cur <span class="token operator">=</span> lecur<span class="token punctuation">,</span> tmp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>cur <span class="token operator">!=</span> ricur <span class="token operator">||</span> <span class="token operator">!</span>tmp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         Point dif <span class="token operator">=</span> ps<span class="token punctuation">[</span>nexs<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">-</span> ps<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">;</span>
         ld t <span class="token operator">=</span> <span class="token function">arg</span><span class="token punctuation">(</span>dif<span class="token punctuation">)</span><span class="token punctuation">;</span>
         ags<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>t<span class="token punctuation">,</span> cur<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         cur <span class="token operator">=</span> nexs<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">;</span>
         tmp<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   polygon <span class="token function">nw_poly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      polygon nw<span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> p <span class="token operator">:</span> ags<span class="token punctuation">)</span> nw<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>ps<span class="token punctuation">[</span>p<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> nw<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   ld <span class="token function">calc_area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      polygon nw<span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> p <span class="token operator">:</span> ags<span class="token punctuation">)</span> nw<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>ps<span class="token punctuation">[</span>p<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">area</span><span class="token punctuation">(</span>nw<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="line.hpp">line.hpp</h2>
        md5: 447fab

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">bool</span> <span class="token function">point_on_segment</span><span class="token punctuation">(</span>point P<span class="token punctuation">,</span> line L<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">dot</span><span class="token punctuation">(</span>P <span class="token operator">-</span> L<span class="token punctuation">.</span>A<span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span>eps <span class="token operator">&amp;&amp;</span> <span class="token function">dot</span><span class="token punctuation">(</span>P <span class="token operator">-</span> L<span class="token punctuation">.</span>B<span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> eps<span class="token punctuation">;</span> <span class="token punctuation">}</span>
point <span class="token function">projection</span><span class="token punctuation">(</span>point P<span class="token punctuation">,</span> line L<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> L<span class="token punctuation">.</span>A <span class="token operator">+</span> <span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">dot</span><span class="token punctuation">(</span>P <span class="token operator">-</span> L<span class="token punctuation">.</span>A<span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
point <span class="token function">reflection</span><span class="token punctuation">(</span>point P<span class="token punctuation">,</span> line L<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">projection</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> L<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> P<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">double</span> <span class="token function">point_line_distance</span><span class="token punctuation">(</span>point P<span class="token punctuation">,</span> line L<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">cross</span><span class="token punctuation">(</span>P <span class="token operator">-</span> L<span class="token punctuation">.</span>A<span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">double</span> <span class="token function">point_segment_distance</span><span class="token punctuation">(</span>point P<span class="token punctuation">,</span> line L<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">dot</span><span class="token punctuation">(</span>P <span class="token operator">-</span> L<span class="token punctuation">.</span>A<span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">dist</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> L<span class="token punctuation">.</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">dot</span><span class="token punctuation">(</span>P <span class="token operator">-</span> L<span class="token punctuation">.</span>B<span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">dist</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> L<span class="token punctuation">.</span>B<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">point_line_distance</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token function">is_parallel</span><span class="token punctuation">(</span>line L1<span class="token punctuation">,</span> line L2<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">cross</span><span class="token punctuation">(</span><span class="token function">vec</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> eps<span class="token punctuation">;</span> <span class="token punctuation">}</span>
point <span class="token function">line_intersection</span><span class="token punctuation">(</span>line L1<span class="token punctuation">,</span> line L2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> L1<span class="token punctuation">.</span>A <span class="token operator">+</span> <span class="token function">vec</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">cross</span><span class="token punctuation">(</span>L2<span class="token punctuation">.</span>A <span class="token operator">-</span> L1<span class="token punctuation">.</span>A<span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">cross</span><span class="token punctuation">(</span><span class="token function">vec</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token function">segment_intersect</span><span class="token punctuation">(</span>line L1<span class="token punctuation">,</span> line L2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token function">cross</span><span class="token punctuation">(</span>L1<span class="token punctuation">.</span>A <span class="token operator">-</span> L2<span class="token punctuation">.</span>A<span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">cross</span><span class="token punctuation">(</span>L1<span class="token punctuation">.</span>B <span class="token operator">-</span> L2<span class="token punctuation">.</span>A<span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> eps
          <span class="token operator">&amp;&amp;</span> <span class="token function">cross</span><span class="token punctuation">(</span>L2<span class="token punctuation">.</span>A <span class="token operator">-</span> L1<span class="token punctuation">.</span>A<span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">cross</span><span class="token punctuation">(</span>L2<span class="token punctuation">.</span>B <span class="token operator">-</span> L1<span class="token punctuation">.</span>A<span class="token punctuation">,</span> <span class="token function">vec</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> eps<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">double</span> <span class="token function">segment_distance</span><span class="token punctuation">(</span>line L1<span class="token punctuation">,</span> line L2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">segment_intersect</span><span class="token punctuation">(</span>L1<span class="token punctuation">,</span> L2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">double</span> ans <span class="token operator">=</span> INF<span class="token punctuation">;</span>
      ans <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> <span class="token function">point_segment_distance</span><span class="token punctuation">(</span>L1<span class="token punctuation">.</span>A<span class="token punctuation">,</span> L2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ans <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> <span class="token function">point_segment_distance</span><span class="token punctuation">(</span>L1<span class="token punctuation">.</span>B<span class="token punctuation">,</span> L2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ans <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> <span class="token function">point_segment_distance</span><span class="token punctuation">(</span>L2<span class="token punctuation">.</span>A<span class="token punctuation">,</span> L1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ans <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> <span class="token function">point_segment_distance</span><span class="token punctuation">(</span>L2<span class="token punctuation">.</span>B<span class="token punctuation">,</span> L1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
</div>

    <h2 class="section" id="misc">misc</h2>

    <div class="filename">
        <h2 id="clock.hpp">clock.hpp</h2>
        md5: a1f32c

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">struct</span> <span class="token class-name">Timer</span> <span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">C</span> <span class="token expression">chrono<span class="token double-colon punctuation">::</span>high_resolution_clock</span></span>
   C<span class="token double-colon punctuation">::</span>time_point c<span class="token punctuation">;</span>
   <span class="token function">Timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token class-name">C</span><span class="token double-colon punctuation">::</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">elapsed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">auto</span> d <span class="token operator">=</span> <span class="token class-name">C</span><span class="token double-colon punctuation">::</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> chrono<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">duration_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>chrono<span class="token double-colon punctuation">::</span>milliseconds<span class="token operator">></span></span></span><span class="token punctuation">(</span>d <span class="token operator">-</span> c<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">C</span></span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <div class="filename">
        <h2 id="simplex.hpp">simplex.hpp</h2>
        md5: 644ba1

    </div>
    <div class="content content-hpp">
    <pre><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">F</span> <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">,</span> <span class="token keyword">int</span> DEPS <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token keyword">bool</span> Randomize <span class="token operator">=</span> <span class="token boolean">true</span><span class="token operator">></span> <span class="token keyword">struct</span> <span class="token class-name">Simplex</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> F EPS <span class="token operator">=</span> <span class="token function">F</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1LL</span> <span class="token operator">&lt;&lt;</span> DEPS<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">;</span>
   vi shuffle_idx<span class="token punctuation">;</span>
   vi idx<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>F<span class="token operator">>></span> mat<span class="token punctuation">;</span>
   <span class="token keyword">int</span> i_ch<span class="token punctuation">,</span> j_ch<span class="token punctuation">;</span>

   <span class="token keyword">private</span><span class="token operator">:</span>
   <span class="token keyword">void</span> <span class="token function">_initialize</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>F<span class="token operator">>></span><span class="token operator">&amp;</span> A<span class="token punctuation">,</span> <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>F<span class="token operator">></span><span class="token operator">&amp;</span> b<span class="token punctuation">,</span> <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>F<span class="token operator">></span><span class="token operator">&amp;</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      n <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m <span class="token operator">=</span> A<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      mat<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>m <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>F<span class="token operator">></span></span></span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      i_ch <span class="token operator">=</span> m<span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> n<span class="token punctuation">)</span> mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
         mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> i_ch <span class="token operator">=</span> i<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> n<span class="token punctuation">)</span> mat<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
      mat<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

      idx<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>n <span class="token operator">+</span> m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">iota</span><span class="token punctuation">(</span>idx<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> idx<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">inline</span> F <span class="token function">abs_</span><span class="token punctuation">(</span>F x<span class="token punctuation">)</span> <span class="token keyword">noexcept</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">></span> <span class="token operator">-</span>x <span class="token operator">?</span> x <span class="token operator">:</span> <span class="token operator">-</span>x<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span> <span class="token function">_solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      vi jupd<span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>nb_iter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j_ch <span class="token operator">=</span> n<span class="token punctuation">;</span><span class="token punctuation">;</span> nb_iter<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>i_ch <span class="token operator">&lt;</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">swap</span><span class="token punctuation">(</span>idx<span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span><span class="token punctuation">,</span> idx<span class="token punctuation">[</span>i_ch <span class="token operator">+</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">F</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span><span class="token punctuation">;</span>
            jupd<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> n <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">!=</span> j_ch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*=</span> <span class="token operator">-</span>mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span><span class="token punctuation">;</span>
                  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">abs_</span><span class="token punctuation">(</span>mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> EPS<span class="token punctuation">)</span> jupd<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> m <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">abs_</span><span class="token punctuation">(</span>mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> EPS <span class="token operator">or</span> i <span class="token operator">==</span> i_ch<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
               <span class="token function">fore</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> jupd<span class="token punctuation">)</span> mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span> <span class="token operator">*</span> mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
               mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span> <span class="token operator">*=</span> mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>

         j_ch <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>j_ch <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">or</span> idx<span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span> <span class="token operator">></span> idx<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>mat<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> EPS <span class="token function">or</span> <span class="token punctuation">(</span><span class="token function">abs_</span><span class="token punctuation">(</span>mat<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> EPS <span class="token operator">and</span> mat<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> EPS<span class="token punctuation">)</span><span class="token punctuation">)</span> j_ch <span class="token operator">=</span> j<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>j_ch <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>

         i_ch <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token operator">-</span>EPS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>i_ch <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  i_ch <span class="token operator">=</span> i<span class="token punctuation">;</span>
               <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span> <span class="token operator">-</span> mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token operator">-</span>EPS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  i_ch <span class="token operator">=</span> i<span class="token punctuation">;</span>
               <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> mat<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span> <span class="token operator">-</span> mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j_ch<span class="token punctuation">]</span> <span class="token operator">&lt;</span> EPS
                         <span class="token operator">and</span> idx<span class="token punctuation">[</span>i_ch<span class="token punctuation">]</span> <span class="token operator">></span> idx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  i_ch <span class="token operator">=</span> i<span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>i_ch <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            is_infty <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>mat<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token operator">-</span>EPS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         infeasible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      x<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>idx<span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> x<span class="token punctuation">[</span>idx<span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ans <span class="token operator">=</span> mat<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span><span class="token operator">:</span>
   <span class="token function">Simplex</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>F<span class="token operator">>></span> A<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>F<span class="token operator">></span> b<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>F<span class="token operator">></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      is_infty <span class="token operator">=</span> infeasible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span><span class="token punctuation">(</span>Randomize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         mt19937 <span class="token function">rng</span><span class="token punctuation">(</span>chrono<span class="token double-colon punctuation">::</span>steady_clock<span class="token double-colon punctuation">::</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">time_since_epoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         vector<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>F<span class="token operator">></span><span class="token punctuation">,</span> F<span class="token operator">>></span> Abs<span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span> Abs<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">shuffle</span><span class="token punctuation">(</span>Abs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Abs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rng<span class="token punctuation">)</span><span class="token punctuation">;</span>
         A<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">fore</span><span class="token punctuation">(</span>Ab<span class="token punctuation">,</span> Abs<span class="token punctuation">)</span> A<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>Ab<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>Ab<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>

         shuffle_idx<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">iota</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>shuffle_idx<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token function">all</span><span class="token punctuation">(</span>shuffle_idx<span class="token punctuation">)</span><span class="token punctuation">,</span> rng<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">auto</span> Atmp <span class="token operator">=</span> A<span class="token punctuation">;</span>
         <span class="token keyword">auto</span> ctmp <span class="token operator">=</span> c<span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> Atmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>shuffle_idx<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span> c<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> ctmp<span class="token punctuation">[</span>shuffle_idx<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token function">_initialize</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">_solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span><span class="token punctuation">(</span>Randomize <span class="token operator">and</span> x<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">auto</span> xtmp <span class="token operator">=</span> x<span class="token punctuation">;</span>
         <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token function">si</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span> x<span class="token punctuation">[</span>shuffle_idx<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> xtmp<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">unsigned</span> nb_iter<span class="token punctuation">;</span>
   <span class="token keyword">bool</span> is_infty<span class="token punctuation">;</span>
   <span class="token keyword">bool</span> infeasible<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>F<span class="token operator">></span> x<span class="token punctuation">;</span>
   F ans<span class="token punctuation">;</span>

   <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">dual</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>F<span class="token operator">>></span><span class="token operator">&amp;</span> A<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>F<span class="token operator">></span><span class="token operator">&amp;</span> b<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>F<span class="token operator">></span><span class="token operator">&amp;</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token keyword">int</span> n <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>F<span class="token operator">>></span> <span class="token function">At</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span>F<span class="token operator">></span></span></span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> m<span class="token punctuation">)</span> At<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
      A <span class="token operator">=</span> At<span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> n<span class="token punctuation">)</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">rep</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> m<span class="token punctuation">)</span> c<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>c<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
      b<span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</div>

    <h2 class="section" id="memo">memo</h2>

    <div class="filename">
        <h2 id="Primes.md">Primes.md</h2>
    </div>
    <div class="content content-md"><h4>素数の個数</h4>
<table>
<thead>
<tr>
<th>$n$</th>
<th>$10^2$</th>
<th>$10^3$</th>
<th>$10^4$</th>
<th>$10^5$</th>
<th>$10^6$</th>
<th>$10^7$</th>
<th>$10^8$</th>
<th>$10^9$</th>
<th>$10^{10}$</th>
</tr>
</thead>
<tbody><tr>
<td>$\pi(n)$</td>
<td>25</td>
<td>168</td>
<td>1229</td>
<td>9592</td>
<td>78498</td>
<td>664579</td>
<td>5.76e+6</td>
<td>5.08e+7</td>
<td>4.55e+8</td>
</tr>
</tbody></table>
<h4>高度合成数</h4>
<table>
<thead>
<tr>
<th>$≤n$</th>
<th>$10^3$</th>
<th>$10^4$</th>
<th>$10^5$</th>
<th>$10^6$</th>
<th>$10^7$</th>
<th>$10^8$</th>
<th>$10^9$</th>
</tr>
</thead>
<tbody><tr>
<td>$x$</td>
<td>840</td>
<td>7560</td>
<td>83160</td>
<td>720720</td>
<td>8648640</td>
<td>73513440</td>
<td>735134400</td>
</tr>
<tr>
<td>$d^0(x)$</td>
<td>32</td>
<td>64</td>
<td>128</td>
<td>240</td>
<td>448</td>
<td>768</td>
<td>1344</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>$≤n$</th>
<th>$10^{10}$</th>
<th>$10^{11}$</th>
<th>$10^{12}$</th>
<th>$10^{13}$</th>
<th>$10^{14}$</th>
<th>$10^{15}$</th>
<th>$10^{16}$</th>
<th>$10^{17}$</th>
<th>$10^{18}$</th>
</tr>
</thead>
<tbody><tr>
<td>$d^0(x)$</td>
<td>2304</td>
<td>4032</td>
<td>6720</td>
<td>10752</td>
<td>17280</td>
<td>26880</td>
<td>41472</td>
<td>64512</td>
<td>103680</td>
</tr>
</tbody></table>
<h4>素数階乗</h4>
<table>
<thead>
<tr>
<th>$n$</th>
<th>$2$</th>
<th>$3$</th>
<th>$5$</th>
<th>$7$</th>
<th>$11$</th>
<th>$13$</th>
<th>$17$</th>
<th>$19$</th>
<th>$23$</th>
<th>$29$</th>
</tr>
</thead>
<tbody><tr>
<td>$n\#$</td>
<td>2</td>
<td>6</td>
<td>30</td>
<td>210</td>
<td>2310</td>
<td>30030</td>
<td>510510</td>
<td>9.70e+6</td>
<td>2.23e+8</td>
<td>6.47e+9</td>
</tr>
</tbody></table>
<h4>階乗</h4>
<table>
<thead>
<tr>
<th>$4!$</th>
<th>$5!$</th>
<th>$6!$</th>
<th>$7!$</th>
<th>$8!$</th>
<th>$9!$</th>
<th>$10!$</th>
<th>$11!$</th>
<th>$12!$</th>
<th>$13!$</th>
</tr>
</thead>
<tbody><tr>
<td>24</td>
<td>120</td>
<td>720</td>
<td>5040</td>
<td>40320</td>
<td>362880</td>
<td>3.63e+6</td>
<td>3.99e+7</td>
<td>4.79e+8</td>
<td>6.23e+9</td>
</tr>
</tbody></table>
</div>

    <div class="filename">
        <h2 id="math.md">math.md</h2>
    </div>
    <div class="content content-md"><h2>二項係数</h2>
<table>
<thead>
<tr>
<th align="left">n\k</th>
<th align="left">0</th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
<th align="left">9</th>
<th align="left">10</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>0</strong></td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>1</strong></td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>2</strong></td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>3</strong></td>
<td align="left">1</td>
<td align="left">3</td>
<td align="left">3</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>4</strong></td>
<td align="left">1</td>
<td align="left">4</td>
<td align="left">6</td>
<td align="left">4</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>5</strong></td>
<td align="left">1</td>
<td align="left">5</td>
<td align="left">10</td>
<td align="left">10</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>6</strong></td>
<td align="left">1</td>
<td align="left">6</td>
<td align="left">15</td>
<td align="left">20</td>
<td align="left">15</td>
<td align="left">6</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>7</strong></td>
<td align="left">1</td>
<td align="left">7</td>
<td align="left">21</td>
<td align="left">35</td>
<td align="left">35</td>
<td align="left">21</td>
<td align="left">7</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>8</strong></td>
<td align="left">1</td>
<td align="left">8</td>
<td align="left">28</td>
<td align="left">56</td>
<td align="left">70</td>
<td align="left">56</td>
<td align="left">28</td>
<td align="left">8</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>9</strong></td>
<td align="left">1</td>
<td align="left">9</td>
<td align="left">36</td>
<td align="left">84</td>
<td align="left">126</td>
<td align="left">126</td>
<td align="left">84</td>
<td align="left">36</td>
<td align="left">9</td>
<td align="left">1</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>10</strong></td>
<td align="left">1</td>
<td align="left">10</td>
<td align="left">45</td>
<td align="left">120</td>
<td align="left">210</td>
<td align="left">252</td>
<td align="left">210</td>
<td align="left">120</td>
<td align="left">45</td>
<td align="left">10</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left"><strong>11</strong></td>
<td align="left">1</td>
<td align="left">11</td>
<td align="left">55</td>
<td align="left">165</td>
<td align="left">330</td>
<td align="left">462</td>
<td align="left">462</td>
<td align="left">330</td>
<td align="left">165</td>
<td align="left">55</td>
<td align="left">11</td>
</tr>
<tr>
<td align="left"><strong>12</strong></td>
<td align="left">1</td>
<td align="left">12</td>
<td align="left">66</td>
<td align="left">220</td>
<td align="left">495</td>
<td align="left">792</td>
<td align="left">924</td>
<td align="left">792</td>
<td align="left">495</td>
<td align="left">220</td>
<td align="left">66</td>
</tr>
<tr>
<td align="left"><strong>13</strong></td>
<td align="left">1</td>
<td align="left">13</td>
<td align="left">78</td>
<td align="left">286</td>
<td align="left">715</td>
<td align="left">1287</td>
<td align="left">1a716</td>
<td align="left">1716</td>
<td align="left">1287</td>
<td align="left">715</td>
<td align="left">286</td>
</tr>
<tr>
<td align="left"><strong>14</strong></td>
<td align="left">1</td>
<td align="left">14</td>
<td align="left">91</td>
<td align="left">364</td>
<td align="left">1001</td>
<td align="left">2002</td>
<td align="left">3003</td>
<td align="left">3432</td>
<td align="left">3003</td>
<td align="left">2002</td>
<td align="left">1001</td>
</tr>
<tr>
<td align="left"><strong>15</strong></td>
<td align="left">1</td>
<td align="left">15</td>
<td align="left">105</td>
<td align="left">455</td>
<td align="left">1365</td>
<td align="left">3003</td>
<td align="left">5005</td>
<td align="left">6435</td>
<td align="left">6435</td>
<td align="left">5005</td>
<td align="left">3003</td>
</tr>
<tr>
<td align="left"><strong>16</strong></td>
<td align="left">1</td>
<td align="left">16</td>
<td align="left">120</td>
<td align="left">560</td>
<td align="left">1820</td>
<td align="left">4368</td>
<td align="left">8008</td>
<td align="left">11440</td>
<td align="left">12870</td>
<td align="left">11440</td>
<td align="left">8008</td>
</tr>
<tr>
<td align="left"><strong>17</strong></td>
<td align="left">1</td>
<td align="left">17</td>
<td align="left">136</td>
<td align="left">680</td>
<td align="left">2380</td>
<td align="left">6188</td>
<td align="left">12376</td>
<td align="left">19448</td>
<td align="left">24310</td>
<td align="left">24310</td>
<td align="left">19448</td>
</tr>
<tr>
<td align="left"><strong>18</strong></td>
<td align="left">1</td>
<td align="left">18</td>
<td align="left">153</td>
<td align="left">816</td>
<td align="left">3060</td>
<td align="left">8568</td>
<td align="left">18564</td>
<td align="left">31824</td>
<td align="left">43758</td>
<td align="left">48620</td>
<td align="left">43758</td>
</tr>
<tr>
<td align="left"><strong>19</strong></td>
<td align="left">1</td>
<td align="left">19</td>
<td align="left">171</td>
<td align="left">969</td>
<td align="left">3876</td>
<td align="left">11628</td>
<td align="left">27132</td>
<td align="left">50388</td>
<td align="left">75582</td>
<td align="left">92378</td>
<td align="left">92378</td>
</tr>
<tr>
<td align="left"><strong>20</strong></td>
<td align="left">1</td>
<td align="left">20</td>
<td align="left">190</td>
<td align="left">1140</td>
<td align="left">4845</td>
<td align="left">15504</td>
<td align="left">38760</td>
<td align="left">77520</td>
<td align="left">125970</td>
<td align="left">167960</td>
<td align="left">184756</td>
</tr>
</tbody></table>
<p>$\binom{n}{k}=\binom{n-1}{k-1}+\binom{n-1}{k}$
$\binom{n}{k}=\frac{n}{k}\binom{n-1}{k-1}$
$\binom{L}{k}+\dots+\binom{R-1}{k}=\binom{R}{k+1}-\binom{L}{k+1}$</p>
<h2>第一種スターリング数</h2>
<p>$c(n,k)$: $1,2,\dots,n$ の順列で巡回置換 $k$ 個に分割できるものの個数</p>
<table>
<thead>
<tr>
<th align="left">$n$ \ $k$</th>
<th align="left">0</th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>0</strong></td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>1</strong></td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>2</strong></td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>3</strong></td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">3</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>4</strong></td>
<td align="left">0</td>
<td align="left">6</td>
<td align="left">11</td>
<td align="left">6</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>5</strong></td>
<td align="left">0</td>
<td align="left">24</td>
<td align="left">50</td>
<td align="left">35</td>
<td align="left">10</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>6</strong></td>
<td align="left">0</td>
<td align="left">120</td>
<td align="left">274</td>
<td align="left">225</td>
<td align="left">85</td>
<td align="left">15</td>
<td align="left">1</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>7</strong></td>
<td align="left">0</td>
<td align="left">720</td>
<td align="left">1764</td>
<td align="left">1624</td>
<td align="left">735</td>
<td align="left">175</td>
<td align="left">21</td>
<td align="left">1</td>
</tr>
</tbody></table>
<p>$c(n,k)=c(n-1,k-1)+(n-1)c(n-1,k)$
$x(x+1)\dots(x+n-1)=\sum_{k=0}^n c(n,k)x^k$
$\sum_{k=0}^nc(n,k)=n!$
$\sum_{k=0}^n  2^kc(n,k)=(n+1)!$
$\sum_{k=0}^n(-1)^kc(n,k)=0$</p>
<p>$\sum_{k=0}^n c(n,k)x^k=x(x+1)\dots(x+n-1)$ を用いて分割統治し，片方の計算を polynomial taylor shift で再利用すると，$c(N,k)$ の $k$ に関する列挙が $O(N\log N)$ 時間でできる．</p>
<h2>第二種スターリング数</h2>
<p>$S(n,k)$: $1,2,\dots,n$ を $k$ 個の区別しない集合に分割する方法の数</p>
<table>
<thead>
<tr>
<th align="left">$n$ \ $k$</th>
<th align="left">0</th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>0</strong></td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>1</strong></td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>2</strong></td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>3</strong></td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">3</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>4</strong></td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">7</td>
<td align="left">6</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>5</strong></td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">15</td>
<td align="left">25</td>
<td align="left">10</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>6</strong></td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">31</td>
<td align="left">90</td>
<td align="left">65</td>
<td align="left">15</td>
<td align="left">1</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>7</strong></td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">63</td>
<td align="left">301</td>
<td align="left">350</td>
<td align="left">140</td>
<td align="left">21</td>
<td align="left">1</td>
</tr>
</tbody></table>
<p>$S(n,k)=S(n-1,k-1)+kS(n-1,k)$
$x^n=\sum_{k=0}^nS(n,k)x(x-1)\dots(x-k+1)$
$S(n,k)=\frac{1}{k!}\sum_{m=1}^k(-1)^{k-m}\binom{k}{m}m^n$</p>
<p>最後の式と畳み込みを使うと $S(N,k)$ の $k$ に関する列挙が $O(N\log N)$ 時間でできる．</p>
<h2>ベル数</h2>
<p>$B_n$: $1,2,\dots,n$ をいくつかの集合に分割する方法の数</p>
<table>
<thead>
<tr>
<th align="left">$n$</th>
<th align="left">0</th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
<th align="left">9</th>
<th align="left">10</th>
</tr>
</thead>
<tbody><tr>
<td align="left">$B_n$</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">5</td>
<td align="left">15</td>
<td align="left">52</td>
<td align="left">203</td>
<td align="left">877</td>
<td align="left">4140</td>
<td align="left">21147</td>
<td align="left">115975</td>
</tr>
</tbody></table>
<p>$B_{n+1}=\sum_{k=0}^n\binom{n}{k}B_k$
$B_n=\frac{1}{e}\sum_{k=0}^\infty\frac{k^n}{k!}$</p>
<p>指数型母関数 $\exp(\exp x - 1)=\sum_{n=0}^\infty B_n\frac{x^n}{n!}$ を使うと $B_0, B_1, \dots, B_n$ の計算が $O(N\log N)$ でできる．</p>
<h2>カタラン数</h2>
<p>$C_n$: $n$ 個の $($ と $)$ を括弧列になるように並べる方法の数</p>
<table>
<thead>
<tr>
<th align="left">$n$</th>
<th align="left">0</th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
<th align="left">9</th>
<th align="left">10</th>
</tr>
</thead>
<tbody><tr>
<td align="left">$C_n$</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">5</td>
<td align="left">14</td>
<td align="left">42</td>
<td align="left">132</td>
<td align="left">429</td>
<td align="left">1430</td>
<td align="left">4862</td>
<td align="left">16796</td>
</tr>
</tbody></table>
<p>$C_n=\frac{1}{n+1}\binom{2n}{n}=\frac{(2n)!}{(n+1)!n!}$
$C_{n+1}=\frac{2(2n+1)}{n+2}C_n$
$C_{n+1}=\sum_{k=0}^nC_kC_{n-k}$</p>
<h2>モンモール数</h2>
<p>$a_n$: $1,2,\dots,n$ の順列 $P$ で $P_i \neq i$ となるものの個数</p>
<table>
<thead>
<tr>
<th align="left">$n$</th>
<th align="left">0</th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
<th align="left">9</th>
<th align="left">10</th>
</tr>
</thead>
<tbody><tr>
<td align="left">$a_n$</td>
<td align="left"></td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">9</td>
<td align="left">44</td>
<td align="left">265</td>
<td align="left">1854</td>
<td align="left">14833</td>
<td align="left">133496</td>
<td align="left">1334961</td>
</tr>
</tbody></table>
<p>$a_n=(n-1)(a_{n-1}+a_{n-2})$
$a_n=na_{n-1}+(-1)^n$</p>
<h2>分割数</h2>
<p>$P_n$: $n$ を正の整数の和として表す方法の数</p>
<table>
<thead>
<tr>
<th align="left">$n$</th>
<th align="left">0</th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
<th align="left">9</th>
<th align="left">10</th>
</tr>
</thead>
<tbody><tr>
<td align="left">$P_n$</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">3</td>
<td align="left">5</td>
<td align="left">7</td>
<td align="left">11</td>
<td align="left">15</td>
<td align="left">22</td>
<td align="left">30</td>
<td align="left">42</td>
</tr>
</tbody></table>
<p>母関数は $\prod_{n=1}^\infty \frac{1}{1-x^n}=\sum_{n=0}^\infty P_nx^n$ である．五角数定理より $\prod_{n=1}^\infty (1-x^n)=\sum_{n=-\infty}^\infty (-1)^nx^{n(3n+1)/2}$ なので，$P_0,P_1,\dots,P_N$ を $O(N\log N)$ 時間で列挙できる．</p>
<h2>母関数</h2>
<p>$\frac{1}{1-x}=1+x+x^2+x^3+x^4+\dots=\sum_{n=0}^\infty x^n$</p>
<p>$\frac{1}{(1-x)^2}=1+2x+3x^2+4x^3+5x^4+\dots=\sum_{n=0}^\infty (n+1)x^n$</p>
<p>$\frac{1}{(1-x)^3}=1+3x+6x^2+10x^3+15x^4+\dots=\sum_{n=0}^\infty \frac{1}{2}(n+1)(n+2)x^n$</p>
<p>$\frac{1}{(1-x)^d}=\sum_{n=0}^\infty \binom{n+d-1}{n}x^n$</p>
<p>$\sqrt{1-x}=1-\frac{1}{2}x-\frac{1}{8}x^2-\frac{1}{16}x^3-\frac{5}{128}x^4-\dots=1-\sum_{n=1}^\infty \frac{(2n-2)!}{2^{2n-1}n!(n-1)!}x^n$</p>
<p>$\frac{1}{\sqrt{1-x}}=1+\frac{1}{2}x+\frac{3}{8}x^2+\frac{5}{16}x^3+\frac{35}{128}x^4-\dots=\sum_{n=0}^\infty \frac{(2n)!}{4^n n!}x^n$</p>
<p>$\frac{1-\sqrt{1-4x}}
{2x}=1+x+2x^2+5x^3+14x^4+\dots=\sum_{n=0}^\infty C_nx^n=\sum_{n=0}^\infty \frac{(2n)!}{(n+1)!n!}x^n$ (カタラン数)</p>
<p>$\frac{1}{\sqrt{1-4x}}=\sum_{n=0}^\infty\binom{2n}{n}x^n$</p>
<p>$\frac{1}{1-x-x^2}=1+x+2x^2+3x^3+5x^4+\dots=\sum_{n=0}^\infty F_nx^n$ (フィボナッチ数)</p>
<p>$\log(1-x)=-x-\frac{1}{2}x^2-\frac{1}{3}x^3-\frac{1}{4}x^4-\dots=\sum_{n=1}^\infty \frac{1}{n}x^n$</p>
<p>$\exp(\exp x - 1) = \sum_{n=0}^\infty B_n \frac{x^n}{n}$ (ベル数)</p>
<p>$\frac{1}{k}(\exp x - 1)^k = \sum_{n=0}^\infty S(n,k)\frac{x^n}{n!}$ (第二種スターリング数)</p>
<p>$\frac{\exp(-x)}{1-x}=1+\frac{1}{2}x^2+\frac{1}{3}x^3+\frac{3}{8}x^4+\dots=\sum_{n=0}^\infty a_n\frac{x^n}{n!}$ (モンモール数)</p>
<p>$C(x)^k=\left(\frac{1-\sqrt{1-4x}}{2x}\right)^k=\sum_{n=0}^\infty \frac{k}{n+k}\binom{2n+k-1}{n}$ (カタラン数の母関数の累乗)</p>
</div>

</body>
</html>